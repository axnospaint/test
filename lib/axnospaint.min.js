/*! For license information please see axnospaint.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AXNOSPaint=e():t.AXNOSPaint=e()}(self,(()=>(()=>{"use strict";var t={5119:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,"/* アラート */\r\n#modalContainer {\r\n    background-color: rgba(0, 0, 0, 0.3);\r\n    position: absolute;\r\n    top: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    left: 0px;\r\n    z-index: 10000;\r\n}\r\n\r\n#alertBox {\r\n    position: relative;\r\n    width: 33%;\r\n    min-height: 100px;\r\n    max-height: 400px;\r\n    margin-top: 50px;\r\n    border: 1px solid #fff;\r\n    background-color: #fff;\r\n    background-repeat: no-repeat;\r\n    top: 30%;\r\n}\r\n\r\n#modalContainer>#alertBox {\r\n    position: fixed;\r\n}\r\n\r\n#alertBox h1 {\r\n    margin: 0;\r\n    font: bold 1em Raleway, arial;\r\n    background-color: #555;\r\n    color: #FFF;\r\n    border-bottom: 1px solid #555;\r\n    padding: 5px 0 5px 5px;\r\n}\r\n\r\n#alertBox p {\r\n    height: auto;\r\n    padding-left: 5px;\r\n    padding-top: 30px;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n    color: #000;\r\n}\r\n\r\n#alertBox #closeBtn {\r\n    margin: 10px auto 10px auto;\r\n    padding: 7px;\r\n    border: 0 none;\r\n    width: 100px;\r\n    text-transform: uppercase;\r\n    text-align: center;\r\n    color: #FFF;\r\n    background-color: #555;\r\n    border-radius: 0px;\r\n    text-decoration: none;\r\n    outline: 0 !important;\r\n}\r\n\r\n#alertBox #cancelBtn {\r\n    margin: 10px auto 10px auto;\r\n    padding: 7px;\r\n    border: 0 none;\r\n    width: 100px;\r\n    text-transform: uppercase;\r\n    text-align: center;\r\n    color: #FFF;\r\n    background-color: #555;\r\n    border-radius: 0px;\r\n    text-decoration: none;\r\n    outline: 0 !important;\r\n}",""]);const o=r},2e3:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,"* {\r\n  box-sizing: border-box;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n\r\nbody {\r\n  margin: 0;\r\n  width: 100%;\r\n  height: 100vh;\r\n  height: 100svh;\r\n  /* iPad */\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n#axp-main {\r\n  touch-action: none;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  color: #fff;\r\n  background-color: #000;\r\n  font-size: 15px;\r\n  width: 100%;\r\n  margin: 0 auto;\r\n  display: none;\r\n  flex-grow: 1;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n}\r\n\r\n#axp-canvas {\r\n  width: 100%;\r\n  overflow: hidden;\r\n  position: relative;\r\n  flex-grow: 1;\r\n}\r\n\r\n#axp-canvas-grayarea {\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: #777;\r\n}\r\n\r\n#axp-canvas-maincanvas {\r\n  position: absolute;\r\n  image-rendering: pixelated;\r\n}\r\n\r\n/* キャンバスの透過メッシュ */\r\n.axp-mesh {\r\n  background: rgb(204, 204, 204);\r\n  background-image:\r\n    linear-gradient(45deg, rgb(255, 255, 255) 25%, transparent 0),\r\n    linear-gradient(45deg, transparent 75%, rgb(255, 255, 255) 0),\r\n    linear-gradient(45deg, rgb(255, 255, 255) 25%, transparent 0),\r\n    linear-gradient(45deg, transparent 75%, rgb(255, 255, 255) 0);\r\n  background-size: 16px 16px;\r\n  background-position: 0 0, 8px 8px, 8px 8px, 16px 16px;\r\n}\r\n\r\n.axp-grid {\r\n  image-rendering: pixelated;\r\n  background-image: linear-gradient(0deg, #000 2px, transparent 2px), linear-gradient(270deg, #000 2px, transparent 2px);\r\n  background-position: 1px 1px;\r\n  background-size: 6.25% 6.25%;\r\n}\r\n\r\n/* グリッド線 */\r\n#axp-canvas-gridarea {\r\n  position: absolute;\r\n  opacity: 0.3;\r\n  z-index: 999;\r\n}\r\n\r\n#axp-canvas-griddot {\r\n  position: absolute;\r\n  opacity: 0.2;\r\n  z-index: 998;\r\n}\r\n\r\n/* 座標表示用領域 */\r\n#axp-canvas-display-position {\r\n  position: absolute;\r\n  right: 0;\r\n  bottom: 0;\r\n  font-family: monospace;\r\n  font-size: 18px;\r\n  font-weight: 500;\r\n  color: #fff;\r\n  background: rgba(0, 0, 0, 0.7);\r\n  box-shadow: #000;\r\n  z-index: 1000;\r\n}\r\n\r\n/* カーソル位置に表示するペンの太さ表示*/\r\n#axp-canvas-pen_cursor {\r\n  pointer-events: none;\r\n  position: absolute;\r\n  border: solid 2px rgba(0, 0, 0, 0.3);\r\n  z-index: 1001;\r\n}\r\n\r\n/* メインのタブ制御 */\r\n#axp-main-tab-section {\r\n  display: flex;\r\n  align-items: flex-end;\r\n}\r\n\r\n/* タブ横のテキスト */\r\n#axp-main-tab-text {\r\n  padding: 4px 10px 0;\r\n  color: #fff;\r\n  overflow: hidden;\r\n  white-space: pre;\r\n  flex-grow: 1;\r\n  cursor: pointer;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n/* タブ横のテキストクリック時、全文表示 */\r\n#axp-main-tab-text:active {\r\n  overflow: visible;\r\n  white-space: normal;\r\n}\r\n\r\n/* 見出し枠 */\r\n#axp-main-tab-section ul {\r\n  list-style-type: none;\r\n  display: flex;\r\n}\r\n\r\n/* 見出し */\r\n#axp-main-tab-section li {\r\n  display: block;\r\n  width: 98px;\r\n  padding: 2px 0;\r\n  text-align: center;\r\n  border-top: 2px solid #000;\r\n  border-left: 0px solid #000;\r\n  border-right: 2px solid #000;\r\n  border-radius: 10px 10px 0 0;\r\n  background: #333;\r\n  box-sizing: border-box;\r\n  cursor: pointer;\r\n}\r\n\r\n/* 見出しにカーソルを当てた時 */\r\n#axp-main-tab-section li:hover {\r\n  background: #666;\r\n}\r\n\r\n/* 選択されている見出し */\r\n#axp-main-tab-section li.selected {\r\n  background: #777;\r\n}\r\n\r\n#axp-main-tab-article>article:nth-of-type(3) {\r\n  background: #eee;\r\n}\r\n\r\n#axp-main-tab-article>article {\r\n  display: none;\r\n  flex-grow: 1;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n}\r\n\r\n#axp-main-tab-article,\r\n#axp-config,\r\n#axp-config-menu {\r\n  display: flex;\r\n  flex-grow: 1;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n}\r\n\r\n#axp-config-content {\r\n  flex-grow: 1;\r\n}\r\n\r\n#axp-post {\r\n  flex-grow: 1;\r\n  overflow: auto;\r\n}\r\n\r\n#axp-footer {\r\n  touch-action: none;\r\n  -webkit-user-select: none;\r\n  user-select: none;\r\n  background-color: #222;\r\n  color: #ddd;\r\n  display: flex;\r\n  min-height: 31px;\r\n}\r\n\r\n#axp-footer-info {\r\n  background-color: rgba(0, 0, 0, 0);\r\n  font-size: 15px;\r\n  padding: 4px;\r\n}\r\n\r\n#axp-footer-infoIcon {\r\n  margin-left: 8px;\r\n  margin-top: 2px;\r\n}",""]);const o=r},571:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,'.coloricon2 {\r\n    position: static;\r\n    height: 32px;\r\n    width: 32px;\r\n    cursor: pointer;\r\n    border-radius: 5px;\r\n    margin: 1px;\r\n    border-width: 2px;\r\n    border-style: solid;\r\n    border-color: #aaa;\r\n}\r\n\r\n#tool_color>.tool_box>div:first-child {\r\n    /*メイン、サブ、透明色*/\r\n    display: grid;\r\n    align-items: center;\r\n    grid-template-columns: 80px 13px 10px 10px 13px 38px;\r\n    grid-template-rows: repeat(5, 11px);\r\n}\r\n\r\n#tool_color>.tool_box>div:first-child>div {\r\n    /*メインカラー、サブカラー　フォントサイズ*/\r\n    font-size: 13px;\r\n}\r\n\r\n#tool_color>.tool_box>div:first-child>div:nth-child(1) {\r\n    /*メインカラー　文字*/\r\n    grid-area: 1 / 1 / 4 / 2;\r\n}\r\n\r\n#tool_color>.tool_box>div:first-child>div:nth-child(2) {\r\n    /*サブカラー　文字*/\r\n    grid-area: 4 / 1 / 6 / 2;\r\n}\r\n\r\n#color_main {\r\n    /*メインカラー　枠*/\r\n    grid-area: 1 / 2 / 4 / 5;\r\n    isolation: isolate;\r\n}\r\n\r\n#color_sub {\r\n    /*サブカラー　枠*/\r\n    grid-area: 3 / 3 / 6 / 6;\r\n}\r\n\r\n#color_transparent {\r\n    /*透明　枠*/\r\n    margin: 0 0 0 6px;\r\n    grid-area: 1 / 6 / 6 / 7;\r\n}\r\n\r\n#color_main[data-selected="true"],\r\n#color_transparent[data-selected="true"] {\r\n    border-width: 5px;\r\n    border-style: double;\r\n    border-color: #f00;\r\n}\r\n\r\n#tool_color>.tool_box>div:nth-child(2) {\r\n    /*カラーコード　上下マージン*/\r\n    margin-top: 5px;\r\n    margin-bottom: 5px;\r\n}\r\n\r\n#button_addcolor {\r\n    /*登録ボタン　左マージン*/\r\n    margin-left: 5px;\r\n}\r\n\r\n#rgb_color>div {\r\n    /*赤、緑、青　間　上下マージン*/\r\n    margin-bottom: 2px;\r\n}\r\n\r\n#rgb_color>div>* {\r\n    /*赤、緑、青　縦配置*/\r\n    vertical-align: middle;\r\n}\r\n\r\ninput[type="range"].range_color {\r\n    /*赤、緑、青　スライダー左右マージン*/\r\n    margin-left: 5px;\r\n    margin-right: 5px;\r\n}\r\n\r\n/* カラーコード表示 */\r\n#text-hexcolor {\r\n    width: 70px;\r\n}\r\n\r\n#range_red_text,\r\n#range_green_text,\r\n#range_blue_text {\r\n    width: 40px;\r\n    border: 0;\r\n}',""]);const o=r},2500:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,'#axp-config-content {\r\n    display: flex;\r\n    height: 100%;\r\n    background: #eee;\r\n    color: #333;\r\n    padding: 10px;\r\n}\r\n\r\n/* 左側（見出し）*/\r\n#axp-config-left {\r\n    line-height: 40px;\r\n    width: 200px;\r\n    height: 100%;\r\n    overflow: auto;\r\n}\r\n\r\n/* 右側（本文）*/\r\n#axp-config-right {\r\n    margin-left: 0px;\r\n    padding: 24px;\r\n    width: 800px;\r\n    height: 100%;\r\n    overflow: auto;\r\n}\r\n\r\n/* 見出し */\r\n#axp-config-tab-section li {\r\n    display: block;\r\n    background: #eee;\r\n    width: 180px;\r\n    padding: 3px;\r\n    font-weight: bold;\r\n    cursor: pointer;\r\n    border-radius: 8px;\r\n}\r\n\r\n/* 見出しにマウスを合わせたときに色を変える */\r\n#axp-config-tab-section li:hover {\r\n    background: #ccc;\r\n}\r\n\r\n/* 選択されている見出し */\r\n#axp-config-tab-section li.selected {\r\n    background: rgb(224, 156, 53);\r\n}\r\n\r\n#axp-config-shortcut_table {\r\n    border: 4px double #bbb;\r\n}\r\n\r\n#axp-config-shortcut_table td {\r\n    border: 1px solid #999;\r\n    padding: 0 8px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* 設定用のカラーパレット表示（モックアップ）*/\r\n#axp-config-palette_scroll {\r\n    max-width: 228px;\r\n    max-height: 228px;\r\n    overflow: auto;\r\n    background: #ccc;\r\n}\r\n\r\n#axp-config-palette_box {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-content: flex-start;\r\n    background: #333;\r\n    padding: 4px;\r\n}\r\n\r\n.coloricon_mini {\r\n    height: 20px;\r\n    width: 20px;\r\n    margin: 1px;\r\n    border-radius: 3px;\r\n}\r\n\r\n\r\n.radio_config {\r\n    font-size: 12px;\r\n}\r\n\r\n.radio_config input {\r\n    display: none;\r\n}\r\n\r\n.radio_config input[type="radio"]:checked+label {\r\n    font-weight: bold;\r\n    color: #000;\r\n    border: 2px solid #bf9701;\r\n    background-color: #f7a312;\r\n}\r\n\r\n.radio_config label {\r\n    color: #777;\r\n    border: 2px solid #ddd;\r\n    text-align: center;\r\n    display: inline-block;\r\n    padding: 5px 0px;\r\n    width: 100px;\r\n    border-radius: 0px;\r\n}\r\n\r\n.radio_config label:hover {\r\n    color: #aaa;\r\n    border: 2px solid #aaa;\r\n    cursor: pointer;\r\n}\r\n\r\n.radio_config button {\r\n    color: #777;\r\n    border: 2px solid #000;\r\n    text-align: center;\r\n    display: inline-block;\r\n    padding: 5px 0px;\r\n    width: 100px;\r\n    margin: 2px;\r\n    border-radius: 50px;\r\n}\r\n\r\n.radio_config button:hover {\r\n    color: #aaa;\r\n    border: 2px solid #aaa;\r\n    cursor: pointer;\r\n}\r\n\r\n.radio_config button:active {\r\n    color: #000;\r\n    border: 2px solid #444;\r\n}',""]);const o=r},1112:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,"/*HTML5版お絵カキコrevert style*/\r\n.Wrapper * {\r\n    box-sizing: initial;\r\n}\r\n\r\ntd.UploadCmdButton>input#UploadButton {\r\n    border: 1px solid #777;\r\n    font-size: 16px;\r\n    padding: 3px 12px;\r\n    text-decoration: none;\r\n    display: inline-block;\r\n    background-color: rgba(255, 255, 255, 0.6);\r\n    cursor: pointer;\r\n    border-radius: 6px;\r\n    text-align: center;\r\n    overflow: hidden;\r\n}\r\n\r\ntd.UploadCmdButton>input#UploadButton:hover {\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n    color: #fff;\r\n    text-decoration: none;\r\n}\r\n\r\n.PalletEdit,\r\n.PalletEdit * {\r\n    box-sizing: content-box;\r\n}\r\n\r\n.PalletEdit .ColorSelectorDlg .ColorSelectorFrame .ColorSelectorItem {\r\n    box-sizing: border-box;\r\n}\r\n\r\n#button_exec_axnospaint,\r\n#button_exec_drawcanvas {\r\n    width: fit-content;\r\n    padding: 3px 5px;\r\n}",""]);const o=r},4272:(t,e,n)=>{n.d(e,{Z:()=>E});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s),o=n(1667),l=n.n(o),d=new URL(n(932),n.b),c=new URL(n(5668),n.b),h=new URL(n(3682),n.b),p=new URL(n(8137),n.b),u=new URL(n(1493),n.b),g=new URL(n(6381),n.b),m=new URL(n(1190),n.b),b=new URL(n(6088),n.b),x=r()(a()),y=l()(d),_=l()(c),A=l()(h),f=l()(p),v=l()(u),S=l()(g),O=l()(m),w=l()(b);x.push([t.id,"/* アイコン */\r\n.caution {\r\n    width: 24px;\r\n    height: 24px;\r\n    background-image: url("+y+");\r\n}\r\n\r\n.information {\r\n    width: 24px;\r\n    height: 24px;\r\n    background-image: url("+_+");\r\n}\r\n\r\n.ng {\r\n    width: 24px;\r\n    height: 24px;\r\n    background-image: url("+A+");\r\n}\r\n\r\n.axp-icon-window-pen {\r\n    background: no-repeat;\r\n    background-image: url("+f+");\r\n    background-position: center;\r\n}\r\n\r\n.axp-icon-window-layer {\r\n    background: no-repeat;\r\n    background-image: url("+v+");\r\n    background-position: center;\r\n}\r\n\r\n.axp-icon-window-colormaker {\r\n    background: no-repeat;\r\n    background-image: url("+S+");\r\n    background-position: center;\r\n}\r\n\r\n.axp-icon-window-palette {\r\n    background: no-repeat;\r\n    background-image: url("+O+");\r\n    background-position: center;\r\n}\r\n\r\n.axp-icon-window-subtool {\r\n    background: no-repeat;\r\n    background-image: url("+w+");\r\n    background-position: center;\r\n}\r\n\r\n.axp-icon-span {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    vertical-align: middle;\r\n    width: 28px;\r\n    height: 28px;\r\n}",""]);const E=x},4867:(t,e,n)=>{n.d(e,{Z:()=>A});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s),o=n(1667),l=n.n(o),d=new URL(n(4529),n.b),c=new URL(n(6991),n.b),h=new URL(n(7901),n.b),p=new URL(n(1183),n.b),u=new URL(n(5734),n.b),g=r()(a()),m=l()(d),b=l()(c),x=l()(h),y=l()(p),_=l()(u);g.push([t.id,'/* レイヤー ==================================== */\r\n#button-layer-create {\r\n    width: 48px;\r\n    height: 35px;\r\n}\r\n\r\n#button-layer-copy,\r\n#button-layer-delete,\r\n#button-layer-clear,\r\n#button-layer-integrate {\r\n    width: 24px;\r\n    height: 35px;\r\n}\r\n\r\n#layer-mode-select {\r\n    width: 100%;\r\n    height: 30px;\r\n    border-radius: 8px;\r\n    margin-top: 4px;\r\n}\r\n\r\n/* レイヤーボックス */\r\n.layerboxhead {\r\n    list-style: none;\r\n    text-align: center;\r\n    padding: 0px;\r\n    height: 36px;\r\n    background: rgba(0, 0, 0, 0);\r\n    border-radius: 5px 5px 0 0;\r\n}\r\n\r\n.layerbox {\r\n    list-style: none;\r\n    padding: 0px;\r\n    height: 100%;\r\n    /* レイヤー数に応じて可変*/\r\n    background: rgba(0, 0, 0, 0);\r\n    border-radius: 0 0 5px 5px;\r\n}\r\n\r\n.layerbox li {\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n    background: rgba(0, 0, 0, 0);\r\n    cursor: grab;\r\n    border: 1px solid #000f;\r\n    border-radius: 5px;\r\n}\r\n\r\n.layerbox li.onGrab {\r\n    cursor: grabbing;\r\n    position: absolute;\r\n    z-index: 1;\r\n}\r\n\r\n.layerbox li:not(:last-child) {\r\n    margin-bottom: 0px;\r\n}\r\n\r\n.hidden {\r\n    visibility: hidden;\r\n}\r\n\r\n.layerbox li:hover {\r\n    background: rgba(255, 255, 255, 0.1);\r\n}\r\n\r\n.layerbox li[data-selected="true"] {\r\n    background: rgba(255, 174, 50, 0.6);\r\n}\r\n\r\n.layertext {\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n    border: none 0px;\r\n    background-color: rgba(0, 0, 0, 0);\r\n    font-weight: bold;\r\n    padding: 0px;\r\n}\r\n\r\n/* レイヤー内：チェックボックス */\r\n.layercheckboxdiv {\r\n    display: flex;\r\n    flex-direction: row;\r\n}\r\n\r\n.layercheckboxdiv2 {\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n.layercheckbox {\r\n    cursor: pointer;\r\n    width: 21px;\r\n    height: 42px;\r\n    border: 2px solid #333;\r\n    border-radius: 2px;\r\n}\r\n\r\n.layercheckbox2 {\r\n    cursor: pointer;\r\n    width: 21px;\r\n    height: 21px;\r\n    border: 2px solid #333;\r\n    border-radius: 2px;\r\n}\r\n\r\n/* レイヤーセル */\r\n.wrapper {\r\n    border: 0px solid #bbb;\r\n    height: 42px;\r\n}\r\n\r\n.wrapper-center-flex {\r\n    display: flex;\r\n    align-items: center;\r\n    /* 垂直方向：中央揃え */\r\n    justify-content: flex-start;\r\n    /* 水平方向：左揃え */\r\n}\r\n\r\n.layer_thumbnail {\r\n    border: solid 1px #000;\r\n    background: #777;\r\n}\r\n\r\n.eye {\r\n    background: #ddd center no-repeat url('+m+");\r\n}\r\n\r\n.eye_off {\r\n    background: #555 center no-repeat url("+b+");\r\n}\r\n\r\n.lock {\r\n    background-color: #aa3;\r\n    background-image: url("+x+");\r\n}\r\n\r\n.lock_off {\r\n    background-color: #555;\r\n    background-image: url("+y+");\r\n}\r\n\r\n.mask {\r\n    background: #ff4 center no-repeat url("+_+");\r\n}\r\n\r\n.mask_off {\r\n    background: #555 center no-repeat url("+_+");\r\n}\r\n\r\n\r\n.layer_textbox {\r\n    color: #fff;\r\n    font-size: 14px;\r\n    border: none 0px;\r\n    background-color: rgba(0, 0, 0, 0);\r\n    font-weight: bold;\r\n}",""]);const A=g},5399:(t,e,n)=>{n.d(e,{Z:()=>p});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s),o=n(1667),l=n.n(o),d=new URL(n(9772),n.b),c=r()(a()),h=l()(d);c.push([t.id,"/* モーダルウィンドウ ============================================ */\r\n/* 共通部 */\r\n.modal_window {\r\n    display: none;\r\n    position: absolute;\r\n    z-index: 2001;\r\n    left: 0;\r\n    top: 0;\r\n    height: 100%;\r\n    width: 100%;\r\n    overflow: auto;\r\n    background-color: rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.modal_body {\r\n    background-color: #eee;\r\n    color: #000;\r\n    border-color: #337;\r\n    border-width: 4px;\r\n    border-style: double;\r\n    margin: 8px;\r\n    padding: 8px;\r\n    border-radius: 5px;\r\n}\r\n\r\n/* 自動バックアップ --------------------------------------- */\r\n.entry {\r\n    background-color: #aaa;\r\n    border: solid 0px;\r\n    display: flex;\r\n    justify-content: normal;\r\n    flex-wrap: wrap;\r\n    padding: 8px;\r\n}\r\n\r\n.entry div {\r\n    background-color: #ddd;\r\n    width: 135px;\r\n    height: 180px;\r\n    border: solid 2px #000;\r\n    border-radius: 10px;\r\n    text-align: center;\r\n    padding: 2px;\r\n    margin: 2px;\r\n    font-size: 12px;\r\n    font-weight: bold;\r\n    line-height: 15px;\r\n}\r\n\r\n.entry img {\r\n    width: 120px;\r\n    height: 120px;\r\n    cursor: pointer;\r\n}\r\n\r\n.entry div:hover {\r\n    background-color: #ffa;\r\n    transition: .5s;\r\n}\r\n\r\n.saveslot {\r\n    background-image: url("+h+");\r\n}",""]);const p=c},4033:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,'/* カラーパレット ==================================== */\r\n#palette_container {\r\n    display: flex;\r\n    flex-direction: column;\r\n}\r\n\r\n#palette_button_box {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-content: flex-start;\r\n    width: 100%;\r\n    background-color: rgba(0, 0, 0, 0);\r\n}\r\n\r\n#palette_box {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-content: flex-start;\r\n    background-color: #333;\r\n}\r\n\r\n#palette_edit,\r\n#palette_delete {\r\n    height: 32px;\r\n    width: 32px;\r\n    cursor: pointer;\r\n    display: inline-grid;\r\n    place-items: center;\r\n}\r\n\r\n#palette_delete.displaynone {\r\n    display: none;\r\n}\r\n\r\n.coloricon {\r\n    height: 30px;\r\n    width: 30px;\r\n    background-color: rgba(0, 0, 0, 0);\r\n    cursor: pointer;\r\n    border-radius: 5px;\r\n    margin: 1px;\r\n    border-width: 6px;\r\n    border-style: double;\r\n    border-color: rgba(0, 0, 0, 0);\r\n}\r\n\r\n.coloricon[data-selected="true"] {\r\n    border-color: rgb(206, 206, 206);\r\n}\r\n\r\n.coloricon.onGrab {\r\n    cursor: grabbing;\r\n    position: absolute;\r\n    z-index: 1;\r\n}\r\n\r\n#tool_palette {\r\n    resize: both;\r\n    min-width: 46px;\r\n    min-height: 74px;\r\n    padding-bottom: 15px;\r\n}\r\n\r\n#tool_palette[data-minimize="true"] {\r\n    height: 30px;\r\n    min-height: 30px;\r\n    max-height: 30px;\r\n    /* minとmax同一でリサイズしてるheightを閉じてる間だけ無効化 */\r\n    resize: none;\r\n    /* 閉じてる時のリサイズ防止と▽と動作範囲重なるから */\r\n}',""]);const o=r},5516:(t,e,n)=>{n.d(e,{Z:()=>z});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s),o=n(1667),l=n.n(o),d=new URL(n(4506),n.b),c=new URL(n(6219),n.b),h=new URL(n(7931),n.b),p=new URL(n(4031),n.b),u=new URL(n(4215),n.b),g=new URL(n(8497),n.b),m=new URL(n(9371),n.b),b=new URL(n(8637),n.b),x=new URL(n(9213),n.b),y=new URL(n(8472),n.b),_=new URL(n(5890),n.b),A=new URL(n(269),n.b),f=new URL(n(8030),n.b),v=r()(a()),S=l()(d),O=l()(c),w=l()(h),E=l()(p),C=l()(u),j=l()(g),k=l()(m),I=l()(b),N=l()(x),B=l()(y),M=l()(_),T=l()(A),L=l()(f);v.push([t.id,'/* サブメニューを示唆する動く三角マーク */\r\n#pen_base[data-selected="true"]::after {\r\n    content: \'\';\r\n    position: absolute;\r\n    top: 4px;\r\n    right: 4px;\r\n    width: 0;\r\n    height: 0;\r\n    border-style: solid;\r\n    border-width: 0 10px 10px 0;\r\n    border-color: transparent #fff transparent transparent;\r\n    transition: 0.3s;\r\n}\r\n\r\n#pen_base[data-selected="true"]:hover::after,\r\n#pen_base[data-opensub="true"]::after {\r\n    top: -2px;\r\n    right: -2px;\r\n}\r\n\r\n#eraser_base[data-selected="true"]::after {\r\n    content: \'\';\r\n    position: absolute;\r\n    top: 48px;\r\n    right: 4px;\r\n    width: 0;\r\n    height: 0;\r\n    border-style: solid;\r\n    border-width: 0 10px 10px 0;\r\n    border-color: transparent #fff transparent transparent;\r\n    transition: 0.3s;\r\n}\r\n\r\n#eraser_base[data-selected="true"]:hover::after,\r\n#eraser_base[data-opensub="true"]::after {\r\n    top: 42px;\r\n    right: -2px;\r\n}\r\n\r\n#fill_base[data-selected="true"]::after {\r\n    content: \'\';\r\n    position: absolute;\r\n    top: 92px;\r\n    right: 4px;\r\n    width: 0;\r\n    height: 0;\r\n    border-style: solid;\r\n    border-width: 0 10px 10px 0;\r\n    border-color: transparent #fff transparent transparent;\r\n    transition: 0.3s;\r\n}\r\n\r\n#fill_base[data-selected="true"]:hover::after,\r\n#fill_base[data-opensub="true"]::after {\r\n    top: 86px;\r\n    right: -2px;\r\n}\r\n\r\n#hand_base[data-selected="true"]::after {\r\n    content: \'\';\r\n    position: absolute;\r\n    top: 136px;\r\n    right: 4px;\r\n    width: 0;\r\n    height: 0;\r\n    border-style: solid;\r\n    border-width: 0 10px 10px 0;\r\n    border-color: transparent #fff transparent transparent;\r\n    transition: 0.3s;\r\n}\r\n\r\n#hand_base[data-selected="true"]:hover::after,\r\n#hand_base[data-opensub="true"]::after {\r\n    top: 130px;\r\n    right: -2px;\r\n}\r\n\r\n\r\n.button_penicon {\r\n    width: 44px;\r\n    height: 44px;\r\n    border-radius: 5px;\r\n    border: 3px solid #000;\r\n    box-shadow: 0px 0px 10px #000;\r\n    cursor: pointer;\r\n    background-repeat: no-repeat;\r\n    background-position: 2px 2px;\r\n    background-color: #aaa;\r\n}\r\n\r\n.button_penicon:hover {\r\n    background-color: #aaa;\r\n    border: 3px solid #fff;\r\n    transition: .2s;\r\n}\r\n\r\n.button_penicon[data-selected="true"] {\r\n    background-color: rgb(238, 172, 96);\r\n}\r\n\r\n#axp-pen-div-button {\r\n    margin-left: 8px;\r\n    position: relative;\r\n}\r\n\r\n.axp-pen-sub-button-eraser-round {\r\n    background-image: url('+S+");\r\n}\r\n\r\n.axp-pen-sub-button-eraser-dot {\r\n    background-image: url("+O+");\r\n}\r\n\r\n.pen {\r\n    background-image: url("+w+");\r\n}\r\n\r\n.square {\r\n    background-image: url("+E+");\r\n}\r\n\r\n.dot {\r\n    background-image: url("+C+");\r\n}\r\n\r\n.fude {\r\n    background-image: url("+j+");\r\n}\r\n\r\n.crayon {\r\n    background-image: url("+k+");\r\n}\r\n\r\n.brush {\r\n    background-image: url("+I+");\r\n}\r\n\r\n.move {\r\n    background-image: url("+N+");\r\n}\r\n\r\n.fill {\r\n    background-image: url("+B+");\r\n}\r\n\r\n.fillgradation {\r\n    background-image: url("+M+");\r\n}\r\n\r\n.hand {\r\n    background-image: url("+T+");\r\n}\r\n\r\n.spuit {\r\n    background-image: url("+L+");\r\n}\r\n\r\n\r\n/* ペンの太さプレビュー用キャンバス */\r\n#canvas_pensize {\r\n    position: absolute;\r\n    z-index: 2;\r\n    width: 100px;\r\n    height: 100px;\r\n}\r\n\r\n/* スポイト用キャンバス */\r\n#axp-pen-canvas_spuit {\r\n    position: absolute;\r\n    z-index: 1;\r\n    width: 100px;\r\n    height: 100px;\r\n    image-rendering: pixelated;\r\n}\r\n\r\n\r\n.tool_pen_content {\r\n    display: flex;\r\n    width: 100%;\r\n    padding: 4px;\r\n    margin: 4px;\r\n    border-radius: 8px;\r\n    color: #fff;\r\n    background-color: rgba(0, 0, 0, 0.2);\r\n    line-height: 14px;\r\n}\r\n\r\n#select_pen_mode,\r\n#select_fill {\r\n    width: 100px;\r\n    height: 24px;\r\n    border-radius: 5px;\r\n}\r\n\r\n#axp-pen-div_preview {\r\n    position: relative;\r\n    width: 104px;\r\n    height: 104px;\r\n    background: rgba(255, 255, 255, 0.4);\r\n    border: 2px #aaa solid;\r\n    cursor: pointer;\r\n    margin-top: 8px;\r\n}\r\n\r\n#axp-pen-div-selectbox,\r\n#axp-pen-div-slidebar {\r\n    margin-top: 8px;\r\n}\r\n\r\n/* スポイトのRGBA表示用 */\r\n#axp-pen-div-color {\r\n    line-height: 1.3em;\r\n}",""]);const z=v},7768:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,"#axp-post-content {\r\n    display: flex;\r\n    height: 100%;\r\n    background: #eee;\r\n    color: #333;\r\n    padding: 10px;\r\n}\r\n\r\n#axp-post-main {\r\n    margin-left: 10px;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: auto;\r\n}\r\n\r\n/* お絵カキコの情報テーブル */\r\n#axp-post-information_table {\r\n    border: 0px solid #bbb;\r\n}\r\n\r\n#axp-post-information_table td {\r\n    border: 1px solid #999;\r\n    padding: 0 8px;\r\n    cursor: pointer;\r\n}\r\n\r\n#axp-post-information_table td:nth-of-type(odd) {\r\n    background: #ddd;\r\n}\r\n\r\n/* 投稿情報の入力テーブル */\r\n#axp-post-postform_table {\r\n    border: 0px solid #bbb;\r\n}\r\n\r\n/* 投稿情報の入力テーブル 特定の<td>のみ装飾 */\r\n.axp-post-postform_table-td {\r\n    border: 1px solid #999;\r\n    padding: 0 8px;\r\n    cursor: pointer;\r\n    background: #ddd;\r\n}\r\n\r\n\r\n/* 投稿 --------------------------------------- */\r\n#axp-post-canvas-post {\r\n    border: 1px solid #aaa;\r\n}\r\n\r\n#axp-post-information_table-refid {\r\n    color: #00f;\r\n}\r\n\r\n.TitleInput {\r\n    padding: 4px;\r\n}\r\n\r\n.menu-oekaki_list-thumb {\r\n    width: 134px;\r\n    height: 134px;\r\n    border: 1px solid #d1d1d1;\r\n    position: relative;\r\n    display: -webkit-box;\r\n    display: -ms-flexbox;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n#axp-post-canvas-thumbnail-title {\r\n    margin: 8px 0;\r\n    color: #1e7dc0;\r\n    font-weight: 600;\r\n    width: 134px;\r\n    font-size: 13px;\r\n    line-height: 16px;\r\n    display: -webkit-box;\r\n    -webkit-line-clamp: 2;\r\n    -webkit-box-orient: vertical;\r\n    overflow: hidden;\r\n    word-break: break-all;\r\n}\r\n\r\n#axp-post-message {\r\n    color: #d00;\r\n    font-weight: 600;\r\n}",""]);const o=r},7487:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,'/* レンジスライダー */\r\n.range_text {\r\n    font-size: 13px;\r\n}\r\n\r\ninput[type="range"] {\r\n    appearance: none;\r\n    position: relative;\r\n    overflow: hidden;\r\n    height: 16px;\r\n    width: 100px;\r\n    cursor: pointer;\r\n    border-radius: 0;\r\n}\r\n\r\n::-webkit-slider-runnable-track {\r\n    background: linear-gradient(#000, #555);\r\n}\r\n\r\n/*\r\n  * 1. Set to 0 width and remove border for a slider without a thumb\r\n  */\r\n::-webkit-slider-thumb {\r\n    appearance: none;\r\n    width: 20px;\r\n    /* 1 */\r\n    height: 20px;\r\n    background: #fff;\r\n    box-shadow: -100vw 0 0 100vw #777;\r\n    /* #FDAE32 */\r\n    border: 2px solid #999;\r\n    /* 1 */\r\n}\r\n\r\n::-moz-range-track {\r\n    height: 20px;\r\n    background: linear-gradient(#000, #555);\r\n}\r\n\r\n::-moz-range-thumb {\r\n    background: #fff;\r\n    height: 20px;\r\n    width: 20px;\r\n    border: 3px solid #999;\r\n    border-radius: 0 !important;\r\n    box-shadow: -100vw 0 0 100vw #777;\r\n    box-sizing: border-box;\r\n}\r\n\r\n::-ms-fill-lower {\r\n    background: #777;\r\n}\r\n\r\n::-ms-thumb {\r\n    background: #fff;\r\n    border: 2px solid #999;\r\n    height: 20px;\r\n    width: 20px;\r\n    box-sizing: border-box;\r\n}\r\n\r\n::-ms-ticks-after {\r\n    display: none;\r\n}\r\n\r\n::-ms-ticks-before {\r\n    display: none;\r\n}\r\n\r\n::-ms-track {\r\n    background: #ddd;\r\n    color: transparent;\r\n    height: 20px;\r\n    border: none;\r\n}\r\n\r\n::-ms-tooltip {\r\n    display: none;\r\n}',""]);const o=r},8026:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,"/* 補助ツール */\r\n#tool_sub {\r\n    width: 300px;\r\n}\r\n\r\n/* キャンバスサイズ表示ラベル */\r\n#label_canvas {\r\n    font-size: 13px;\r\n    cursor: pointer;\r\n}\r\n\r\n/* サムネイル表示の外枠 */\r\n#map_grid {\r\n    cursor: grab;\r\n    position: relative;\r\n    width: 132px;\r\n    height: 132px;\r\n    margin-right: 4px;\r\n    border: 6px solid #888;\r\n}\r\n\r\n/* キャンバスが画面をはみ出た時に、サムネイルに表示する赤線 */\r\n#minimap_line {\r\n    position: absolute;\r\n    border: 2px #f00 solid;\r\n}",""]);const o=r},9912:(t,e,n)=>{n.d(e,{Z:()=>o});var i=n(8081),a=n.n(i),s=n(3645),r=n.n(s)()(a());r.push([t.id,'/* ツールウィンドウ共通 */\r\n.tool_window {\r\n    width: 180px;\r\n    height: auto;\r\n    position: absolute;\r\n    z-index: 1000;\r\n    color: #fff;\r\n    background-color: rgb(0, 0, 0, 0.3);\r\n    box-shadow: 4px 4px 8px #000a;\r\n    padding: 2px;\r\n    border-radius: 8px;\r\n    overflow: hidden;\r\n    /* すりガラス効果 */\r\n    -webkit-backdrop-filter: blur(3px);\r\n    backdrop-filter: blur(3px);\r\n}\r\n\r\n/* パレット編集時のアテンション */\r\n.attention {\r\n    background-color: rgb(255, 255, 0, 0.3);\r\n}\r\n\r\n.tool_box {\r\n    background-color: rgba(0, 0, 0, 0.3);\r\n    padding: 5px;\r\n    border-radius: 8px;\r\n}\r\n\r\n/* ドラッグ制御 */\r\n.tool_header {\r\n    margin-top: -24px;\r\n    justify-content: right;\r\n    font-size: 15px;\r\n    /* #axp-mainのfont-size指定(必要なし) */\r\n    display: grid;\r\n    grid-template-columns: minmax(18px, 30px) minmax(0px, 1fr) 24px;\r\n    /* minmax(18px, 30px)→img、minmax(0px, 1fr)→文字、24px→▲ */\r\n    margin: -2px -2px 0;\r\n    /* ドラッグ範囲のクラスtool_windowとのズレを相殺させる */\r\n    padding: 0;\r\n    height: 30px;\r\n}\r\n\r\n/* ツール名 文字 */\r\n.tool_header>div:first-of-type {\r\n    font-size: 13px;\r\n    height: 30px;\r\n    line-height: 30px;\r\n    overflow: hidden;\r\n    grid-area: 1/2/2/3;\r\n    /* grid位置指定 アイコンがない場合は1/1/2/3; */\r\n}\r\n\r\n/* アイコン表示 span */\r\n.tool_header>span {\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    /* imgを中央に */\r\n    grid-area: 1/1/2/2;\r\n    /* grid位置指定 */\r\n}\r\n\r\n.drag_zone {\r\n    cursor: move;\r\n    height: 30px;\r\n    grid-area: 1/1/2/3;\r\n    /* grid位置指定 */\r\n    margin-left: -2px;\r\n    /* safari */\r\n    isolation: isolate;\r\n}\r\n\r\n.minimize {\r\n    color: #888;\r\n    cursor: pointer;\r\n    display: inline-flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    /* grid-template-columnsの24pxがminimizeの有効な幅、▲を中央に */\r\n    grid-area: 1/3/2/4;\r\n    /* grid位置指定 */\r\n}\r\n\r\n/* ボタン */\r\n/*\r\ninput[type="button"],\r\nbutton {\r\n    font-size: 14px;\r\n    padding: 0px 0px;\r\n    text-decoration: none;\r\n    display: inline-block;\r\n    cursor: pointer;\r\n    text-align: center;\r\n    overflow: visible;\r\n}\r\n*/\r\n.mybutton {\r\n    cursor: pointer;\r\n    width: 70px;\r\n    height: 30px;\r\n    padding: 0px 0px;\r\n    text-decoration: none;\r\n    display: inline-block;\r\n    text-align: center;\r\n    border-top: 2px solid #777;\r\n    border-left: 2px solid #777;\r\n    border-right: 2px solid #333;\r\n    border-bottom: 2px solid #333;\r\n    border-radius: 5px;\r\n    color: #eee;\r\n    background: #555;\r\n    font-size: 14px;\r\n}\r\n\r\n.mybutton:hover {\r\n    /*\r\n    background: #888;\r\n    */\r\n    border: 2px solid #bbb;\r\n}\r\n\r\n.mybutton:active {\r\n    background: linear-gradient(#222, #444);\r\n    border: 2px solid #333;\r\n}\r\n\r\n.mybutton[data-selected="true"] {\r\n    background: #aaa;\r\n}\r\n\r\n.mybutton:disabled {\r\n    background: #aaa;\r\n}\r\n\r\n.size_big1 {\r\n    width: 146px;\r\n}\r\n\r\n.size_big2 {\r\n    margin-top: 4px;\r\n    width: 260px;\r\n}\r\n\r\n.size_big100 {\r\n    margin-top: 8px;\r\n    font-weight: bolder;\r\n    font-size: 15px;\r\n    width: 100%;\r\n}\r\n\r\n.size_mini1 {\r\n    width: 62px;\r\n}\r\n\r\n.size_mini2 {\r\n    width: 30px;\r\n}\r\n\r\n.size_mini3 {\r\n    width: 36px;\r\n}\r\n\r\n.size_80 {\r\n    width: 80px;\r\n}\r\n\r\n.size_60 {\r\n    width: 60px;\r\n}\r\n\r\n.displaynone {\r\n    display: none;\r\n}\r\n\r\n/* サブウィンドウ（ペンのサブメニュー＆レイヤー名の変更）============== */\r\n.subwindow {\r\n    touch-action: none;\r\n    display: none;\r\n    position: absolute;\r\n    z-index: 2001;\r\n    left: 0;\r\n    top: 0;\r\n    height: 100%;\r\n    width: 100%;\r\n    overflow: auto;\r\n    background-color: rgba(0, 0, 0, 0);\r\n}\r\n\r\n.subcontent {\r\n    background-color: #ddd;\r\n    color: #000;\r\n    border-color: #000;\r\n    border-style: solid;\r\n    border-width: 2px;\r\n    border-color: #aaa;\r\n    box-shadow: 4px 4px 8px #777;\r\n    border-radius: 5px;\r\n    width: 240px;\r\n    height: 80px;\r\n    padding: 4px 20px;\r\n}\r\n\r\n.subcontent input {\r\n    font-weight: bold;\r\n    padding: 4px;\r\n}\r\n\r\n/* 最小化アイコン表示部 */\r\n.task_icon_vertical,\r\n.task_icon_horizontal {\r\n    position: absolute;\r\n    width: 32px;\r\n    height: 32px;\r\n    z-index: 4000;\r\n    cursor: pointer;\r\n    border: 2px solid #333;\r\n    border-radius: 5px;\r\n    box-shadow: 0 0 2px #000;\r\n    padding: 2px;\r\n    background-color: #ccc;\r\n}\r\n\r\n/*最小化アイコンツールチップ*/\r\n.task_icon_vertical::before,\r\n.task_icon_vertical::after,\r\n.task_icon_horizontal::before,\r\n.task_icon_horizontal::after {\r\n    position: absolute;\r\n    opacity: 0;\r\n    pointer-events: none;\r\n    transition: all 0.1s;\r\n}\r\n\r\n.task_icon_vertical:hover::before,\r\n.task_icon_vertical:hover::after,\r\n.task_icon_horizontal:hover::before,\r\n.task_icon_horizontal:hover::after {\r\n    opacity: 1;\r\n}\r\n\r\n/*縦並び用吹き出し▲*/\r\n.task_icon_vertical::before {\r\n    content: "";\r\n    box-sizing: border-box;\r\n    width: 15px;\r\n    border: 7.5px solid transparent;\r\n    border-right-color: #0007;\r\n    top: 30%;\r\n    left: 25px;\r\n}\r\n\r\n/*横並び用吹き出し▼*/\r\n.task_icon_horizontal::before {\r\n    content: "";\r\n    width: 0px;\r\n    border: 7.5px solid transparent;\r\n    border-top-color: #0007;\r\n    top: -10px;\r\n    left: 6px;\r\n}\r\n\r\n/*吹き出し中身 共通*/\r\n.task_icon_vertical::after,\r\n.task_icon_horizontal::after {\r\n    content: attr(data-tip);\r\n    border-radius: 3px;\r\n    width: max-content;\r\n    background: #0007;\r\n    padding: 6px 3px;\r\n    line-height: 1em;\r\n}\r\n\r\n/*縦並び用吹き出し中身 配置*/\r\n.task_icon_vertical::after {\r\n    left: 40px;\r\n}\r\n\r\n/*横並び用吹き出し中身 配置*/\r\n.task_icon_horizontal::after {\r\n    left: 0px;\r\n    top: -37px;\r\n}\r\n\r\n/* 最小化 アニメーション ------------ */\r\n.icon_close {\r\n    animation: icon_close forwards ease-in-out;\r\n    animation-duration: var(--tool-duration, 350ms);\r\n    pointer-events: none;\r\n}\r\n\r\n@keyframes icon_close {\r\n    0% {\r\n        left: var(--tool-left);\r\n        top: var(--tool-top);\r\n    }\r\n}',""]);const o=r},3645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,a,s){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(i)for(var o=0;o<this.length;o++){var l=this[o][0];null!=l&&(r[l]=!0)}for(var d=0;d<t.length;d++){var c=[].concat(t[d]);i&&r[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),e.push(c))}},e}},1667:t=>{t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},8081:t=>{t.exports=function(t){return t[1]}},9668:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(5119),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},8159:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(2e3),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},6835:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(571),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},2825:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(2500),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},3349:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(1112),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},7055:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(4272),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},6025:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(4867),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},4644:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(5399),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},9756:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(4033),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},166:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(5516),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},7995:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(7768),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},3401:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(7487),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},6932:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(8026),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},1897:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x});var i=n(3379),a=n.n(i),s=n(7795),r=n.n(s),o=n(569),l=n.n(o),d=n(3565),c=n.n(d),h=n(9216),p=n.n(h),u=n(4589),g=n.n(u),m=n(9912),b={};b.styleTagTransform=g(),b.setAttributes=c(),b.insert=l().bind(null,"head"),b.domAPI=r(),b.insertStyleElement=p();a()(m.Z,b);const x=m.Z&&m.Z.locals?m.Z.locals:void 0},3379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var s={},r=[],o=0;o<t.length;o++){var l=t[o],d=i.base?l[0]+i.base:l[0],c=s[d]||0,h="".concat(d," ").concat(c);s[d]=c+1;var p=n(h),u={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)e[p].references++,e[p].updater(u);else{var g=a(u,i);i.byIndex=o,e.splice(o,0,{identifier:h,updater:g,references:1})}r.push(h)}return r}function a(t,e){var n=e.domAPI(e);n.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,a){var s=i(t=t||[],a=a||{});return function(t){t=t||[];for(var r=0;r<s.length;r++){var o=n(s[r]);e[o].references--}for(var l=i(t,a),d=0;d<s.length;d++){var c=n(s[d]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}s=l}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},9216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,a&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},8637:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC5klEQVRYhe2VX0hTURzHP/dqsUFQlnOOoezB2Epd6INEaIwIJInECdZL0ZtPRS+LVPAPQoOigh4shF70yQeJQSVh+VIKFUgxF467ic9ZSGEw2HZPD+dO17gbzBw+tC8cuOec3/39vuf3F8oo439HRc5eBS4DOrCxHwSOANNAArABt4C3QCpHTgUuASHADcyVgpwf+AxUGYZCWXfTgF5fX58EfgOeUhDIxkXgjvF9GEj19vbqq6uroqmpSQAvgSAwUKxi1eTMYZxXA9eAk8ABwAVYgdOAMj8/r0SjUZxOpwAuADeN+0bgOnC0WDIAx5AJ2A2cA+LIl/uBp4AFUJBx/2XI/gACQBtwH9gyzh/uhgBArWEkG43AA+CgsZ8D0sBjwAl0ARtWqzUxMjIixsbGBDJxz+yWRAYqMiQDwAIyFACDhnILcA9I+3w+fXFxUY/H42JlZUW4XC4BvPhXAn7kS6qAq0BP1t0p4IvFYtFHR0d1TdNEPB7fXpOTkxkvdBVr1IaM9wmkB2qN8xA7WX4eEK2trfrS0pKebTizNE0THo9HID2XG9JtmFVBM3DW+EkHfiIzuhtZahmSDA8PK3a73VS5qqqMj4+jKIqPAl4wI7CALL2vxv4R8CZHJgR8m5iYQAiRTzctLS10dnaCzBOrmUxuKzbDGvCcv2dDEoiura1d6ejowOFwmHpBURTq6uqUmZmZauA78KEYAj3IPHiH+WDSgLbl5eXjfX19VFZWmpKoqakhHA4r6+vrXuAJOXOlEAE/shu+LyDzcXNz80YymaS9vT2vF9xuN7Ozs4dSqdQBcsJplgMZ3GUn6fIhBgxOTU0RDodNBYQQJBIJVFVVkBN0z1EBvGpoaBCRSGS7DGOxmIhEIqK/v19YLBYdGf/mUhAA2aq3AoGAiMViQtM0PRgMCpvNpiNnw20Ke3tPMAiIoaGhtNfrTSN7yGvAXmrDGVQAzwzDn5BVlLcDlgrqfhkuo4xd4w+Gc/4wRA2pHgAAAABJRU5ErkJggg=="},932:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAqElEQVRIibVVWRaAIAhEX6fp/mfpOvRlobKJMp8as0BRAT9QOC9akXppELt4rhVyfAbWe0OZko/EggjLVS0HGrlkqDOgPUzJuXa0ey2FmWARUwpOwOW+K1DaeDqBKTC5D6Br05QgSi7VUQHPF7uM8AyMpJ/ZSg82e8/WZ75FmCIwpqhwqD0SrHUNm+LoEhhXhSWIz18TmoHnR9OQvouyZwAFklZEQ3qLXjz+NU6cSgzSAAAAAElFTkSuQmCC"},9371:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEKUlEQVRYhe2WXUikZRTHf+84ujrN6Gg4ss0kS22aQazlRZJ13UUYiF+IgaViF0nF3qngjd6EXSRC0VWEOkRJCH57oY4wUhHLQGxu69iG2dbU+JFfO7Y7c7p4ntlmZkdnDISC/vAw7/ue5z3nf/7nOecd+B//cWQAfcD1nJycW9nZ2beAL4G3tO3c8Z7ZbJaBgQGZn5+X1dVVmZ2dlaqqqggwct4kngckdhUXF0t3d7f4fD4pLCyMAG+fV/BC4LvKykqZm5sTj8cjIyMj0tHRIRaLRcrLy6WsrOwe8Ol5BDcBszabTbxer/j9fllfX7+/xsfHxWazCRABOlM5+yc1egd4c3h4mJKSEgzDiDM6HA6CwaD4fL5D4HUglCqbs+Ai0FtbW0tFRQUigojEbRARWVhYAPgI2E3l0HyG4CbgY4fDYe/q6nog8ygWFxfZ2NiIAJ+k6zRdvAq81NnZyeHhIYFA4AEFRITR0dEIMAt8ewbfKVEAbJLQdna7XRoaGsTtdovf75fJyUkxDCMCvJyu43RKYAI+KCoqemR6epq8vDwAgsEgy8vLuN1umpubaWxsZGdnBxH5Bpg6a4anoQUQq9UacTqd4nQ6xeVySX19vUxMTMja2pr09/dHVYmgSpWIF4HngBeAZ2MN6ShwNT8/n7a2NsPhcACwtbXF1NQU1dXV9PX10dTUhNfrZWZmZhP4PImPy4AdOES1/rV0CdiByz09PdTU1MQZ2tvbGRwcpLe3l6OjI5aWlgR4FzhO4qcUuAs8DARiDcl76W9cAn7weDzicrniOibaAa2traysrEg4HN4EnkhCwAR8iEo2C9gAemKNp2EXOBoaGiIcDscZDMPAZDLR0tIi2jaSJDhADvAHSv4Q8FMiu1QEro6NjRl1dXXi8/mOQ6HQ/exDoRCBQCA6CIZP8FGsf0X724lLJAWBKF4B3gcu5eXlGVarFYC9vT329/dFB39NB0lEKfAGqkP+BD4DfOkQMAGZQFi/LKgaVya8dwP46gQfuUAHkA9YgCPUN2IjuiFZF5iBJ4HHgQP90g2UdDf1SgcZQBlqiubqBNaB7cRgiXgUeBp4DPgV1TbplioKE/AMaujY9X1Akz9IReAp1MSyAuXAF8CdMwS3oD7bV1BtHFXxGvB94uZkBDJRkrlQ9c/VZE4jkY2SvEgHvYJS0Ar8COwDvwDBdAiYUL27rR1W6PvfUW20CzyEqmkB6oBaNfF8vXZi1m1gEfAnY56MQFBvztJOD1CHsgi4h1LFoq+3Ua2FJmUCftbXv6Gk/1o/S4pk/wm3UBPNrAlk6EAXdPBMlOR39PMClMSgpp2hA98EvKj/EckmJHDy6b6AqmUpKvss/ewiqgQ5OugxSqEDTfw2qtZ7+j5yUuBUBGJh1gGtmoQZJbWgzkUYNePvpuHr34e/AD3wjysuWELmAAAAAElFTkSuQmCC"},4215:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAABFklEQVRYhe1WSRLDMAgTnT4iD8j/f+R7XlF6ouMkGLN4podWp8TCDhKYFvh10MKzeLD2sDaZpBfbtqX3rnCAAaC1dieYse+7xKhiSw6MlDMzmLWK3FFxwKMcrTXTiZQDK5QLnonv83EcqnIAJ+UehBxYqVwQcWCp8kwC94wmqjt+GFhKAJgrFx6VOdDXXuptqe94hqEe8M2Bz33v77cgOwEF5RJcPyyP3j2hBIho6IRgVvN0AqKOiNR1efWeJ3D3gKCvueKEVXPW+HAPFBSrsWEHFC76g3ZywuNAbsg74Ulgyd+2rxw+wMlRrQfUbvUe2K1d97tvQbTm3vhwLzGAV5HnWZzVhLOMqzyA/BzI3H8VX58Df7wBWFyk7NpwigYAAAAASUVORK5CYII="},4506:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAC0UlEQVRYhe2VwUuTYRzHP48WeBm4am05OujFgzKcJdhfoMIQlIhBhBAqKl7Kswdlg0D/gg4hgoNgSlBQbBQd9JBph+FIXt/3GHUorLE3Yr2+vw6bus2tNpt12Reew/Pj+fH5Pr/n9zwP1FVX7dQA9AEX/wf8CvACsIH3QM+/hN8B9oGDnAE7N79+1uBG4GEOfAgXh8MhnZ2dkjMROCv4BeBxPhgQl8slq6urommaDA0NCfADuFtruAt4x3G5BRCfzydbW1tiGIYYhiGapsno6KgNpIFrtYJ7gY9kdy65YQ8MDNj58HwTHR0dAnwpZ6KhCrgfeANczg/6fD4WFxeV0+ksWCwixGIxkskkZI8sTonGrNRAL/ASaMnlNAAMDg4SjUZVU1PTCXgkEmF6ehqyVQJwAvcr5BXID6Q4LrkopWRsbEw0TTtRdl3XZWpqSvLX54YNPKgW3gN8LoaHQqETYMMwZG9vT2ZnZ8vBnwPnq4G7gX23213Q7QsLCyXhmqZJMBgsB09wiic65HK5fu7s7Mj4+PgBYAcCAVvXddF1vQC+ubkpfr+/GHo4EmSvbtVKTk5OHp3r/Py8rZSyJyYmCgxsb29Lb29v8a4PH6i3ZG9A1fIAB0tLS3Z+c4XDYVspJcPDw6JpmmxsbNhtbW0Wpcv+Grj0J9C5MvEmoKG1tfUooJQiGAyq5uZmZmZmxDRNtb6+rkzTbCzKFeAJEAQypzUAIJlMBkDlB/v7+/F4PIyMjIhpmqo4B3gK3AKsP8Gh/EP0CdhfWVkpBgDQ1dWllpeXlcPhKIZHgZuVwiH7pZaSBbh2d3dveL1e2tvblVKFXtxuN93d3bK2tnYYigC3yTZgxSpnAOCVZVktsVjMn0gkME0T27aVZVmkUimJx+MyNzen0un0dyAM3CPbfDVXH/AM+EDh/U4Djyj6nKpVyTP+zdqreTlfgW9/A6+rrroAfgHtW6W7+RvhCQAAAABJRU5ErkJggg=="},6219:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAChElEQVRYhe2VT0gUURzHP08rBnQPW21rdQi8KgtLCXv0tgiLoCcvgYaKiqeuYgdZIdA9eunQKRYKdyEICiPo4iHTDuISPN8co0siRIegfL8OO5Oz4245tirEfuDxZoY3fL7ze38GWrRoHm1AFrhyHvLrwCvAAh+BvrOU3wX2gQMvgPXu75y2uB145Il9ucRiMent7RUvRO605JeBp0ExIIlEQkqlkmitZWhoSIDvwL1myxPABw7LLYCkUinZ3NwU13XFdV3RWsv4+LgFvgG3myW/CXym+uXiNTswMGCD8mCInp4eAfYahWiLIE8D74BrwYepVIrl5WUVj8drBosIa2trVCoVqE7Za+oszOMGyABvgBveO20Ag4ODrK6uKsdxjsiLxSKzs7NQrRJAHLh/TF8NaeArhyUXpZRMTEyI1vpI2Y0xMjMzI8HxXrPAw6jyPuBLWJ7P54+IXdeV3d1dmZ+fbyR/CVyMIk8C+8lksma1Ly0t1ZVrrWVkZKSRfJsTHNH5RCLxY2dnRyYnJw8Am8vlrDFGjDE18o2NDUmn02Gp37apbt3jMzc3J0BlenpaRESMMbKwsGCVUnZqaqomwNbWlmQymfBX+wfUe6o7ILJcwhhjZHFx0SqlZHh4WLTWsr6+bru7u39Sv+xvgauR5B51A4iIuK4rKysr4jiOzWaz0tHR0WjOy8Clk8iDIWyjEKVSyXZ2dv5emCH5c+DCv8h99kZHRxtWolwuSywWC8ufEXGr/RHHcWyhUKhbCWOMFItFq5TyV/sToh3tf6Xd6w/6+/vrhujq6vL/dg+aLQ/zAvgUlHvix4R+TqeJP9e3Atdny9jYmADi9edDoVA4P3mL/5JfpBcZsB/cpIwAAAAASUVORK5CYII="},6991:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA30lEQVQ4je3SvUpDQRAF4E+9VZArWFlIEAtJaSoVtLfPO/gAwUb7dCEvEF8jCGlCCrHWKqAS8acQjCIIKsFgcXchxYLaitMszJlzZs/M8B9/IOawjit84PQX3AOswgqucY/8h+QyRujGRBtDdLDwDTlHH+/Ynla8wE14a5hPkHdxiWc0YWYK3MFRyOUY4xx3yLCpsPsW6g4xyQK5hCpeMMAaHrCBLXziFWfoha8v4jF276AVrFBspoEn3KIehGLDPcXclqJAJeF3GSc4TmCz2Ec7Kg4SRZniNoYJbCIM8Qt3ny0eu9pmggAAAABJRU5ErkJggg=="},4529:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABZ0lEQVQ4jZ3SPUjVYRQG8F9eBREXUcwuQhANrnEpidp0uzRcRKdqcGgKaYjGpsZwSQQnaWhoaLRNNykoxI9IJQcHBRHt3pQatA+H9/z19scSfOCF9z3vOc9zvgr+jzt4iRr+YOdfjk/RkLN14DOunCFCOLbkbH2YOCOuMVOdQSX/ie+nBDXjMeYwnxmv4hPKdY7FcCoHWYbnGEUXXKj76JV68RUraEc/LsV7Gsu4H9keZGnW4xA30IZJzKIb1zGEAtbQGkLHeBAKb1BCJ17hG3bxAbcxiI9BfCsLHojAh04m8TpSrKGKjSAUtY9Hf0qC8VGulBf4hR/SJDbxLmscLmIKUw3SWJZzBO8jg6aouxb3vfjfxxIuF+LxDNvSQsFqqG5jIdSeBEEPxkKgmilWpD0Yw02py3kUMYLFELqHlvo96MIw7uK3NIGfcdrC1oy3UhPX+XuRMnRIc78Wd5H6F2nUW6fEnB9Hz9lVhydI1Z8AAAAASUVORK5CYII="},8472:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEGUlEQVRYheWXz09jVRTHP6/8aLE0iFpt1LSQEAnhhzGxuEAoaS3q4Ewyq9GVrkB2A6EBDQQ3uGH+ABEJSTH+WAiRhJiaEH4YqIOMwcEKQ9tJZNBEQpQEdILQd1y8PiydQkuZWRi/yUtf3r33fL/3nHPPuYX/O3KyXFcAPA2YgL37JydzjAECHAIfAYZsDSkJ71bgApAbN/wXcB24EydLxC3gmfi7AG8B/mxF6PgmbizxUYEwcDlJ7IdJ89aTxrPCrRQCEoV8D7wSn2sFbiSN288r4M24oZNECBAD3o7PfxT4PEGA47wCCoCv0wjQE08XkYOWhD8BDyfYegq4dBZyA1rCpXJ9LMX33+OCk21cBr4C/oyvq85UwOspSHQB+hMDbgOfAB+g1QCd+CUgCEhFRYX09vZKZWWlAF+kI86N/yZnsBr/pqJ5ZgL4FNhImlcBXFMU5UJtbS0tLS00NDRgMBgQEUKh0MvA48BWOgFfosWxIk76MzAOfAwsp1hnA3xAa2VlpamjowOXy4WiaPtQVRW73U5eXp754ODgKvBuOk+AFlMH8MQpc3KA94G90tJSta2tLba2tvZ3JBKRaDQq4XBYhoaGpLq6OjGMYc5RKXUoQCPwncVikb6+PpmfnxdAqqqqpKurSwYHB8Xlcp2UR8+fh9wGfAaIy+WSQCAg0WhUIpGI+P1+cbvdKY+rxWKR3t5esdvtAlw7yfhprjGgxe62zWa7Mjo6yvDwMGVlZYgI29vbTE9PEwwGjy0ymUwoioKiKGxubuJ0OkErcqZ7KU5HGSAej0eWlpaOdh0KhcTn84nRaDy2Y0VRpKmpSRYWFmRubk5aW1vF4XAkhsEPvMAZesZDwGJxcbEEg0EJh8Oq3+8Xm812j7tdLpdMTk5KJBIRPSF1wWNjY1JSUpJYT+4A7+gk6dQ8Asw7nc7yvb09WV1dPRaympoa2tvbaWhoONXI1NSUtLS0CHAFeA5YQjvmGbmjCq1VH9V6q9VKf38/brf76OyfBBFhf3+furo6dnZ2fCQlZCbn80e0NnwXEJ/PJ7Ozs3g8nrTkAIqiYDQa8Xq9oPWKY8i0QFwHrgJiNpsP8/PzM1z2r4jm5mbQkvDZxLGzXEpvAFszMzOvFRUVUVNTo2TiAR1Wq5WRkRHD4eHht8AP2QgALXm25ubmXt3d3TXU19dnFIZYLEZPTw8rKysq8B7wW7YCdBG/LC8vX9zY2FAaGxvJzc1NOVFEWF9fp7OzUwKBwF3gDWAmC86UeBH4o7y8XF1cXFT1s59QA9SBgQHVbDarwK+csx+chCeBmw6H43B8fFzVi8/ExIR4vV79EhMAHnsQ5DqswM3CwsJYd3e3eDweURRF3/VF7sN1PRMUoF1eVGAN7Y9K8p3xgcOA1rr/W/gHfXHTs2UHg10AAAAASUVORK5CYII="},5890:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAGG0lEQVRYhe2WXUxTZxzGn3N6zqFd+fCDshWYEai1hkGos8IEpRNOhVANEk1nnINkxBHEaNVAGk28KNBYkSaGeGFUnEYuLAyiGKdMlDQ6MWjVxCBmHXWY4VjrTLU0ODnvLgxdBQS/5tV+ybn6v//nec7/fc8H8D9vSElJiSUuLu5CbGzsraampg0f1DwnJ0cBgKSnp5PExEQCgGzcuPHaBwtQVVUVDYAkJCSQ7du3k5qaGgKAlJeXb3knYafT+ZFWq92+aNGihqSkpDaNRnM1Jydnj81mW2a1WunQtTabLWn16tWPOI4bjY+PJ/n5+UQsFo/s3r2be+sAer3+EE3TZMGCBUSj0RClUknkcjlhGIZIJBJ/WVnZaYvFEhPaU15ezlVXV+9TKBTPAJCoqKhFb+NNAUBycvIxQsiG1NRUUBQFkUgEjuPAcRy8Xi+6urrw+PFjlJaW6g4cONAxXsRgMKxIS0vrMZlM3jcNIAKAbdu2Rdnt9kKe5zFv3jzI5XLIZDLMmjUL8fHxyMzMBMuyaG9v31BRUXHxypUr90NF7ty547pw4UIAAMxm8zeDg4OXjEbjqc7OTs9rTQAA1Gr1bafTmaLT6aDT6YKTYBgGDMNALBbj7NmzaG9vF/Lz85nm5mYSKmQ0Gj/r6ek55HA40qVSKUQiUYfP59O9VgCn0zmb53mPQqHAunXroFKpwDAMaPrF+RMEAfX19XA4HPD7/VCr1bE9PT2DYyKFhYWX2trasmUyGXJzcyEIAux2OxEEgX6FbxCR0+kMMxgMg9nZ2VxVVRViYmIgEolAUS+Gs2/fPlRXVwPAzyqV6uuCgoIdra2tf1ZWVjJisdjo9/uv9Pb2ztXr9VAqlS/uiqIwMDBAFRQUJPT29rZNOQGtVpty7dq12zdu3AiaPn36FCaTCefPnwfP8z6r1fq5Wq3+ZazJbDZ/3NjY+NDtdmP58uWQyWQThJ8/f46WlhYIgkBNKIZAx8bGegOBACwWCy5evIg1a9YgMzMTd+/e/bGiouKLjo6OqDHz+vp6+Zw5cw7X1tY+lEqlMBgMk5r39/fDbrdDEATk5eVpp5wAALS2tm4qLS0t8nq9f2VnZ//W1dW1bfxCm832rclkOhQZGYnFixcjIiIieKejo6MICwvDzZs3ce/ePYyOjgb7oqOjWz0eT9GUAabi5MmTy0wm0/cul2tuVlYWFAoFKIoCwzDo6OiA2+2esp/juKfPnj2LeKsARUVFvtOnT0csWbIEPM+D47jgkwEAfX19OHHiBIaHhycXpygQQpCXlzcSHR1dm5yc3GAymR69VoCVK1c2nDlzZtOePXuCh3OM4eFh1NXVwefzTdqrVqvB8zwiIyPh9/thsViQlJQEl8uFmJiYP4aGhj4ZW8u8KkBYWJhNoVBsam5uxtq1awEAgUAAjY2N6O/vByFkQk9ERATMZjMkEgkIIWBZFizLYsaMGXC5XDyAn2bOnJkwNDQ0/QQA4OjRo3ElJSUDmzdvpu7fv49Tp05Nuk6pVGLr1q2YP3/+S1s0RkNDA9xu94Pr169/Or427SGsrKwsOHjwYLvP54MgCBPqhw8fRmJi4pQafr8fer0eGRkZcVevXv09tDbtq9JqtZ4pLi7WhZqHh4fDaDTi3Llz05oDgFQqRUpKCrq7u9PH10TTdgPo7u7+defOnX87HI4cpVKJpqYmqFQqiET/ttM0Hfx4cRwHsVgMiUQCqVSK8PBwyOVyXL58OTcQCFhDtafdglB27Njxg81mW33s2DGkpKSApungNf5JGY/f78fChQsneE67BaHU1dUVrVixonb9+vVwu91gWfalD9erYFkWXu+LfxWNRlPzJp6TYrVav6Mo6vn+/ftJX1/fS5fL5SIPHjwgHo+HPHnyhBBCSEtLCwFAVq1adfTIkSPydw4AALt27SqjKIp0dnaSVzEyMkKysrIIAJKRkaF9L8ah1NTUfMWyrLBly5YJ5rdu3SIURZHU1FTP8ePH57138zH27t0rmz179nBhYWFw5DzPEwCjxcXFDf+ZcSg2m02k1WoHABCapklubm7v0qVLoz+IeShlZWUlaWlpX35w43fhH0T4gcNKUi9fAAAAAElFTkSuQmCC"},8497:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAClUlEQVRYhd3Xz4tVZRzH8ddxBsa4zVxKB69zURkIctFMKEaUMBsH8w+wRYI6blyUmCuljbXLhUPQok2BRIzLAcF+EWO5mC5TqAiCooMhYhFFCuOPLLxPi+dcO9g9c3+NF/IDhwOH5/t9f855nvP9Pg9PkAp4Jb13Xa/iVwR80m34y/g9hQdMtxK8rEN4GSexIvPsVrcM9OBjrOwgR0c65N/Pnr32dgP+Yg68ipe6YeDTHAO/oe9xw1fhdo6BDx43HA7mwG9i/SNjl2HjUsITXK0Dr+LdOuNX4xf0LpWBrXXgAfPyf+kDeGOpDHxUB34P2xrE7UJxKQxU/PfTv99EXIJ9nZoo4cEj8C80X0178TVea9dAdv6r+AHPNBm7QTRbxdvtGtidgX+FpxuMT8S3/TaNqeK8DgrVGlzEO2nyPPXgLZzLGL6DY3i2VWgP9qfBe7C2ARw+S6EP8GVquNQqmNhUzvT394fR0dHs3F/BjkXirqXggXagNZVxc2RkJMzOzob5+flQqVTC9PR0dWJiIohv915O7JbUQFPqyXl+ZHh4ePPU1FQyODgoSRKFQkGpVErGxsYgmZubW4sP68T+JO6KduIyFhYzkFejnyoWi/cHBgaWhxAeznmSJBYWFszMzMD9RfJ+nho5gr9xCicamclqE+4ODQ1Vy+VyKJfLYXJyMlQqlTA+Ph7EBrOpyVwXxLXzerPwmg7LlN1SqRT6+vqqOKv5Fvsc7uJHLf7/L6Sg2sqvgXe3kKNX7B2ntNEDvhf3+sfFDcjzLcYP4ijebDQwr6gU8Zd4zNqKn/Fdg1wFbBePZ6fFxvNHuwZq2oJvxCm4LDage+l1CX9indiUboir/1IjaCsGiD2gkEKzCrie3v+/+gchBdKwQke8WgAAAABJRU5ErkJggg=="},269:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFwElEQVRYhe2XX0yTVxTAf7dOKgI2IhQsMXGGLRPBLkZXN4OQyoNparIGI1FTiUGCS0jUB5zREqPhwX/Loi5xD/7BiEYeQB7mn5hNJBpDIDMRcJrxVaIRlP5zogltld494PfZllZwe9xO0uTrPfec8/vOPffc+8F/XUSCsdlAPlCQQJcLfPEP4owCXcAvgO9DADOAR0Cu0WgU06dPj1XOmIHZbP7o6D6fj87OTsLh8M/Ad9G6T+LmrhRC5La2tlJUVIQQAinlOKlIlKypS11dHa2trTPix+MB5ppMJrF48WIALbj6PBWIaJupiO5DymQBpZQJAyUamww6PgMTnCVz4PV6GRkZ4d69e9qY2Wxm3rx5pKSkxPj5EERSgPjgKpDH42H//v1cu3YNgKysLPR6PT6fj1AoRG5uLjU1NWzcuBGdTqfZSikjHwWQiLqtrY19+/ZhNBo5dOgQy5cvx2QyIYTg5cuX+P1+mpubaWho4MSJE6SkpOBwONi2bRuRSOTtR2cg+u2bm5txuVxs376d6upq9Hp9THoNBgMGg4GFCxcSiUSw2WyEQiGOHz/O2rVrGRsbS0nke0oADx8+xOVyUVNTQ21trQYFEIlEePbsGVJKTCYTbW1tlJWVUV9fTzAY5OrVq5w7d447d+4APJ0sVmVeXp50u91SURTpdrtlf3+/LC4ulkuWLJGKosju7m7Z1NQkFUWRiqLILVu2SEAC0mKxSCGEPHPmjKa32+2aHhgDvo4OmHQbqqnt7e3l1q1b7NmzByEE7e3t7Nq1C4CRkRHOnz/Pjh07OHr0KF1dXUgpWbBgAUIIhBDajrhw4QIWi0UH/DAlAHWvt7S0UFhYqLXg6B7Q09NDMBikoqICu93OqlWrJvgAKCkpwWKxYLPZALInBYhuKPfv32fFihUxu8Ln8/Hq1SuGh4cxmUxkZWUhpWTNmjUAhEIhbe7AwABz5swBxs8SYNqkAGr6Xrx4wcDAAPn5+ZrOarVy8OBB0tPTycnJYWhoiKGhIQAKCsYPULfbrc33eDzx7t3Rf5Iugd/vp7KyEiklxcXF2vjs2bOx2+3odDqWLVuGwWDgypUrCCGYP38+aWlpPH78OMZXamoqUkp6enoAUoA/gD+BZUkBWlpaePToEWfPniU7+/2yqdkB0Ov1lJeX09jYSCgUQghBRkYG/f39wHiR+v1+rX46OzsBVtpstoUmk+kz4GhSAEVRKCgooLCwMGZcLUK1TpxOJ8+fP+fixYsArFu3DqvVipSSjIwMDhw4gNVqxev14na7qaqq4tixY2rB5sT328q8vLzGjo4Obt68SXV1NVarFafTidlsJi0tjfr6em7fvq0ZqB3v0qVL3Lhxg8zMzIQHWSQS4fr165SVlfHmzRusVisej+enpJ2wtLSUkydP0tDQwObNm9Hr9aSnp/P69Wtqa2sxGo309fXR1NTEtGnTGBsbi1kmNVvqs06nY/Xq1UgpOXz4MB6PRwKNCQFUo9LSUkpKSvD5fHR1dbF3714qKirYunUrAOXl5TgcDjZt2oTT6SQzMzNmqeIhpJS0t7dz6tQpCfwI/P7BC4kKk52djc1mY+bMmSxatCgmSFFRER0dHezcuXOCXfyJGggE2L17t5RS/gZ8D5PciOLFaDRy+vRpreJVmTVrlgaU7KYUDodlVVWV9Hq9L4FNwNuEAOFwWEYiERnvSAiBy+VicHCQ9evXc/fuXZ4+fcqDBw9wu90Eg8Gk4IODg2zYsEH09vZKwA480/zGzS0Drufk5LB06VKh1+snOFMURW0o2gsCOBwOceTIkQnznzx5gs1mk6OjoyPAt8DNaH18Ef4KfDk8PPzN5cuXv0oAGB20i/EPjgGguLu7uyHRxL6+PkZHRwFWAj3x+kS7oOfd7+ckwRPJp4FAgLq6OlJTU2M+XgKBgLqWfyUy/HdfG+9lDlAH5ACfA3Pj9P3Aat4t1/8SLX8D+hqAxFxJPLkAAAAASUVORK5CYII="},5668:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAt0lEQVRIib2VWw6EIAxFW+MydXWyz/oxw7RAQdri3IRERc6ljwDCWPQwL4UzH0vgZeCfBQrrByZZoM9miD/4CrBisr0CF8xtPbnU6wZ7mHAo3Zk45X4DCU79GvpSNAkHsEZgAGeVERyo59QJbw3ywtrECW8NNJMAXDeQCsL7BjXMCQcYdVEAKvWns+jstGZEX6Ykk/nYHm8MAbgGLXk+quGPXOS8+87dGhHBRQSfKPJYJr6T+X2pbgnMNdOnO8qdAAAAAElFTkSuQmCC"},7901:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAARUlEQVQ4jWNgGGjAiEP8P7HqsRmASzNWPegG/CdVjokYW/CI4TSAaDDwBiD7i1DoY9VLcy/gSmhEG0CxCyg2gGDAUuwCANwbBhtd7LHHAAAAAElFTkSuQmCC"},5734:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAALUlEQVQ4jWNkwAT/0fiM+OSZsBhAEhh4AxgZSPQzuvzAe4EqYYAORtPByEsHAKoFCBuY5JqoAAAAAElFTkSuQmCC"},9213:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADCUlEQVRYhe3WT0hlVRwH8M97o+9p+LRwpBbVokV/XAwY08ImfQwNtRFpUUyLSinIcBYxkC5FKCoqJyKoKBdB2SLsUbh6+Gg2pmBEYAiWSZGgm9FQZgZnHN9tce97vnk5pL4ZB2K+cLj3/s6539/3/M75/c7hFvaPx/A7vkPzQTqO4xVcQR7nsYrnDkrA65Hz97CCHnwZ2T7cK1l8HwJ+Rjdewzo28AJewtI++CrCH+iqhGA/ESjFZWEEbhpuR6wSgv3+HMfzSJdxXMI3+AEXb5SAY3gfj6TTaY2NjWBjY8PExIT19XX4BceFWXJdcQpBS0tLMDY2FiwsLFzVZmdng97e3iCRSAQY2g3hoT04fxSjnZ2dseHhYU1NTSAW2w5iVVWV1tZWm5ubpqenj+Aj/7FJS7Mghk9xeodxtRhub2/PDw0NicVienp6TE1NgWw2K5vNFgV1dHTAbWgo4TiGszh8LQGn8CImdxBwAg/09fXF4vHwl7m5OcvLyyCXy8nlcttqa2t3muwCHsb3aCwYq6LncXwQKXwwaovRYOhta2vLNzc3F8arrq6WTCaL7wVhsLJS3Hu1+ATJ6Ps3HMW70WSLAgiX4Cjui75nIgEv44l0Ol30EIvFZDIZqVQKDAwMCIKgSDQ5OUlYlhfLohBE7f7yCJzFZ3gGJ/FjZL8TZ7q7u4OurqsrbkPD9vLW1NRsewgC4+PjhQlcEJ6cBbwtPLpfLRhK98BpLOPzEtuTiURCf39/vDTE10I+nzcyMhLMzMwE+Lis+wT68QZ+KhhL03ATX0edf0a25q2trZNra2uXVldX1+rq6s6nUqka4XJdxNK5c+ca5ufnL2cymc3BwcGq0dFR+ALvlAmoFRamN4XLsCscEp7/s8LLRz6ZTK7U19f/nUwml4Wn4VbUt4iv8NRuydlbKb4L9/j39WsJv+KvvTj+X+BxfFspSSUXkrtx5GYIOCysnOW2t/BQpYJ2g2eFN+A54cbrEmbAhR2E3RDEI6erwvS7gjPCLDlQ3IGnce9BO76F64p/AOYd4dsL5+wgAAAAAElFTkSuQmCC"},3682:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA4klEQVRIia2VWw7EIAhF0cx3F0bXWxfWDTgfEywq8hh7kyZ96LkIpCTQVY3vXMnzsgMiopteShG5dNPAEajDLCWC74Cvcrf7E4/OJI/wq9zdhgici5gfayNFZIFX6/L44sSjWyxFOKZkBRcNpIh42qR8a1oaSIBIbVwGZCJF6oneZQBg12HLQCuop6VVg1VBPZ1mGni6xWMiGkRakZ9GStlkEO1za+3yVxGBa3smg3/AmjLANCxeETH5RKvRmWAElgCeFE2zN3AqcRaTWg0o+tVs3VFFxAq/U9D1mtpMZs+v6gsVx3EXSmjQgwAAAABJRU5ErkJggg=="},9772:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAYAAAA5ZDbSAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAeKADAAQAAAABAAAAeAAAAAAI4lXuAAAIfUlEQVR4Ae2d208XRxTHD/eb+kMuKqigltSqkcaS1vqgL7744ot/qM8+1DTVxEsqjZdYaqAqXvACKIhcBMHuZ81sxnXmx2/hR2xOzkno7p6dnZnz/cyZmd9u09Z8SkzM1CpQqzYyCyxVwAArHwgG2AArV0B5eJbBBli5AsrDsww2wMoVUB6eZbABVq6A8vAsgw2wcgWUh2cZbICVK6A8PMtgA6xcAeXhWQYbYOUKKA/PMtgAK1dAeXiWwQZYuQLKw7MMNsDKFVAenmWwAVaugPLwLIMNsHIFlIdnGWyAlSugPDzLYAOsXAHl4VkGG2DlCigPzzLYACtXQHl4lsEGWLkCysOzDDbAyhVQHp5lsAFWroDy8CyDDbByBZSHZxlsgJUroDw8y2ADrFwB5eHVVyu+1dU1eTv7Tubez8vKykeprauV1uZm6dhZkuamxmo1Y/UUVGDTgBeXPsjooycy8eK1fFxdDTbfmUAeONgnnR3tUltTEyxjzq1RoGaj/0n/tbU1eZZAvf/gX1mNgM13ecf2bTI0eETaWlvyt+x6ixTYEGDg/nn7vkxOvy3crcaGBjk5dFxKCWyzrVdgQ4Bv338gzyZeSU0y3R7s2yulHdvS83LdXV5ekedJxrNONzc1yelfT0hTo63N5TSrxr3Ca/Dc/IJMvJxM2+5K1tSj3x+quB+7uzrk92u3ZOnDB3n89IUc/q6/4mcvXrwoZ86cka6uroqemZ2dlYmJCTly5EhF5f8Phe7evSulUkn6+yvXZb1+Fwb8z+gjYYrGujt3ZvUzXb9P4OettrZW9vfuFo4tLc3p1EwWP3z8VA7s7wlmMXBWVlbyVcnMzMxXPgRpSKb9vOEbGRlJ77W3t2e3W1tbhb+pqSm5cuVK5s+f8Pz58+czN30CwHrW19e3YUC0EYplvTbL3S8EmB3z66k3WX1Aw5YTGDf/upf58ydswg7170vd7pnVZJA8ff4q2V3vzxdPhZyfn5e2trb03uTkpHR3d2fAfL/L6qtXrwrl8paHQkbzx8Dg2ZDduXMna9vdZ8BRf7kZYXx8XBYWPg9yjsPDwzI0NJQOqHx2ugFz+vRp18SWHAsBBm7o/6O13i4amCF7PTUdBExZpinEZJpFWIQAIlO0E5lp21lIKJel586dS0V2ZTmSKaHpHjCIPzAw4BfPzl3bmcM7oT1nzBIMUvrv6hobG8uy2w0YV36rjoUAv5t7/0U/AF5fV/fV1NyaTMXO6pL7rNUhezc3H3Kn2YVAiMA0G1qTyBaymnIYGQKYkF26dClzA6gcJOoFfm9vb/bMRk+oA+gA5hzAxET9wA9Nx5QhDgYf8THTbMYKAWYn7BuA/Smbe0zFsY0X2T+/uJhVwYsRsp9B4Nvg4GA68t0aybUzMgLRWI8B5QAzCBAvbwjFIGGqZGp35fPluEZYylJvSPzQM+V8tH3jxo20iJstHDxi8PcGrh6gYvSDQUt/8fX09Gxo0BUCzM+i9ayluSkr8mF5OduQLS4tJz+tXspSso77FqoTUATHqPfFBhIZhrGZ8bOMkc70ijBuHaScA4qgoZmAMhht3rp1Kz2vBlwqcgCBSv9on8zlPLbD556bYeizW6LcjBVaitJOR/5RCHCzBy9SX+YmO3+7cjO4ZrtCTY0N6e7aXbsjAgMPYVwGuHv+EQERBAMqGU+WAp/jcjLAEIn6EMjPeL8e4PIsdZAtDJJqTI8MrgsXLmRNMUAxBi9WbsBxn6x3mU/fQr8iKFfOCgHeWdperq703tT0jDTU18tSIm5oQ+ZX0F7a4V9+cZ6fctnZAtQXxWUnDzLSEYENlW9uFmCwhDITP5nLs+yqqfPy5cupj+vQM379Rc8ZaKyzwC5SN/3y46203UKAuzs70k1V7KMCG67GxnqZfvv59yrvnvMbM79jPbviLy1cZrryjclbLwJ0I9r53dEFj3hu1+ruISTPAdGJCljKuqnv1KlTmYCck9FszoDs94XsjhnTb6x/zCQ8yy8C4PoDNVZfNfyFANfX10nfvh55OP4s2HZX8uLjx2OHs3svXk3J8N2/s2v/hLW6d8/nDYXv5zy0I2Z6QkCE8s29WCBTAcuzCOnWP8ryHHCZot36Rjn8IbEBevbsWbl+/XpaH+seA4NpO9++35fYJo6BQvs8z4CJDQK/rmqdF34XvfLxo/xxbTh93ZjvxO6uTvn5xLHMXQ7w0OBR6dkdzmCyCkEqMUTzBeM5BgMZ6ozsRnzAuQymnMt6Vy50BKhff6jMej43S6zXHuXo52bb8/tTGDAPjz97IfdGRv160nO+FO3Z1Zn53yUf/2dm57Jrd8J34ZM/Hbdvw06QLTxuCDD9GUs+8o8+elrxt2AXQ0d7SX5Jsrw+2YiZbb0CGwZM1/i4wKfDUJbmu87Oev/ePfLDwIHgT6N8ebuujgKbAkwXPiV/r15PyZPnL2X6zYzk3ztv39Yme5PNVP++3mT9s6ytDrbKa9k0YL+ptbVPspC8imQjxlcj3kmTuWbfToGqAv52YVjLMQXsX3yPKaPEb4CVgIyFYYBjyijxG2AlIGNhGOCYMkr8BlgJyFgYBjimjBK/AVYCMhaGAY4po8RvgJWAjIVhgGPKKPEbYCUgY2EY4JgySvwGWAnIWBgGOKaMEr8BVgIyFoYBjimjxG+AlYCMhWGAY8oo8RtgJSBjYRjgmDJK/AZYCchYGAY4powSvwFWAjIWhgGOKaPEb4CVgIyFYYBjyijxG2AlIGNhGOCYMkr8BlgJyFgYBjimjBK/AVYCMhaGAY4po8RvgJWAjIVhgGPKKPEbYCUgY2EY4JgySvwGWAnIWBgGOKaMEr8BVgIyFoYBjimjxG+AlYCMhWGAY8oo8RtgJSBjYRjgmDJK/AZYCchYGAY4powSvwFWAjIWxn/NFQ6ccokFSgAAAABJRU5ErkJggg=="},7931:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAADvElEQVRYhe2WX0hkZRjGf58Dzik4Q+y0OSurO9jVkotd7PZHEtuLdKJg0CBqRBaUrYUGCQdRBxwYL/Im2G4yabcWY4vBC2nFULqKJMqiRELbhjOaBBGUmdK6Wu15u/iOtbPNOXM2pat9YOAc3j/PM+/53vf94A4OBhGgFlD/N/EzwFXgBmAD3wOvAqeACj8J9qO4GliKx+P3tLW1EQqFmJ+fJ5fLsba2JsAEkAR+3geHJy7V1dXJ8vKyWJYlhUJBCoWCWJYlo6OjYpqmAJ8BAa8kvspUAjGl1JlkMkkwGESpfwqplKK1tZXx8XEMw3gIOOeVyFOdCwxgMhaLHe7t7XV1ikQibG5uqoWFhRPAG8Cfpfz+SwWypmkez2QyZR07OzsBjgJxN5/bFfAk0JfNZqmqqirrXF1dTTgcVuiq7VuAAbzV0tKi4nHXP/Q3RITBwUHW19dt4OuDEJBRSh1Jp9O+nHO5HJOTkwJkgK/2K6ARGOzv76empsbVSUQAmJiYYGhoSETkIvCKV2I/Au4FLjY3N9Pd3V1EVAqzs7Nks1kRkfPAi4C7M+UnYQB4LxQKPTszM0MkEnF1FBGmp6cZGBiQnZ2dd4Au9HguS+CFl4HepqYmKisrWVlZoba2lkAgUDR8RIS5uTn6+vpke3v7AvCCH3IoX4HPg8HgyXA4bCulAltbWyilSCQSJJNJMQxDASwuLkoikWB3d/ftW8gV8ARw2nm/CqwBH/kRB7A6PDy8szfnl5aWJJPJiGmadkNDg53P52VqakpM07SBy7fEPo7eBdvAp85vFT0RPcdzkYCRkZHrqVRK2tvbJZ1OSz6fl7GxMRuQrq6uPfIvKB42jzpEH6O35s0459ga/Aj4NhqN2hUVFdLY2CiAdHR0iGVZdn19/Q661JeBu26KMYBl4AOPvN8BZ/wIOAtILBYTy7IkkUhINBqVnp6e39Cl/ZB/t3LUEXYad6z6FXAUkHA4bKdSqRvOjrfRN6DXgHCJmLuBRfSBO17CXoG+pDznR8AJh3CP+BvgJeBImbjDwOsuAp4GrqEHnC+cBSaBHuCQ3yAPXAHePYA8tw0FXAB+Bx70EzAIvH9A5AH0UtoCHvMToNDT6lIJmwHcDzzv2JeBN3Ef66fQ63gDaPer+BjFrXQf+tRmgB8c2waQA84Dv6Kv4XtdYQCPoL/1NcfmvslK4BCwCfyC7tk/gJ+AL9GH8RjF/f+w47vu+G+gW/UK8JQXkdcyegA46TwXgE/w3u0RoMXJeR09hn/0Ir8DgL8AaYBB3tIMzbAAAAAASUVORK5CYII="},4031:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAEbElEQVRYhe2XX0jbVxTHP79sJHEVMkfMsoIMmYizukGp3QLSlxHmUOxE52CSVktAuz8Q9zAoWISJD0b3MAdzmXNjthmW4pgjsLdKkG6ToThYrJNkHc4urBlNZTYuzv3OHn5Jqmn+TSp72Rcuub/zO+ee77n3nJP7g//xH0PZh40ZaMzy7hfgykET+ESv158qLS3VJQWxWIxoNAqwCTwB3NzHugXhCHDn/PnzO6FQSEKhkASDQamrq5OamhqxWq0CfHxQzhXg64qKCgkEAinnU1NTAsiFCxdkbGxMgB3g8YMgcEpRFLl8+bIko19dXZWysjJpbGyUYDAogUBAzGbzv9oFXX4VQNv6d51OJ0ePHgVARJicnOT27dv09fUBYDQaOXPmDEA78Nj9IvAAMFxRUfGwy+VKCePxOOPj4/T09GCxWFLy5uZm9Hr9IeCt+0XAYTAYXhgZGcFoNAJa9KOjo8RiMdra2gBQFK2grFYrNpsN4Nn7QeBJYKSpqYna2tqUcGVlBY/HQ29vL2azOSUXEa5duyZ+v1+AzwohkKsPFAH+qqqquosXL1JSUgKAqqq0t7ejKAqXLl1Cp7sbg4iIy+W64/P5VoDjgOQj8GCOd28XFRXVud3ulHMRYXZ2lqWlJXw+H4qiICKp37W1NXw+30PAe4U4z0XgCHC2o6OD6upqRIR4PE44HObcuXPY7Xaqqqr2GIgI/f39AN8Bk4U4z0XgHeBQOBymoaGBra0tNjc32djYAMDhcNzjfGZmhrm5OQG6C3WejUAJ8NyJEydUg8Ggs9vtlJeXA1BZWUl3dzd+vx+bzZbK/Gg0ytDQkABfAN+nrWcErIn5TSC2+2WmKtgCtuvr63VDQ0O0trYCcPjwYWpqaujp6cHr9RKJRFLRDw4OEolEYsBru9YpBWaAG8D1xAiS/Z90D64cO3ZMXC6XAGIymURRFBkYGJCFhQXR6/XS2dkpwWBQhoeHRVEUFTibvgZaIqaPv4Gn8hF4A1BNJpN68uRJWV5elq6uLgHE5/OJw+EQo9EoHo9HLS4uVtGSLr2kr2YhIMB0PgKlaFsnbrdbQqGQTE9PCyATExMyPz+v6vX6HUAFviXzUQ7mIPBTUilbJ4wAHwKsr68jIuL1esViscji4qLa0tKibG9v64BFoClBJB0raDnQBXQCn+eLOh1PJxk7nU41cc4qcAv4FGhA65bZkH4kp8mwA7lQAtxJGKjAPFp7NRQewx68kolArlYcRcvsFwE/4AH+3KdzgGd2zcO5CLwK1AMLwAbgRNv2JIwJYslS2kTL+Kkczo8DryfmkkeX69zdKhV4Hu08K4G+BPv0rFYThE9zb17Ygd926cYBCzkQTVv4VxIlWeC4BXwFeIGfMxB9P5dzMhglDdUMz3+lydNt0p8DaB82OfEy8EcWAjeAj4CX0K7eJWg1vl4A4S/RGtweZLsRPQo40O4FMbQSnAd+zKL/CPAm0IJ2jUvid7Tj+AD4JpPhfj7N8sGaGDvAD/mU/wGTCPZygcR1iwAAAABJRU5ErkJggg=="},8030:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACeElEQVRYhe2WPWhTURSAv2sDyUtpCTwhMU4lrg0ShGwWpOpQMVAoTv3RUBUEp0Jw07oIWQUHQZ2F2qGJUAqawVZaMEUwWXovTgpWUYpoFnuPQ5oqhTR5qXld/ODB493DOd+7/3DI9HiMjwAxIAx8//c6zYkBz4AfgADbwGPA9aN4Gvi6U3jv8wpQ3RZ43aS4ABY4dZDkR9qIie3TpoDL3RZoRbjbAh/biLkIPAJOHkSmGTdoPgcE2Prrfb0bAmHg034SjuNINpuV+fn5SjcEAM4AP/cWDgaDMjk5Kaurq2KMscaYF14TB1q09wA3gRzgND7GYjGmpqbIZDL09/dTq9VqwEPgjleBVkyw87dKKRkYGJB8Pi/ValWMMWKMkfHxcQt8AEKdFGi1CsrRaHRrbGyMQqHA0tKS9Pb2SqlU2g3IZrOilDoGXOpEoCXGmAlTp6i1vhKPx5+mUinRWu/2wvT0tHCAXvDKWaWULRaLYowRrbWUy2Xp6+uzwG2vybwexwDvgQvGmPjo6ChKKUKhEEoptby8fAJ4APxqN1knW7EAd9fW1mR9/c++Mzw8DHAcONdBTs8ooDg4OLg7FzY2NiSdTgtQ8JKokyFo8G5zc/Oa67oqmUyilCISibCwsJAAnlDforvOLcdx7MrKijXGSKVSkWg0aoG8H8WhvuzeplIp2xiKXC5ngc/4tCQBksD27OysaK2lVCpZ6jelCb8EAO4ppWRubk601jI0NCTAcz8FQsCbRCIh1WpVZmZmBPiCj8MAEAe+ZTIZWVxcbFxYz/spAHAasCMjI+K6rgBX/RaA+v1hOxAIWOD+YQgAXAdeAkcPS+A/bfMbyDkQZkEBMg0AAAAASUVORK5CYII="},1183:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAATUlEQVQ4jWNgoBAw4hD/T6x6bAbg0oxVD7oB/0mVYyLGFjxiOA0gGlBsAAuJ6jG8QbELkE0kFH1Y9dI8EHGlVKINoNgFFBtAMGApdgEA7jIGIGzoTUQAAAAASUVORK5CYII="},6381:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAU1JREFUSEu9lk0SgyAMhWF04aHanssjeK72UG4c6RANDSH8inXjiJAvLz6IWt1zmTOs5uGDgQY+BpeWXgYGwY2ReVo7lgfNKSwGUHkEZoeLgA4UU4AAFtxx7TpJZbFCCuaQVFLnXLm+CcN4pc2pjpQXoDmFPAdTA2NlbwLaGNVQWtZahZh0FbQrcBgGte+7GsdRbdvmPsE0TWpdV3juAXSl/TuQKAhMjgbrpbDIQHzzt5qmyDwtJ02ueSTdyk+Zlo1PE4DTJ9MtLrenAEhq697FWtMVhaBuWRaAzPMMd8mV/Ju0mMZYEEI4lADE2HxQat90DsDwSkCjQrxgRj2Oo+j9OWK+gjbmlZKWk6hOVi0NtBGfGpsYzo1CT+UdgL69bEDRNCX91VMITlOPX0lRIbXascJBcybJuTT1j4lrgyRLlEmLeTK3PLfsw0uJfAF8q5UdxHjKFQAAAA5lWElmTU0AKgAAAAgAAAAAAAAA0lOTAAAAAElFTkSuQmCC"},1493:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAANZJREFUSEvNlsEVxCAIRKU9K7IEK7I998Gqi2K8hPGtt1z8zDhAKFw+dJkX/gZYUcp3CgUWY3RnllK2llYULIRAq0IojC3TQIiVbGM7wupACIwBDTiEDSDy3XT6GAhrAW3l5Kt7/g8XniYNQrlpi16bwHLObuJTShLSx0kDgD0DPWFM6erWxufvioRtJ80toHtIlJVT8MakQSirde4sIppnqVsPtIs0kGHHtlire1NMh21TKlFdrHgD+8r6bSazgJEw0xZomFnAnsBmo3k29D40s/r6j/AHMk9TGfZf1gYAAAAOZVhJZk1NACoAAAAIAAAAAAAAANJTkwAAAABJRU5ErkJggg=="},1190:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAATdJREFUSEu9lk0SwiAMhcuR3OuMB/F4HsQZ3XskHCihIeQHotJdC7yPF0jSsC1+wmLeZgGjY0OqpjRYQTHOMUOokqw2/ZjVJcjpda2G3+eHal4CY+AwDEgWNM0r4M62CksLsTsJGO77SLy15jEUyLGGMVza2fGZ3ymQugMYLMZQHN4EbN0JQOu2UiB1Ci4zsLkkGFjcWbB8ViWceC7nUgZOwACCofQc4QL1IR2x45yTwtpfGqcYu6za2Uf/C+wynAC1CuMybQALb65u6rUNjRZZHNKar5LIbBFv+pACVHiHe1Q5xELPCXEOTWBahN3Sd0kANqk1y+ZAAfIl8OiWzM7aklcmeIC0eIthlFJl5gxpIzb/aaZvJ9o+1/UtoDs/R34xtDz2VoTO0IhDV2UT0+OnagNiyx1+AJdvkRMD1zotAAAADmVYSWZNTQAqAAAACAAAAAAAAADSU5MAAAAASUVORK5CYII="},8137:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAVRJREFUSEvdlEGOgzAMRR1gw2yAPYvhKNycm8AJQGKBhAR45KiJUpLgELWVOllVJM2zv3++gA8v8WEefCUQHyoFFR906EJ2REQQQl/D3sce4GBqPxQaC5QyVlUF4zjqmkKgMUAJS5IEjuOAsixhmqZg6F2gnBkt6ibLMti2DfI8h2VZgqB3gBpmzo3AVITZ6ZW0oUAL5oJSx+u6QpqmpteeGCFAL8zhUPWpefzoz2+UA7IwRSiKAuZ51jUg4q8Q4hYwGKZM5EgcK4V8Hb4FJgtzJMnbYC6gkkBanVse+1+G+blDeZjsXdc19L2auY2OgTk7pM4oI5Xj9n23aLEwL5A2mqaBYRgkzJT3IkVIHe6ZWQeeDNO2LXRd5xole7Fv/tYMEZFS+EdHhtGp451xvrLHcfoiTWNIiMLQMEQyrgKnSz1/ipbRm+Rcda/Yf0nVdwr5/8A/pWmGHVYGxLkAAAAOZVhJZk1NACoAAAAIAAAAAAAAANJTkwAAAABJRU5ErkJggg=="},6088:t=>{t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAANdJREFUSEvtlNENwyAMRMliDMBEjMBEDMBiqUyL5LgYjoiQfCRfKDr5+c6GzSz+tsU88wIp8X0w9mZqSKR7CAFieu9JNwf4K6aCqakrgFr3OYUZwNH5lQTUWFt5w7OTObecNiOCNkURadAa8LQzxKkEToMVuHTKgWcXBE0+s+4Foi8KaqkW68HhI4D8SdMa6mn44jQdlkLOORNjzAnR2Vqbzymlw/+ikY3BQD4rXlzOkDdRmy8MvMVhbz7kqKeBHY6uv6Z/DnCWI6XO/9O2/OKvdngx71v+A7ETgR2iyLtGAAAADmVYSWZNTQAqAAAACAAAAAAAAADSU5MAAAAASUVORK5CYII="}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var s=e[i]={id:i,exports:{}};return t[i](s,s.exports,n),s.exports}n.m=t,n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.b=document.baseURI||self.location.href,n.nc=void 0;var i={};return(()=>{var t,e;n.d(i,{default:()=>Ee});class a{axpObj;windowSystems=[];windowElements=[];taskObjects=[];zIndex_max=1e3;constructor(t){this.axpObj=t}add(t){this.windowSystems.push(t);let e=t.windowElement;this.windowElements.push(e),this.zIndex_max++,e.style.zIndex=this.zIndex_max;e.addEventListener("pointerenter",(t=>{this.enter(t)})),e.addEventListener("pointerleave",(t=>{this.leave(t)})),e.addEventListener("pointerup",(t=>{this.up(t)})),e.addEventListener("pointerdown",(e=>{this.down(e,t)})),e.addEventListener("animationend",(t=>{this.animeend(t)}));let n=t.taskIconElement;n.addEventListener("pointerenter",(e=>{this.enter_icon(e,t)})),n.addEventListener("pointerdown",(e=>{this.down_icon(e,t)})),n.addEventListener("pointerenter",(t=>{this.enter(t)})),n.addEventListener("pointerleave",(t=>{this.leave(t)})),n.addEventListener("animationend",(t=>{this.animeend(t)}))}enter_icon(t,e){this.axpObj.msg(`${e.name}を元の位置に戻します。`)}down_icon(t,e){t.stopPropagation(),this.updateZIndex(e.windowElement),e.taskIconElement.style.display="none",e.windowElement.style.display="";let n=e.taskIconElement.style.left,i=e.taskIconElement.style.top,a=document.getElementById("config_minimize_duration").value;0===a||isNaN(a)||(e.windowElement.style.setProperty("--tool-left",n),e.windowElement.style.setProperty("--tool-top",i),e.windowElement.style.setProperty("--tool-duration",a+"ms"),e.windowElement.classList.add("icon_close"));let s=this.taskObjects.indexOf(e);this.taskObjects.splice(s,1),this.updateIconPosition()}updateIconPosition(){this.taskObjects.forEach(((t,e)=>{this.setup_iconPositon(t.taskIconElement,e)}))}setup_iconPositon(t,e){let n,i;"horizontal"===document.getElementById("config_minimize_type").elements.config_minimize_type.value?(n=8+32*e,i=40):(n=8,i=40+32*e),t.style.left=n+"px",t.style.top=`calc(100% - ${i}px)`}disp(){for(const t of this.windowElements);}enter(t){this.axpObj.isDrawing?t.currentTarget.style.opacity="0.25":this.axpObj.ELEMENT.cursor.style.visibility="hidden"}leave(t){t.currentTarget.style.opacity="1"}up(t){t.currentTarget.style.opacity="1"}animeend(t){t.currentTarget.classList.remove("icon_close")}updateZIndex(t){if(t.style.zIndex===this.zIndex_max);else{let e=t.style.zIndex;for(const n of this.windowElements)n===t?n.style.zIndex=this.zIndex_max:n.style.zIndex>e&&n.style.zIndex--}}down(n,i){if(this.axpObj.isDrawing)return;n.stopPropagation();let a=n.currentTarget;if(this.updateZIndex(a),n.target.classList.contains("minimize")){let t=n.currentTarget.offsetLeft,e=n.currentTarget.offsetTop,a=document.getElementById("config_minimize_duration").value;return 0===a||isNaN(a)||(i.taskIconElement.style.setProperty("--tool-left",t+"px"),i.taskIconElement.style.setProperty("--tool-top",e+"px"),i.taskIconElement.style.setProperty("--tool-duration",a+"ms"),i.taskIconElement.classList.add("icon_close")),i.windowElement.style.display="none",i.taskIconElement.style.display="",this.taskObjects.push(i),void this.setup_iconPositon(i.taskIconElement,this.taskObjects.length-1)}if(!n.target.classList.contains("DRAG"))return;t=n.pageX-a.offsetLeft,e=n.pageY-a.offsetTop;const s=new AbortController,r=(n,a)=>{var s=n-t,r=a-e,o=this.axpObj.ELEMENT.base.getBoundingClientRect(),l=o.width-i.windowElement.clientWidth,d=o.height-30;return s<0&&(s=0),r<0&&(r=0),s>=l&&(s=l),r>=d&&(r=d),{x:s,y:r}};window.addEventListener("pointermove",(t=>{let e=r(t.pageX,t.pageY);i.setPosition(e.x,e.y)}),{signal:s.signal}),window.addEventListener("pointerup",(t=>{let e=r(t.pageX,t.pageY);i.setPosition(e.x,e.y);let n=i.windowElement.id+","+e.x+","+e.y;this.axpObj.configSystem.saveConfig("window_potison_"+i.windowElement.id,n),s.abort()}),{signal:s.signal})}setInitPosition(t,e,n){let i=!1;for(let a=0;a<this.windowSystems.length;a++)this.windowSystems[a].id===t&&(this.windowSystems[a].init_left=e,this.windowSystems[a].init_top=n,i=!0);return i}initPosition(){for(let t of this.windowSystems)if(t.initPosition(),"init"===this.axpObj.config("config_init_windowposition")){let e="window_potison_"+t.windowElement.id;this.axpObj.configSystem.deleteConfig(e)}}resetPosition(){for(let t of this.windowSystems){t.resetPosition();let e="window_potison_"+t.windowElement.id;this.axpObj.configSystem.deleteConfig(e)}}changeAutoAdjustPosition(){for(let t of this.windowSystems)t.setPosition()}}class s{axpObj;windowElement=null;taskIconElement=null;name;id;constructor(t){this.axpObj=t}init_left=null;init_top=null;window_width=0;window_height=0;window_left=0;window_top=0;createHTML(t,e,n,i){this.id=t;let a=document.createElement("div");a.setAttribute("id",t),a.setAttribute("class","tool_window");let s=document.createElement("div");s.setAttribute("class","DRAG tool_header");let r=document.createElement("span");r.setAttribute("class",n);let o=document.createElement("div");o.textContent=e;let l=document.createElement("div");l.setAttribute("class","MSG minimize"),l.textContent="▼",l.dataset.msg="ツールウィンドウを最小化します。";let d=document.createElement("div");d.setAttribute("class","MSG DRAG drag_zone"),d.dataset.msg="ドラッグでツールウィンドウの位置を移動します。",s.appendChild(r),s.appendChild(o),s.appendChild(l),s.appendChild(d),a.appendChild(s),this.axpObj.ELEMENT.base.appendChild(a),a.insertAdjacentHTML("beforeend",i),this.windowElement=document.getElementById(t),this.name=e;let c=document.createElement("div");c.setAttribute("class","task_icon_horizontal"),c.setAttribute("style","display:none"),c.dataset.tip=e,c.classList.add(n),this.axpObj.ELEMENT.base.appendChild(c),this.taskIconElement=c}initPosition(){let t,e,n=this.getDefaultPosition();t=n.left,e=n.top,"init"!==this.axpObj.config("config_init_windowposition")&&null!==this.init_left&&(t=this.init_left,e=this.init_top),this.setPosition(t,e)}setPosition(t,e){let n=void 0===t?this.window_left:t,i=void 0===e?this.window_top:e;"on"===this.axpObj.config("config_resize_type")?(this.windowElement.style.left=`min(100% - ${this.window_width}px, ${n}px)`,this.windowElement.style.top=`min(100% - 30px, ${i}px)`):(this.windowElement.style.left=`${n}px`,this.windowElement.style.top=`${i}px`),this.window_left=n,this.window_top=i}resetPosition(){let t=this.getDefaultPosition();this.setPosition(t.left,t.top)}}function r(t){return"#"==t.slice(0,1)&&(t=t.slice(1)),3==t.length&&(t=t.slice(0,1)+t.slice(0,1)+t.slice(1,2)+t.slice(1,2)+t.slice(2,3)+t.slice(2,3)),[t.slice(0,2),t.slice(2,4),t.slice(4,6)].map((function(t){return parseInt(t,16)}))}function o(t){return t.map((function(t){return("0"+t.toString(16)).slice(-2)})).join("")}function l(t){for(var e,n,i=0;i<t.height;i++)for(var a=0;a<t.width/2;a++){e=4*(i*t.width+a),n=4*(i*t.width+t.width-a-1);var s=t.data[e+0],r=t.data[e+1],o=t.data[e+2],l=t.data[e+3];t.data[e+0]=t.data[n+0],t.data[e+1]=t.data[n+1],t.data[e+2]=t.data[n+2],t.data[e+3]=t.data[n+3],t.data[n+0]=s,t.data[n+1]=r,t.data[n+2]=o,t.data[n+3]=l}}function d(t){for(var e,n,i=0;i<t.height/2;i++)for(var a=0;a<t.width;a++){e=4*(i*t.width+a),n=4*((t.height-i-1)*t.width+a);var s=t.data[e+0],r=t.data[e+1],o=t.data[e+2],l=t.data[e+3];t.data[e+0]=t.data[n+0],t.data[e+1]=t.data[n+1],t.data[e+2]=t.data[n+2],t.data[e+3]=t.data[n+3],t.data[n+0]=s,t.data[n+1]=r,t.data[n+2]=o,t.data[n+3]=l}}function c(t,e,n){return(t-e)*(t-n)<=0}const h="メッセージ";function p(){document.getElementsByTagName("body")[0].removeChild(document.getElementById("modalContainer"))}function u(t){return new Promise((function(e,n){!function(t,e,n){if(document.getElementById("modalContainer"))return;let i=document.getElementsByTagName("body")[0].appendChild(document.createElement("div"));i.id="modalContainer",i.style.height=document.documentElement.scrollHeight+"px";let a=i.appendChild(document.createElement("div"));a.id="alertBox",document.all&&!window.opera&&(a.style.top=document.documentElement.scrollTop+"px"),a.style.left=(document.documentElement.scrollWidth-a.offsetWidth)/2+"px",a.style.visiblity="visible",a.appendChild(document.createElement("h1")).appendChild(document.createTextNode(h)),a.appendChild(document.createElement("p")).innerText=t;let s=a.appendChild(document.createElement("div"));s.style.display="flex";let r=s.appendChild(document.createElement("button"));r.id="closeBtn",r.appendChild(document.createTextNode("Ok")),r.focus(),r.onclick=function(){p(),e()};let o=s.appendChild(document.createElement("button"));o.id="cancelBtn",o.appendChild(document.createTextNode("キャンセル")),o.onclick=function(){p(),n()},a.style.display="block"}(t,e,n)}))}function g(t,e){return e=(e=(e=(e=(e=(e=e.replace(/YYYY/,t.getFullYear())).replace(/MM/,("0"+(t.getMonth()+1)).slice(-2))).replace(/DD/,("0"+t.getDate()).slice(-2))).replace(/hh/,("0"+t.getHours()).slice(-2))).replace(/mm/,("0"+t.getMinutes()).slice(-2))).replace(/ss/,("0"+t.getSeconds()).slice(-2))}function m(t){return"#"==t.slice(0,1)&&(t=t.slice(1)),null!==t.match(/^([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)}function b(t){var e=t;return isNaN(e)&&(e=0),e=Math.min(255,e),e=Math.max(0,e)}const x=[0,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,40,45,50,55,60,65,70,75,80,85,90,95,100,110,120,130,140,150,160,170,180,190,200],y=function(t){for(var e=0,n=0;n<x.length;n++){if(x[n]===t){e=n;break}if(x[n]>t)break;e=n}return e};class _{constructor(){this.base_x=0,this.base_y=0,this.base_index=0,this.old_x=0,this.old_y=0,this.end_x=0,this.end_y=0,this.init_size=this.size,this.init_index=this.index,this.init_alpha=this.alpha,this.init_brightness=this.brightness,this.drawmode=null,this.isFirstDrawing=!1,this.isLastDrawing=!1,this.input_position=[],this.gradation=null}init(){this.size=this.init_size,this.index=this.init_index,this.alpha=this.init_alpha,this.brightness=this.init_brightness}blur(t){var e;this.CANVAS.draw_ctx.shadowColor=this.adjust_color(this.axpObj.colorMakerSystem.getMainColor()),(e=Number(void 0===t?config_pen_blur.elements.config_pen_blur.value:t))>0&&1!==this.CANVAS.draw_ctx.globalAlpha&&(this.CANVAS.draw_ctx.globalAlpha=this.CANVAS.draw_ctx.globalAlpha/Math.sqrt(2)),this.CANVAS.draw_ctx.shadowBlur=e,this.CANVAS.draw_ctx.shadowOffsetX=0,this.CANVAS.draw_ctx.shadowOffsetY=0}drawCursor(t){if(this.usePenLock&&this.axpObj.layerSystem.isWriteProtection())return this.axpObj.ELEMENT.view.style.cursor="not-allowed",void(this.axpObj.ELEMENT.cursor.style.visibility="hidden");this.axpObj.ELEMENT.view.style.cursor=this.cursor,this.usePenGuide?(this.axpObj.ELEMENT.cursor.style.visibility="visible",this.axpObj.ELEMENT.cursor.style.borderRadius=this.borderRadius,"normal"===this.borderStyle?"true"===document.getElementById("color_transparent").dataset.selected?this.axpObj.ELEMENT.cursor.style.borderStyle="dashed":this.axpObj.ELEMENT.cursor.style.borderStyle="solid":this.axpObj.ELEMENT.cursor.style.borderStyle=this.borderStyle,this.drawPenGuide(t)):this.axpObj.ELEMENT.cursor.style.visibility="hidden"}drawPenGuide(t){let e=parseInt(this.size*this.axpObj.scale/100);this.axpObj.ELEMENT.cursor.style.width=e+"px",this.axpObj.ELEMENT.cursor.style.height=e+"px";let n=this.axpObj.ELEMENT.view.getBoundingClientRect(),i=parseInt(t.clientX-n.left-e/2),a=parseInt(t.clientY-n.top-e/2);this.axpObj.ELEMENT.cursor.style.left=i+"px",this.axpObj.ELEMENT.cursor.style.top=a+"px"}set_modeflag(){switch(this.drawmode=this.axpObj.CONST.DRAW_FREEHAND,this.axpObj.isSHIFT&&(this.axpObj.isLine=!0),document.getElementById("select_pen_mode").value){case"option_line":this.axpObj.isLine=!0;break;case"option_rectangle":this.axpObj.isRect=!0,this.drawmode=this.axpObj.CONST.DRAW_RECT;break;case"option_circle":this.drawmode=this.axpObj.CONST.DRAW_CIRCLE;break;case"option_symmetry":this.drawmode=this.axpObj.CONST.DRAW_SYMMETRY}this.axpObj.isDrawing=!0,this.isFirstDrawing=!0,this.isLastDrawing=!1}reset_modeflag(){this.axpObj.isDrawing=!1,this.axpObj.isLine=!1,this.axpObj.isRect=!1,this.axpObj.isCircle=!1}init_globalCompositeOperation(){let t;t="true"===document.getElementById("color_transparent").dataset.selected?"destination-out":this.axpObj.layerSystem.getMasked()?"source-atop":"source-over",this.axpObj.penSystem.CANVAS.draw_ctx.globalCompositeOperation=t}start(t,e){}move(t,e){}end(t,e){}init_brush(){}draw(){}end_common(){this.axpObj.isDrawing&&this.reset_modeflag()}draw_symmetry(){switch(this.drawmode){case DRAW_SYMMETRY:this.draw(1),this.draw(2),this.draw(3);break;case DRAW_SYMMETRY_H:this.draw(1);break;case DRAW_SYMMETRY_V:this.draw(3)}}trans_x(t,e){const n=t=>{let e=x_size/2;return e-(t-e)};switch(e){case 0:case 3:return t;case 1:case 2:return n(t)}}trans_y(t,e){const n=t=>{let e=y_size/2;return e-(t-e)};switch(e){case 0:case 1:return t;case 2:case 3:return n(t)}}adjust_color(t){let e,n,i,a=r(t);return this.brightness>0?(e=Math.floor((255-a[0])*this.brightness/100),n=Math.floor((255-a[1])*this.brightness/100),i=Math.floor((255-a[2])*this.brightness/100)):(e=Math.floor(a[0]*this.brightness/100),n=Math.floor(a[1]*this.brightness/100),i=Math.floor(a[2]*this.brightness/100)),"#"+o([a[0]+e,a[1]+n,a[2]+i])}previewPenSize(){let t=this.axpObj.penSystem.CANVAS.pensize,e=this.axpObj.penSystem.CANVAS.pensize_ctx;e.clearRect(0,0,t.width,t.height);let n,i=this.axpObj.penSystem.CANVAS.spuit;if(this.axpObj.penSystem.CANVAS.spuit_ctx.clearRect(0,0,i.width,i.height),this.usePenPreview){if(n="normal"!==this.borderStyle||"true"===document.getElementById("color_transparent").dataset.selected,e.globalCompositeOperation="source-over",e.globalAlpha=this.alpha/100,e.lineCap=this.lineCap,e.lineJoin=this.lineJoin,e.beginPath(),n){let t;e.strokeStyle="#000000",e.lineWidth=1,t=null!==this.size?this.size*(this.axpObj.scale/100)/2:40,e.setLineDash([3,3]),"square"===this.lineCap?e.strokeRect(49.5-t,49.5-t,2*t,2*t):(e.arc(49.5,49.5,t,0,2*Math.PI,!0),e.stroke()),e.setLineDash([])}else{let t;e.strokeStyle=this.adjust_color(this.axpObj.colorMakerSystem.getMainColor()),e.fillStyle=this.adjust_color(this.axpObj.colorMakerSystem.getMainColor()),t=null!==this.size?this.size*(this.axpObj.scale/100):80,"square"===this.lineCap?e.fillRect(49.5-t/2,49.5-t/2,t,t):(e.arc(49.5,49.5,t/2,0,2*Math.PI,!0),e.fill())}null!==this.size&&this.draw_pensize_grid(e)}}draw_pensize_grid(t){t.globalAlpha=1,t.lineWidth=1,t.strokeStyle="#333",t.lineCap="round",t.lineJoin="round",t.beginPath(),t.moveTo(49.5,0),t.lineTo(49.5,99),t.stroke(),t.beginPath(),t.moveTo(0,49.5),t.lineTo(99,49.5),t.stroke()}}class A extends _{constructor(t){super(),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="丸ペン",this.type="draw",this.size=1,this.index=this.size?y(this.size):null,this.alpha=100,this.threshold=null,this.brightness=0,this.cursor="auto",this.usePenGuide=!0,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="50%",this.borderStyle="normal",this.lineCap="round",this.lineJoin="round",this.canUndo=!0}init_brush(){this.init_globalCompositeOperation(),this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.lineWidth=this.size-.25,this.CANVAS.brush_ctx.strokeStyle=this.adjust_color(this.axpObj.colorMakerSystem.getMainColor()),this.CANVAS.brush_ctx.lineCap=this.lineCap,this.CANVAS.brush_ctx.lineJoin=this.lineJoin,this.blur()}start(t,e,n){this.axpObj.layerSystem.isWriteProtection()||(this.set_modeflag(),this.input_position=[],this.input_position.push({x:t,y:e}),this.input_position.push({x:t,y:e}),this.input_position.push({x:t,y:e}),this.axpObj.layerSystem.save(),this.init_brush(),this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.brush_ctx.beginPath(),this.draw(),this.CANVAS.brush_ctx.stroke(),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas(),this.isFirstDrawing=!1)}draw(t=0){let e=this.CANVAS.brush_ctx;switch(this.drawmode){case this.axpObj.CONST.DRAW_FREEHAND:case this.axpObj.CONST.DRAW_SYMMETRY:let i=!1;if(this.isFirstDrawing||"true"===document.getElementById("config_stabilizer_use").elements.config_stabilizer_use.value&&(this.axpObj.isLine||(i=!0)),i){this.input_position.at(-3).x,this.input_position.at(-2).x,this.input_position.at(-3).y,this.input_position.at(-2).y;if(this.isLastDrawing){let n=this.input_position.at(-1).x,i=this.input_position.at(-1).y;e.lineTo(this.trans_x(n,t),this.trans_y(i,t))}else{let n=this.input_position.at(-2).x,i=this.input_position.at(-2).y,a=(this.input_position.at(-2).x+this.input_position.at(-1).x)/2,s=(this.input_position.at(-2).y+this.input_position.at(-1).y)/2;e.quadraticCurveTo(this.trans_x(n,t),this.trans_y(i,t),this.trans_x(a,t),this.trans_y(s,t))}}else{let n,i;this.axpObj.isLine?(n=this.input_position.at(0).x,i=this.input_position.at(0).y,e.moveTo(this.trans_x(n,t),this.trans_y(i,t))):(n=this.input_position.at(-2).x,i=this.input_position.at(-2).y);let a=this.input_position.at(-1).x,s=this.input_position.at(-1).y;e.lineTo(this.trans_x(a,t),this.trans_y(s,t))}break;case this.axpObj.CONST.DRAW_RECT:let a=this.input_position.at(0).x,s=this.input_position.at(0).y,r=this.input_position.at(-1).x-a,o=this.input_position.at(-1).y-s;e.strokeRect(a,s,r,o);break;case this.axpObj.CONST.DRAW_CIRCLE:var n=parseInt(Math.sqrt(Math.pow(this.input_position.at(-1).x-this.input_position.at(0).x,2)+Math.pow(this.input_position.at(-1).y-this.input_position.at(0).y,2)));e.beginPath(),e.arc(this.input_position.at(0).x,this.input_position.at(0).y,n,0,2*Math.PI,!0)}}move(t,e,n){if(this.axpObj.isDrawing){if("true"===document.getElementById("config_stabilizer_use").elements.config_stabilizer_use.value){if(parseInt(Math.sqrt(Math.pow(t-this.input_position.at(-1).x,2)+Math.pow(e-this.input_position.at(-1).y,2)))<document.getElementById("config_stabilizer").value)return}this.input_position.push({x:t,y:e}),this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.axpObj.isLine&&this.CANVAS.brush_ctx.beginPath(),this.draw(),this.CANVAS.brush_ctx.stroke(),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}}end(t,e,n){this.axpObj.isDrawing&&(this.isLastDrawing=!0,this.input_position.push({x:t,y:e}),this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.axpObj.isLine&&this.CANVAS.brush_ctx.beginPath(),this.draw(),this.CANVAS.brush_ctx.stroke(),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()),this.end_common()}}class f extends A{constructor(t){super(t),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="消しゴム",this.type="eraser",this.size=5,this.index=this.size?y(this.size):null,this.alpha=100,this.threshold=null,this.brightness=null,this.cursor="auto",this.usePenGuide=!0,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="50%",this.borderStyle="dashed",this.canUndo=!0,this.lineCap="round",this.lineJoin="round"}init_brush(){this.CANVAS.draw_ctx.globalCompositeOperation="destination-out",this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.lineWidth=this.size,this.CANVAS.brush_ctx.strokeStyle=this.adjust_color(this.axpObj.colorMakerSystem.getMainColor()),this.CANVAS.brush_ctx.lineCap=this.lineCap,this.CANVAS.brush_ctx.lineJoin=this.lineJoin}}class v extends A{img_draw;constructor(t){super(t),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="角消しゴム",this.type="eraser",this.size=5,this.index=this.size?y(this.size):null,this.alpha=100,this.threshold=null,this.brightness=null,this.cursor="auto",this.usePenGuide=!0,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="0px",this.borderStyle="dashed",this.canUndo=!0,this.lineCap="square",this.lineJoin="bevel"}init_brush(){this.CANVAS.draw_ctx.globalCompositeOperation="destination-out",this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1}start(t,e){this.axpObj.layerSystem.isWriteProtection()||(this.set_modeflag(),this.input_position=[],this.input_position.push({x:t,y:e}),this.input_position.push({x:t,y:e}),this.input_position.push({x:t,y:e}),this.axpObj.layerSystem.save(),this.isFirstDrawing=!0,this.isLastDrawing=!1,this.init_brush(),this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.img_draw=new ImageData(this.axpObj.x_size,this.axpObj.y_size),this.draw(),this.CANVAS.brush_ctx.putImageData(this.img_draw,0,0),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas(),this.isFirstDrawing=!1)}move(t,e){this.axpObj.isDrawing&&(this.input_position.push({x:t,y:e}),this.clear_brush(),this.draw(),this.CANVAS.brush_ctx.putImageData(this.img_draw,0,0),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas())}clear_brush(){let t=!1;switch(this.axpObj.isLine&&(t=!0),this.drawmode){case this.axpObj.CONST.DRAW_RECT:case this.axpObj.CONST.DRAW_CIRCLE:t=!0}t&&(this.img_draw=new ImageData(this.axpObj.x_size,this.axpObj.y_size))}end(t,e){this.end_common()}trans_dot(t){return Math.trunc(t/this.size)*this.size+this.size/2}draw(t=0){let e,n,i,a,s=r(this.axpObj.colorMakerSystem.getMainColor());switch(this.drawmode){case this.axpObj.CONST.DRAW_FREEHAND:this.axpObj.isLine?(e=this.input_position.at(0).x,n=this.input_position.at(0).y):(e=this.input_position.at(-2).x,n=this.input_position.at(-2).y),i=this.input_position.at(-1).x,a=this.input_position.at(-1).y,this.drawLine(this.img_draw,this.trans_x(e,t),this.trans_y(n,t),this.trans_x(i,t),this.trans_y(a,t),this.size,s);break;case this.axpObj.CONST.DRAW_RECT:e=this.input_position.at(0).x,n=this.input_position.at(0).y,i=this.input_position.at(-1).x,a=this.input_position.at(-1).y,this.drawLine(this.img_draw,e,n,e,a,this.size,s),this.drawLine(this.img_draw,e,a,i,a,this.size,s),this.drawLine(this.img_draw,e,n,i,n,this.size,s),this.drawLine(this.img_draw,i,n,i,a,this.size,s);break;case this.axpObj.CONST.DRAW_CIRCLE:e=this.input_position.at(0).x,n=this.input_position.at(0).y,i=this.input_position.at(-1).x,a=this.input_position.at(-1).y,this.drawCircle(this.img_draw,e,n,i,a,this.size,s)}}drawLine(t,e,n,i,a,s,r){const{width:o,height:l,data:d}=t,c=Math.abs(i-e),h=Math.abs(a-n),p=e<i?1:-1,u=n<a?1:-1;let g=c-h,m=e,b=n,x=-1,y=-1;for(;;){let t=Math.round(m-s/2),e=Math.round(b-s/2);if(t!==x||e!==y){let n=t+s-1,i=e+s-1;for(let a=t;a<=n;a++)for(let t=e;t<=i;t++)if(a>=0&&a<this.axpObj.x_size&&t>=0&&t<this.axpObj.y_size){const e=4*(a+t*o);d[e+0]=r[0],d[e+1]=r[1],d[e+2]=r[2],d[e+3]=255}x=t,y=e}if(m===i&&b===a)break;let n=2*g;n>-h&&(g-=h,m+=p),n<c&&(g+=c,b+=u)}}drawCircle(t,e,n,i,a,s,r){const{width:o,height:l,data:d}=t,c=parseInt(Math.sqrt(Math.pow(i-e,2)+Math.pow(a-n,2)));if(c<=0)return;var h=parseInt(128*c),p=0,u=0,g=0;const m=(t,e)=>{let n=Math.floor(t/s)*s,i=Math.floor(e/s)*s,a=n+s-1,l=i+s-1;for(let t=n;t<=a;t++)for(let e=i;e<=l;e++)if(t>=0&&t<this.axpObj.x_size&&e>=0&&e<this.axpObj.y_size){const n=4*(t+e*o);d[n+0]=r[0],d[n+1]=r[1],d[n+2]=r[2],d[n+3]=255}};for(;p<=h;)m(e+(u=parseInt(h/128)),n+(g=parseInt(p/128))),m(e-u,n-g),m(e-u,n+g),m(e+u,n-g),m(e+g,n+u),m(e-g,n-u),m(e-g,n+u),m(e+g,n-u),p+=parseInt(h/128),h-=parseInt(p/128)}}class S extends _{constructor(t){super(),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="バケツ",this.type="fill",this.size=null,this.index=null,this.alpha=100,this.threshold=2,this.brightness=null,this.cursor="auto",this.usePenGuide=!1,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="",this.borderStyle="normal",this.canUndo=!0,this.lineCap="square",this.lineJoin="bevel"}init_brush(){this.init_globalCompositeOperation(),this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.lineWidth=this.size,this.CANVAS.brush_ctx.strokeStyle=this.adjust_color(this.axpObj.colorMakerSystem.getMainColor()),this.CANVAS.brush_ctx.lineCap="round",this.CANVAS.brush_ctx.lineJoin="round"}start(t,e){if(!this.axpObj.layerSystem.isWriteProtection()&&c(t,0,this.axpObj.x_size)&&c(e,0,this.axpObj.y_size)){this.axpObj.layerSystem.save(),this.init_brush();var n,i=r(this.axpObj.colorMakerSystem.getMainColor()),a=[i[0],i[1],i[2]];n="option_layer"===document.getElementById("select_fill").value?this.axpObj.layerSystem.getImage():this.axpObj.layerSystem.getCanvasImage();var s=new ImageData(this.axpObj.x_size,this.axpObj.y_size);this.regionFill(n,s,t,e,a),this.CANVAS.brush_ctx.putImageData(s,0,0),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}}move(t,e){}end(){}}S.prototype.regionFill=function(t,e,n,i,a){let s=Number(document.getElementById("range_fill_threshold").value);var r=a;if(n<0||i<0||n>=t.width||i>=t.height)return;var o=new Array(3);o[0]=t.data[4*(i*t.width+n)+0],o[1]=t.data[4*(i*t.width+n)+1],o[2]=t.data[4*(i*t.width+n)+2];var l,d,c=t.data[4*(i*t.width+n)+3],h=!Boolean(c),p=[{x:n,y:i}],u=[];const g=(t,e,n,i,a,s)=>{if(s[n*t.width+e])return!1;if(e<0||n<0||e>=t.width||n>=t.height)return!1;var r=new Array(3);r[0]=t.data[4*(n*t.width+e)+0],r[1]=t.data[4*(n*t.width+e)+1],r[2]=t.data[4*(n*t.width+e)+2];var o=t.data[4*(n*t.width+e)+3];return a?0===o:0!==o&&(r[0]===i[0]&&r[1]===i[1]&&r[2]===i[2])},m=(e,n,i,a,s,r)=>{if(!0===s[i*e.width+n])return;if(n<0||i<0||n>=e.width||i>=e.height)return;let o=4*(i*t.width+n),l=255-50*(r-1);e.data[o+0]=a[0],e.data[o+1]=a[1],e.data[o+2]=a[2],e.data[o+3]<l&&(e.data[o+3]=l)};for(var b=0;p.length;){if(!0===u[(d=p.pop()).y*t.width+d.x]);else if(g(t,d.x,d.y,o,h,u)){if(u[d.y*t.width+d.x]=!0,l=4*(d.y*t.width+d.x),e.data[l+0]=r[0],e.data[l+1]=r[1],e.data[l+2]=r[2],e.data[l+3]=255,g(t,d.x,d.y-1,o,h,u))p.push({x:d.x,y:d.y-1});else for(let t=1;t<s+1;t++)m(e,d.x,d.y-t,r,u,t);if(g(t,d.x+1,d.y,o,h,u))p.push({x:d.x+1,y:d.y});else for(let t=1;t<s+1;t++)m(e,d.x+t,d.y,r,u,t);if(g(t,d.x,d.y+1,o,h,u))p.push({x:d.x,y:d.y+1});else for(let t=1;t<s+1;t++)m(e,d.x,d.y+t,r,u,t);if(g(t,d.x-1,d.y,o,h,u))p.push({x:d.x-1,y:d.y});else for(let t=1;t<s+1;t++)m(e,d.x-t,d.y,r,u,t)}if(++b>3e6){AXP.FUNCTION.msg("ERROR:塗り潰し中に異常が発生したため、処理を中断しました。"),alert("ERROR:塗り潰し中に異常が発生したため、処理を中断しました。");break}}};class O extends S{constructor(t){super(t),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="階調バケツ",this.type="fill",this.size=null,this.index=null,this.alpha=100,this.threshold=2,this.brightness=null,this.gradation=0,this.cursor="auto",this.usePenGuide=!1,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="",this.borderStyle="normal",this.canUndo=!0,this.lineCap="square",this.lineJoin="bevel"}previewPenSize(){let t=this.axpObj.penSystem.CANVAS.pensize,e=this.axpObj.penSystem.CANVAS.pensize_ctx;e.clearRect(0,0,t.width,t.height),e.globalCompositeOperation="source-over",e.globalAlpha=this.alpha/100;let n=80,i=this.gradation-270,a=Math.round(40*Math.cos(i*(Math.PI/180))),s=Math.round(40*Math.sin(i*(Math.PI/180))),r=40+a,o=40+s,l=40-a,d=40-s,c=e.createLinearGradient(r,o,l,d),h=this.axpObj.colorMakerSystem.getMainColor(),p=this.axpObj.colorMakerSystem.getSubColor();c.addColorStop(0,h),c.addColorStop(1,p),e.fillStyle=c,e.beginPath(),e.fillRect(10,10,n,n)}start(t,e){if(this.axpObj.layerSystem.isWriteProtection())return;if(!c(t,0,this.axpObj.x_size))return;if(!c(e,0,this.axpObj.y_size))return;if("true"===document.getElementById("color_transparent").dataset.selected)return void this.axpObj.msg(`${this.name}は透明色を使用できません。`,"caution");this.axpObj.layerSystem.save(),this.init_brush();var n;r(this.axpObj.colorMakerSystem.getMainColor());n="option_layer"===document.getElementById("select_fill").value?this.axpObj.layerSystem.getImage():this.axpObj.layerSystem.getCanvasImage();var i=new ImageData(this.axpObj.x_size,this.axpObj.y_size);this.regionFill(n,i,t,e,[255,255,255]),this.CANVAS.brush_ctx.putImageData(i,0,0);let a=function(t){let e=t.width,n=t.height,i=0,a=0;for(var s=0;s<t.height;s++)for(var r=0;r<t.width;r++){let o=4*(r+s*t.height);0!==t.data[o+3]&&(e=Math.min(r,e),n=Math.min(s,n),i=Math.max(r,i),a=Math.max(s,a))}return{x0:e,y0:n,x1:i,y1:a}}(i),s=document.createElement("canvas");s.width=this.axpObj.x_size,s.height=this.axpObj.y_size;let o=s.getContext("2d"),l=Math.max(a.x1-a.x0,a.y1-a.y0)/2,d=this.gradation-270,h=a.x0+(a.x1-a.x0)/2,p=a.y0+(a.y1-a.y0)/2,u=Math.round(l*Math.cos(d*(Math.PI/180))),g=Math.round(l*Math.sin(d*(Math.PI/180))),m=h+u;m<a.x0&&(m=a.x0),m>a.x1&&(m=a.x1);let b=p+g;b<a.y0&&(b=a.y0),b>a.y1&&(b=a.y1);let x=h-u;x<a.x0&&(x=a.x0),x>a.x1&&(x=a.x1);let y=p-g;y<a.y0&&(y=a.y0),y>a.y1&&(y=a.y1);let _=o.createLinearGradient(m,b,x,y);_.addColorStop(0,this.axpObj.colorMakerSystem.getMainColor()),_.addColorStop(1,this.axpObj.colorMakerSystem.getSubColor()),o.fillStyle=_,o.beginPath(),o.fillRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.brush_ctx.globalCompositeOperation="source-in",this.CANVAS.brush_ctx.drawImage(s,0,0),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}move(t,e){}end(){}}class w extends _{constructor(t){super(),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="ハンド",this.type="hand",this.size=null,this.index=null,this.alpha=null,this.threshold=null,this.brightness=null,this.cursor="grab",this.usePenGuide=!1,this.usePenPreview=!1,this.usePenLock=!1,this.borderRadius="",this.borderStyle="",this.canUndo=!1}start(t,e,n){this.axpObj.isDrawing=!0;var i=this.axpObj.ELEMENT.view.getBoundingClientRect(),a=this.axpObj.CANVAS.main.getBoundingClientRect();this.base_x=a.left-i.left,this.base_y=a.top-i.top,this.old_x=n.clientX,this.old_y=n.clientY}move(t,e,n){if(this.axpObj.isDrawing){var i=this.base_x+n.clientX-this.old_x,a=this.base_y+n.clientY-this.old_y;this.axpObj.CANVAS.main.style.left=i+"px",this.axpObj.CANVAS.main.style.top=a+"px",this.axpObj.ELEMENT.grid.style.left=this.axpObj.CANVAS.main.style.left,this.axpObj.ELEMENT.grid.style.top=this.axpObj.CANVAS.main.style.top,this.axpObj.ELEMENT.grid_dot.style.left=this.axpObj.CANVAS.main.style.left,this.axpObj.ELEMENT.grid_dot.style.top=this.axpObj.CANVAS.main.style.top;var s=this.axpObj.ELEMENT.view.getBoundingClientRect();this.axpObj.canvas_x=i-parseInt((s.width-this.axpObj.x_size*this.axpObj.scale/100)/2),this.axpObj.canvas_y=a-parseInt((s.height-this.axpObj.y_size*this.axpObj.scale/100)/2),this.axpObj.assistToolSystem.mapguide()}}end(){this.axpObj.isDrawing&&(this.axpObj.isDrawing=!1)}}class E extends _{constructor(t){super(),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="スポイト",this.type="spuit",this.size=null,this.index=null,this.alpha=null,this.threshold=null,this.brightness=null,this.cursor="crosshair",this.usePenGuide=!1,this.usePenPreview=!0,this.usePenLock=!1,this.borderRadius="",this.borderStyle="",this.canUndo=!1,this.lineCap="",this.lineJoin=""}previewPenSize(){let t=this.axpObj.penSystem.CANVAS.pensize,e=this.axpObj.penSystem.CANVAS.pensize_ctx;e.clearRect(0,0,t.width,t.height),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.beginPath(),e.strokeStyle="#FF0000",e.lineWidth=3,e.strokeRect(40,40,20,20)}start(t,e,n){n.target.classList.contains("draw_zone")&&(this.axpObj.isDrawing=!0,this.axpObj.penSystem.spuit(n))}move(t,e,n){this.axpObj.isDrawing&&this.axpObj.penSystem.spuit(n);let i="-",a="-",s="-",r="-",o=this.CANVAS.spuit,l=this.CANVAS.spuit_ctx;if(l.clearRect(0,0,o.width,o.height),n.target.classList.contains("draw_zone")){var d=this.axpObj.CANVAS.main.getBoundingClientRect(),c=(t=parseInt(100*(n.clientX-d.left)/this.axpObj.scale),e=parseInt(100*(n.clientY-d.top)/this.axpObj.scale),this.axpObj.CANVAS.main_ctx.getImageData(t-2,e-2,5,5));l.putImageData(c,0,0);let o=48;i=c.data[o+0],a=c.data[o+1],s=c.data[o+2],this.axpObj.assistToolSystem.getIsTransparent()&&(r=c.data[o+3])}document.getElementById("axp-pen-div-color-red").textContent=i,document.getElementById("axp-pen-div-color-green").textContent=a,document.getElementById("axp-pen-div-color-blue").textContent=s,document.getElementById("axp-pen-div-color-alpha").textContent=r}end(){this.axpObj.isDrawing&&(this.axpObj.isDrawing=!1,!0===document.getElementById("config_spuit_autochange").checked&&(this.axpObj.isCTRL||(this.axpObj.penSystem.changePenMode("pen"),document.getElementById("spuit_base").dataset.selected="false",document.getElementById("pen_base").dataset.selected="true")))}}class C extends A{constructor(t){super(t),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="角ペン",this.type="draw",this.size=8,this.index=this.size?y(this.size):null,this.alpha=100,this.threshold=null,this.brightness=0,this.cursor="auto",this.usePenGuide=!0,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="0px",this.borderStyle="normal",this.canUndo=!0,this.lineCap="square",this.lineJoin="bevel"}}class j extends _{constructor(t){super(),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="移動ツール",this.type="move",this.size=null,this.index=null,this.alpha=null,this.threshold=null,this.brightness=null,this.cursor="move",this.usePenGuide=!1,this.usePenLock=!0,this.borderRadius="",this.borderStyle="",this.canUndo=!0,this.isDrag=!1,this.isContinue=!1,this.last_x=0,this.last_y=0}start(t,e,n){this.axpObj.layerSystem.isWriteProtection()||(this.axpObj.isDrawing=!0,this.axpObj.layerSystem.save(),this.base_x=t,this.base_y=e)}move(t,e,n){if(this.axpObj.isDrawing){var i=t-this.base_x,a=e-this.base_y;this.CANVAS.draw_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),i,a),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}}end(t,e){this.end_common()}}class k extends A{img_draw;constructor(t){super(t),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="ドットペン",this.type="draw",this.size=1,this.index=this.size?y(this.size):null,this.alpha=100,this.threshold=null,this.brightness=0,this.cursor="auto",this.usePenGuide=!0,this.usePenLock=!0,this.borderRadius="0px",this.borderStyle="normal",this.canUndo=!0,this.lineCap="square",this.lineJoin="bevel"}drawPenGuide(t){let e=parseInt(this.size*this.axpObj.scale/100);this.axpObj.ELEMENT.cursor.style.width=e+"px",this.axpObj.ELEMENT.cursor.style.height=e+"px";let n=this.axpObj.ELEMENT.base.getBoundingClientRect(),i=this.axpObj.CANVAS.main.getBoundingClientRect(),a=parseInt(100*(t.clientX-i.left)/this.axpObj.scale),s=parseInt(100*(t.clientY-i.top)/this.axpObj.scale),r=this.size,o=Math.floor(a/r)*r,l=Math.floor(s/r)*r,d=parseInt(o*this.axpObj.scale/100)+i.left,c=parseInt(l*this.axpObj.scale/100)+i.top-n.top;this.axpObj.ELEMENT.cursor.style.left=d+"px",this.axpObj.ELEMENT.cursor.style.top=c+"px"}start(t,e){this.axpObj.layerSystem.isWriteProtection()||(this.set_modeflag(),this.input_position=[],this.input_position.push({x:t,y:e}),this.input_position.push({x:t,y:e}),this.input_position.push({x:t,y:e}),this.axpObj.layerSystem.save(),this.isFirstDrawing=!0,this.isLastDrawing=!1,this.init_brush(),this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.img_draw=new ImageData(this.axpObj.x_size,this.axpObj.y_size),this.draw(),this.CANVAS.brush_ctx.putImageData(this.img_draw,0,0),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas(),this.isFirstDrawing=!1)}move(t,e){this.axpObj.isDrawing&&(this.input_position.push({x:t,y:e}),this.clear_brush(),this.draw(),this.CANVAS.brush_ctx.putImageData(this.img_draw,0,0),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas())}clear_brush(){let t=!1;switch(this.axpObj.isLine&&(t=!0),this.drawmode){case this.axpObj.CONST.DRAW_RECT:case this.axpObj.CONST.DRAW_CIRCLE:t=!0}t&&(this.img_draw=new ImageData(this.axpObj.x_size,this.axpObj.y_size))}end(t,e){this.end_common()}trans_dot(t){return Math.trunc(t/this.size)*this.size+this.size/2}draw(t=0){let e,n,i,a,s=r(this.axpObj.colorMakerSystem.getMainColor());switch(this.drawmode){case this.axpObj.CONST.DRAW_FREEHAND:this.axpObj.isLine?(e=this.input_position.at(0).x,n=this.input_position.at(0).y):(e=this.input_position.at(-2).x,n=this.input_position.at(-2).y),i=this.input_position.at(-1).x,a=this.input_position.at(-1).y,e=this.trans_dot(e),n=this.trans_dot(n),i=this.trans_dot(i),a=this.trans_dot(a),this.drawLine(this.img_draw,this.trans_x(e,t),this.trans_y(n,t),this.trans_x(i,t),this.trans_y(a,t),this.size,s);break;case this.axpObj.CONST.DRAW_RECT:e=this.input_position.at(0).x,n=this.input_position.at(0).y,i=this.input_position.at(-1).x,a=this.input_position.at(-1).y,this.drawLine(this.img_draw,e,n,e,a,this.size,s),this.drawLine(this.img_draw,e,a,i,a,this.size,s),this.drawLine(this.img_draw,e,n,i,n,this.size,s),this.drawLine(this.img_draw,i,n,i,a,this.size,s);break;case this.axpObj.CONST.DRAW_CIRCLE:e=this.input_position.at(0).x,n=this.input_position.at(0).y,i=this.input_position.at(-1).x,a=this.input_position.at(-1).y,this.drawCircle(this.img_draw,e,n,i,a,this.size,s)}}drawLine(t,e,n,i,a,s,r){const{width:o,height:l,data:d}=t,c=Math.abs(i-e),h=Math.abs(a-n),p=e<i?1:-1,u=n<a?1:-1;let g=c-h,m=e,b=n,x=-1,y=-1;for(;;){let t=Math.trunc(m/s)*s,e=Math.trunc(b/s)*s;if(t!==x||e!==y){let n=t+s-1,i=e+s-1;for(let a=t;a<=n;a++)for(let t=e;t<=i;t++)if(a>=0&&a<this.axpObj.x_size&&t>=0&&t<this.axpObj.y_size){const e=4*(a+t*o);d[e+0]=r[0],d[e+1]=r[1],d[e+2]=r[2],d[e+3]=255}x=t,y=e}if(m===i&&b===a)break;let n=2*g;n>-h&&(g-=h,m+=p),n<c&&(g+=c,b+=u)}}drawCircle(t,e,n,i,a,s,r){const{width:o,height:l,data:d}=t,c=parseInt(Math.sqrt(Math.pow(i-e,2)+Math.pow(a-n,2)));if(c<=0)return;var h=parseInt(128*c),p=0,u=0,g=0;const m=(t,e)=>{let n=Math.floor(t/s)*s,i=Math.floor(e/s)*s,a=n+s-1,l=i+s-1;for(let t=n;t<=a;t++)for(let e=i;e<=l;e++)if(t>=0&&t<this.axpObj.x_size&&e>=0&&e<this.axpObj.y_size){const n=4*(t+e*o);d[n+0]=r[0],d[n+1]=r[1],d[n+2]=r[2],d[n+3]=255}};for(;p<=h;)m(e+(u=parseInt(h/128)),n+(g=parseInt(p/128))),m(e-u,n-g),m(e-u,n+g),m(e+u,n-g),m(e+g,n+u),m(e-g,n-u),m(e-g,n+u),m(e+g,n-u),p+=parseInt(h/128),h-=parseInt(p/128)}}class I extends A{constructor(t){super(t),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="筆ペン",this.type="fude",this.size=5,this.index=this.size?y(this.size):null,this.alpha=100,this.threshold=null,this.brightness=0,this.cursor="auto",this.usePenGuide=!0,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="50%",this.borderStyle="normal",this.canUndo=!0,this.lineCap="round",this.lineJoin="round"}init_brush(){this.init_globalCompositeOperation(),this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.lineWidth=this.size/2,this.CANVAS.brush_ctx.strokeStyle=this.adjust_color(this.axpObj.colorMakerSystem.getMainColor()),this.CANVAS.brush_ctx.lineCap=this.lineCap,this.CANVAS.brush_ctx.lineJoin=this.lineJoin,this.blur()}move(t,e,n){this.axpObj.isDrawing&&(this.input_position.push({x:t,y:e}),this.draw(),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas())}draw(){let t=this.CANVAS.brush_ctx,e=this.input_position.at(-2).x,n=this.input_position.at(-2).y,i=this.input_position.at(-1).x,a=this.input_position.at(-1).y;var s=parseInt(Math.sqrt(Math.pow(i-e,2)+Math.pow(a-n,2))),r=t.lineWidth;if(1.4*s>this.size){let o=2*parseInt(1.4*s/this.size),l=(i-e)/o,d=(a-n)/o;for(let i=0;i<o;i++)r*=.9,r=Math.max(Math.min(this.size,r),1),t.lineWidth=r,t.beginPath(),t.moveTo(e+l*i,n+d*i),t.lineTo(e+l*(i+1),n+d*(i+1)),t.stroke(),t.closePath()}else r=t.lineWidth+.03*this.size,r=Math.max(Math.min(this.size,r),1),t.lineWidth=r,t.beginPath(),t.moveTo(e,n),t.lineTo(i,a),t.stroke(),t.closePath()}end(t,e,n){this.axpObj.isDrawing&&(this.isLastDrawing=!0,this.input_position.push({x:t,y:e}),this.draw(),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()),this.end_common()}}class N extends k{constructor(t){super(t),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="クレヨン",this.type="draw",this.size=15,this.index=this.size?y(this.size):null,this.alpha=100,this.threshold=null,this.brightness=0,this.cursor="auto",this.usePenGuide=!0,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="0px",this.borderStyle="normal",this.canUndo=!0,this.lineCap="square",this.lineJoin="bevel"}drawPenGuide(t){let e=parseInt(this.size*this.axpObj.scale/100);this.axpObj.ELEMENT.cursor.style.width=e+"px",this.axpObj.ELEMENT.cursor.style.height=e+"px";let n=this.axpObj.ELEMENT.view.getBoundingClientRect(),i=parseInt(t.clientX-n.left-e/2),a=parseInt(t.clientY-n.top-e/2);this.axpObj.ELEMENT.cursor.style.left=i+"px",this.axpObj.ELEMENT.cursor.style.top=a+"px"}trans_dot(t){return t}drawLine(t,e,n,i,a,s,r){const{width:o,height:l,data:d}=t,c=Math.abs(i-e),h=Math.abs(a-n),p=e<i?1:-1,u=n<a?1:-1,g=20+2*s,m=parseInt(s/2);let b=c-h,x=e,y=n,_=-1,A=-1;for(;;){let t=x,e=y;if(t!==_||e!==A){let n=t+s,i=e+s;for(let a=0;a<g;a++){let a=parseInt(Math.random()*(n-t)+t)-m,s=parseInt(Math.random()*(i-e)+e)-m,l=parseInt(30*Math.random())+20;if(a>=0&&a<this.axpObj.x_size&&s>=0&&s<this.axpObj.y_size){const t=4*(a+s*o);d[t+0]=r[0],d[t+1]=r[1],d[t+2]=r[2],d[t+3]=l}}_=t,A=e}if(x===i&&y===a)break;let n=2*b;n>-h&&(b-=h,x+=p),n<c&&(b+=c,y+=u)}}drawCircle(t,e,n,i,a,s,r){const{width:o,height:l,data:d}=t,c=20+2*s,h=parseInt(s/2),p=parseInt(Math.sqrt(Math.pow(i-e,2)+Math.pow(a-n,2)));if(p<=0)return;var u=parseInt(128*p),g=0,m=0,b=0;const x=(t,e)=>{let n=t+s,i=e+s;for(let a=0;a<c;a++){let a=parseInt(Math.random()*(n-t)+t)-h,s=parseInt(Math.random()*(i-e)+e)-h,l=parseInt(30*Math.random())+20;if(a>=0&&a<this.axpObj.x_size&&s>=0&&s<this.axpObj.y_size){const t=4*(a+s*o);d[t+0]=r[0],d[t+1]=r[1],d[t+2]=r[2],d[t+3]=l}}};for(;g<=u;)x(e+(m=parseInt(u/128)),n+(b=parseInt(g/128))),x(e-m,n-b),x(e-m,n+b),x(e+m,n-b),x(e+b,n+m),x(e-b,n-m),x(e-b,n+m),x(e+b,n-m),g+=parseInt(u/128),u-=parseInt(g/128)}}class B extends _{constructor(t){super(t),this.axpObj=t.axpObj,this.CANVAS=t.CANVAS,this.name="エアブラシ",this.type="brush",this.size=100,this.index=this.size?y(this.size):null,this.alpha=30,this.threshold=null,this.brightness=0,this.cursor="auto",this.usePenGuide=!0,this.usePenPreview=!0,this.usePenLock=!0,this.borderRadius="50%",this.borderStyle="normal",this.canUndo=!0,this.lineCap="round",this.lineJoin="round"}init_brush(){this.init_globalCompositeOperation(),this.CANVAS.draw_ctx.globalAlpha=this.alpha/100,this.CANVAS.brush_ctx.globalCompositeOperation="source-over",this.CANVAS.brush_ctx.globalAlpha=1,this.blur()}start(t,e,n){this.axpObj.layerSystem.isWriteProtection()||(this.set_modeflag(),this.input_position=[],this.input_position.push({x:t,y:e}),this.input_position.push({x:t,y:e}),this.input_position.push({x:t,y:e}),this.axpObj.layerSystem.save(),this.init_brush(),this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.draw(),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas(),this.isFirstDrawing=!1)}draw(){var t=this.size/2,e=this.CANVAS.brush_ctx.createRadialGradient(this.input_position.at(-1).x,this.input_position.at(-1).y,0,this.input_position.at(-1).x,this.input_position.at(-1).y,t),n=r(this.adjust_color(this.axpObj.colorMakerSystem.getMainColor())),i="rgba("+n[0]+","+n[1]+","+n[2]+","+this.alpha/100+")",a="rgba("+n[0]+","+n[1]+","+n[2]+",0)";e.addColorStop(0,i),e.addColorStop(1,a),this.CANVAS.brush_ctx.fillStyle=e,this.CANVAS.brush_ctx.fillRect(0,0,this.axpObj.x_size,this.axpObj.y_size)}move(t,e){this.axpObj.isDrawing&&(this.input_position.push({x:t,y:e}),this.draw(),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.load(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas())}end(t,e){this.end_common()}}n(166);class M extends s{pen_mode;exec_pen_mode;isTemporary=!1;temporaryMode;saveElement;saveMode;saveIcon;saveMsg;penObj=[];CONST={};CANVAS={draw:null,draw_ctx:null,brush:null,brush_ctx:null,spuit:null,spuit_ctx:null,pensize:null,pensize_ctx:null};base_index=null;old_x;old_y;preview_dragstart_x;preview_dragstart_y;constructor(t){super(t)}getDefaultPosition(){return{left:10,top:10}}init(){this.createHTML("tool_pen","ペンツール","axp-icon-window-pen",'\x3c!-- ペンツール --\x3e\r\n<div class="tool_pen_content">\r\n    <div style="margin-left: 4px;">\r\n        <label id="pen_name" class="MSG" data-msg="現在選択しているペンの名前が表示されます。">丸ペン</label>\r\n        <hr>\r\n        <div id="axp-pen-div_preview">\r\n            <canvas id="canvas_pensize"></canvas>\r\n            <canvas id="axp-pen-canvas_spuit"></canvas>\r\n        </div>\r\n\r\n        <div id="axp-pen-div-slidebar">\r\n            \x3c!-- ペンの不透明度 --\x3e\r\n            <form oninput="result.value=parseInt(volume.value)" id="range-alpha-value" class="range_text">\r\n                <input type="range" id="range-alpha" name="volume" min="5" max="100" value="100" step="5" class="MSG"\r\n                    data-msg="ペンの不透明度を変更します。0に近づくほど透明になります。">\r\n                <br>\r\n                不透明度:<output name="result" for="volume">100</output>\r\n            </form>\r\n            \x3c!-- ペンの太さ --\x3e\r\n            <form id="pensize-value" class="range_text">\r\n                <input type="range" id="pensize" name="pensize" value="1" min="1" max="100" class="MSG"\r\n                    data-msg="ペンの太さを変更します。">\r\n                <br>\r\n                太さ:<output name="result" for="pensize">1</output>\r\n            </form>\r\n            \x3c!-- バケツの境界補正 --\x3e\r\n            <form oninput="result.value=parseInt(volume.value)" id="range_fill_threshold_value"\r\n                class="displaynone range_text">\r\n                <input type="range" id="range_fill_threshold" name="volume" value="0" step="1" min="0" max="5"\r\n                    class="MSG" data-msg="境界付近の塗り残しドットを目立たなくします。数字が大きいほど強く補正します。">\r\n                <br>\r\n                塗り残し補正:<output name="result" for="volume">0</output>\r\n            </form>\r\n            \x3c!-- バケツのグラデーション角度 --\x3e\r\n            <form oninput="result.value=parseInt(volume.value)" id="range_fill_gradation_value"\r\n                class="displaynone range_text">\r\n                <input type="range" id="range_fill_gradation" name="volume" value="0" step="1" min="0" max="360"\r\n                    class="MSG" data-msg="グラデーションの向きを角度で指定します。">\r\n                <br>\r\n                角度:<output name="result" for="volume">0</output>\r\n            </form>\r\n            \x3c!-- 明るさ補正（オプション） --\x3e\r\n            <form oninput="result.value=parseInt(volume.value)" id="range_brightness_value"\r\n                class="displaynone range_text">\r\n                <input type="range" id="range_brightness" name="volume" value="0" step="1" min="-50" max="50"\r\n                    class="MSG" data-msg="ペンの明るさを変更します。">\r\n                <br>\r\n                明るさ補正:<output name="result" for="volume">0</output>\r\n            </form>\r\n        </div>\r\n\r\n        <div id="axp-pen-div-color">\r\n            赤:<span id="axp-pen-div-color-red">-</span><br>\r\n            緑:<span id="axp-pen-div-color-green">-</span><br>\r\n            青:<span id="axp-pen-div-color-blue">-</span><br>\r\n            透:<span id="axp-pen-div-color-alpha">-</span><br>\r\n        </div>\r\n\r\n        <div id="axp-pen-div-selectbox">\r\n            <select id="select_pen_mode" class="MSG" data-msg="図形描画モードを選択できます。">\r\n                <option value="option_normal">手描き</option>\r\n                <option value="option_line">直線</option>\r\n                <option value="option_rectangle">長方形</option>\r\n                <option value="option_circle">円</option>\r\n            </select>\r\n            <select id="select_fill" class="MSG displaynone"\r\n                data-msg="「囲まれた領域」の判定方式を選択できます。（全ﾚｲﾔｰ判定を指定すると表示見たままで塗分けができます）">\r\n                <option value="option_all">全ﾚｲﾔｰ判定</option>\r\n                <option value="option_layer">現ﾚｲﾔｰ判定</option>\r\n            </select>\r\n        </div>\r\n\r\n    </div>\r\n    <div id="axp-pen-div-button">\r\n        <button data-idx="0" id="pen_base" class="MSG button_penicon axp-pen-button-main" data-selected="true"\r\n            data-addmsg="[再選択]:ペン種別変更。"></button>\r\n        <br>\r\n        <button data-idx="1" id="eraser_base" class="MSG button_penicon axp-pen-button-main"\r\n            data-addmsg="[再選択]:消しゴム種別変更。"></button>\r\n        <br>\r\n        <button data-idx="2" id="fill_base" class="MSG button_penicon axp-pen-button-main"\r\n            data-addmsg="[再選択]:バケツ種別変更。"></button>\r\n        <br>\r\n        <button data-idx="3" id="hand_base" class="MSG button_penicon axp-pen-button-main"\r\n            data-addmsg="[再選択]:ツール種別変更。"></button>\r\n        <br>\r\n        <button data-idx="4" id="spuit_base" class="MSG button_penicon axp-pen-button-main" data-addmsg=""></button>\r\n    </div>\r\n</div>'),this.axpObj.paintBodyElement.insertAdjacentHTML("afterbegin",'\x3c!-- axp-pen-sub --\x3e\r\n\x3c!--ペンの種類変更用モーダルウィンドウ定義 --\x3e\r\n<div id="penwindow" class="subwindow">\r\n    <article>\r\n        <button id="pen" class="MSG button_penicon axp-pen-button-sub pen" data-idx="0"\r\n            data-msg="丸ペン：一定の太さの線が描けるペン。[SPACE]:直線描画。"></button>\r\n        <button id="square" class="MSG button_penicon axp-pen-button-sub square" data-idx="0"\r\n            data-msg="角ペン：先が四角い線が描けるペン。[SPACE]:直線描画。"></button>\r\n        <button id="dot" class="MSG button_penicon axp-pen-button-sub dot" data-idx="0"\r\n            data-msg="ドットペン：ドット絵調の線が描けるペン。[SPACE]:直線描画。"></button>\r\n        <button id="fude" class="MSG button_penicon axp-pen-button-sub fude" data-idx="0"\r\n            data-msg="筆ペン：強弱のついた線が描けるペン。"></button>\r\n        <button id="crayon" class="MSG button_penicon axp-pen-button-sub crayon" data-idx="0"\r\n            data-msg="クレヨン：クレヨン風の塗りができるペン。[SPACE]:直線描画。"></button>\r\n        <button id="brush" class="MSG button_penicon axp-pen-button-sub brush" data-idx="0"\r\n            data-msg="エアブラシ：エアブラシ風の塗りができるペン。"></button>\r\n    </article>\r\n    <article>\r\n        <button id="axp-pen-sub-button-eraser-round"\r\n            class="MSG button_penicon axp-pen-button-sub axp-pen-sub-button-eraser-round" data-idx="1"\r\n            data-msg="消しゴム：辺が丸い消しゴム。[SPACE]:直線描画。"></button>\r\n        <button id="axp-pen-sub-button-eraser-dot"\r\n            class="MSG button_penicon axp-pen-button-sub axp-pen-sub-button-eraser-dot" data-idx="1"\r\n            data-msg="角消しゴム：辺が四角い消しゴム。[SPACE]:直線描画。"></button>\r\n    </article>\r\n    <article>\r\n        <button id="fill" class="MSG button_penicon axp-pen-button-sub fill" data-idx="2"\r\n            data-msg="バケツ：囲まれた領域の内側を塗り潰します。"></button>\r\n        <button id="fillgradation" class="MSG button_penicon axp-pen-button-sub fillgradation" data-idx="2"\r\n            data-msg="階調バケツ：メインカラーとサブカラーのグラデーションで、囲まれた領域の内側を塗り潰します。"></button>\r\n    </article>\r\n    <article>\r\n        <button id="hand" class="MSG button_penicon axp-pen-button-sub hand" data-idx="3"\r\n            data-msg="ハンド：ドラッグでキャンバスの位置を移動します。[SPACE]:押している間ハンドに変化。"></button>\r\n        <button id="move" class="MSG button_penicon axp-pen-button-sub move" data-idx="3"\r\n            data-msg="移動ツール：画像を上下左右に移動するツール（現在のレイヤーのみ対象）"></button>\r\n    </article>\r\n    <article>\r\n        <button id="spuit" class="MSG button_penicon axp-pen-button-sub spuit" data-idx="4"\r\n            data-msg="スポイト：指定座標の色を取得し、メインカラーに設定します。[CTRL]:押している間スポイトに変化。"></button>\r\n    </article>\r\n</div>\r\n\x3c!--追加用HTMLここまで --\x3e'),this.window_width=180,this.CANVAS.draw=document.createElement("canvas"),this.CANVAS.draw_ctx=this.CANVAS.draw.getContext("2d"),this.CANVAS.brush=document.createElement("canvas"),this.CANVAS.brush_ctx=this.CANVAS.brush.getContext("2d"),this.CANVAS.pensize=document.getElementById("canvas_pensize"),this.CANVAS.pensize.width=100,this.CANVAS.pensize.height=100,this.CANVAS.pensize_ctx=this.CANVAS.pensize.getContext("2d"),this.CANVAS.spuit=document.getElementById("axp-pen-canvas_spuit"),this.CANVAS.spuit.width=5,this.CANVAS.spuit.height=5,this.CANVAS.spuit_ctx=this.CANVAS.spuit.getContext("2d"),this.penObj.pen=new A({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj["axp-pen-sub-button-eraser-round"]=new f({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj["axp-pen-sub-button-eraser-dot"]=new v({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.fill=new S({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.fillgradation=new O({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.hand=new w({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.spuit=new E({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.square=new C({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.move=new j({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.dot=new k({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.fude=new I({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.crayon=new N({axpObj:this.axpObj,CANVAS:this.CANVAS}),this.penObj.brush=new B({axpObj:this.axpObj,CANVAS:this.CANVAS});let t=document.querySelectorAll("#axp-pen-div-button>button"),e=document.querySelectorAll("#penwindow>article>button:first-of-type");t.forEach(((t,n)=>{t.dataset.msg=e[n].dataset.msg+t.dataset.addmsg,t.dataset.set=e[n].id,t.classList.add(e[n].id)})),this.pen_mode="pen"}resetCanvas(){this.CANVAS.draw.width=this.axpObj.x_size,this.CANVAS.draw.height=this.axpObj.y_size,this.CANVAS.brush.width=this.axpObj.x_size,this.CANVAS.brush.height=this.axpObj.y_size}startEvent(){const t=document.getElementsByClassName("axp-pen-button-main");for(const e of t)e.addEventListener("pointerdown",(t=>{if(this.axpObj.isCTRL)return void this.axpObj.msg("[CTRL]キーでスポイトに変化中です。別のペンは選択できません。","caution");if(this.axpObj.isSPACE)return void this.axpObj.msg("[SPACE]キーでハンドに変化中です。別のペンは選択できません。","caution");let e=t.currentTarget;if("true"===e.dataset.selected){let n=document.querySelectorAll("#penwindow > article");if("4"!==e.dataset.idx){let i=Number(e.dataset.idx);n.forEach((t=>{t.style.display="none"}));let a=t.target.getBoundingClientRect(),s=n[Number(i)];return s.style.display="",s.style.marginLeft=a.left+54+"px",s.style.marginTop=a.top+"px",this.axpObj.isModalOpen=!0,void(document.getElementById("penwindow").style.display="block")}}const n=document.getElementsByClassName("button_penicon");for(const t of n)t.dataset.selected="false";let i=null;e.dataset.selected="true",i=e.dataset.set,this.changePenMode(i)}));const e=document.querySelectorAll(".axp-pen-button-main"),n=document.querySelectorAll(".axp-pen-button-sub");for(const t of n)t.addEventListener("pointerdown",(t=>{let n=t.currentTarget;e[Number(n.dataset.idx)].classList.remove(e[Number(n.dataset.idx)].dataset.set),e[Number(n.dataset.idx)].classList.add(n.id),e[Number(n.dataset.idx)].dataset.set=n.id,e[Number(n.dataset.idx)].dataset.msg=n.dataset.msg+e[Number(n.dataset.idx)].dataset.addmsg;let i=n.id;this.changePenMode(i)}));document.getElementById("penwindow").addEventListener("click",(t=>{this.axpObj.isModalOpen=!1,document.getElementById("penwindow").style.display="none",document.getElementById("pen_base").dataset.opensub=""})),document.getElementById("pensize").addEventListener("input",(t=>{let e=document.getElementById("pensize").value,n=this.getName(),i=this.setIndex(e);document.getElementById("pensize-value").result.value=i,this.axpObj.msg(`${n}の太さ：${i}`),this.previewPenSize(),this.axpObj.configSystem.saveConfig("size_"+this.pen_mode,i)})),document.getElementById("range-alpha").addEventListener("input",(t=>{let e=document.getElementById("range-alpha").value,n=this.getName();this.setAlpha(e),this.axpObj.msg(`${n}の不透明度：${e}`),this.previewPenSize(),this.axpObj.configSystem.saveConfig("alpha_"+this.pen_mode,e)})),document.getElementById("range_fill_threshold").addEventListener("input",(t=>{let e=document.getElementById("range_fill_threshold").value,n=this.getName();this.setThreshold(e),this.axpObj.msg(`${n}の塗り残し補正：${e}`),this.axpObj.configSystem.saveConfig("threshold_"+this.pen_mode,e)})),document.getElementById("range_fill_gradation").addEventListener("input",(t=>{let e=document.getElementById("range_fill_gradation").value,n=this.getName();this.setGradation(e),this.axpObj.msg(`${n}の角度：${e}`),this.previewPenSize()})),document.getElementById("range_brightness").addEventListener("input",(t=>{let e=document.getElementById("range_brightness").value,n=this.getName();this.setBrightness(e),this.axpObj.msg(`${n}の明るさ補正：${e}`),this.previewPenSize()}));const i=t=>{if("pointerdown"===t.type&&(t.target.classList.add("DRUGING"),this.preview_dragstart_x=t.offsetX,this.preview_dragstart_y=t.offsetY),t.target.classList.contains("DRUGING")){let l=t.currentTarget,d=this.getName();if("fillgradation"===this.pen_mode){let e=t.offsetX-this.preview_dragstart_x,n=((t,e)=>{let n=Math.atan2(t,e);return n<0&&(n+=2*Math.PI),Math.round(180*n/Math.PI)})(t.offsetY-this.preview_dragstart_y,e)-270;return n<0&&(n+=360),this.axpObj.msg(`${d}の角度：${n}`),this.setGradation(n),document.getElementById("range_fill_gradation").value=n,document.getElementById("range_fill_gradation_value").result.value=n,void this.previewPenSize()}var e=l.width/2,n=l.height/2,i=t.offsetX,a=t.offsetY,s=2*Math.sqrt(Math.pow(i-e,2)+Math.pow(a-n,2)),r=Math.min(200,Math.max(1,parseInt(100*s/this.axpObj.scale))),o=this.setSize(r);if(!o)return void this.axpObj.msg(`${d}の太さは変更できません。`,"caution");this.axpObj.msg(`${d}の太さ：${r}`),this.previewPenSize(),document.getElementById("pensize").value=o,document.getElementById("pensize-value").result.value=r}};this.CANVAS.pensize.addEventListener("pointerdown",i),this.CANVAS.pensize.addEventListener("pointermove",i),this.CANVAS.pensize.addEventListener("pointerenter",(()=>{let t="",e=this.getName();switch(this.getType()){case"draw":case"eraser":t=`${e}のプレビュー。枠内をクリックまたはドラッグで太さを変更します。`;break;case"fill":t="fillgradation"===this.pen_mode?`${e}の色プレビュー。枠内をドラッグで角度を変更します。`:`${e}の色プレビュー。`;break;case"spuit":t="ポインタ座標の画像を拡大表示します。赤枠の色がスポイトで取得されます。"}this.axpObj.msg(t)})),this.CANVAS.pensize.addEventListener("pointerleave",(()=>{this.axpObj.msg("")}));const a=t=>{t.target.classList.contains("DRUGING")&&(t.target.classList.remove("DRUGING"),this.getSize()&&this.axpObj.configSystem.saveConfig("size_"+this.pen_mode,this.getSize()))};this.CANVAS.pensize.addEventListener("pointerup",a),this.CANVAS.pensize.addEventListener("pointerleave",a)}start(t,e,n,i){if(this.axpObj.isCHANGE_SIZE_KEY)return this.base_index=this.getIndex(),this.old_x=n.clientX,void(this.old_y=n.clientY);this.exec_pen_mode=i,this.penObj[this.exec_pen_mode].start(t,e,n)}move(t,e,n){let i=this.getName();if(this.axpObj.isCHANGE_SIZE_KEY&&null!==this.base_index){let t=n.clientX-this.old_x,e=Math.max(1,Math.min(100,this.base_index+t)),a=this.setIndex(e);document.getElementById("pensize").value=e,document.getElementById("pensize-value").result.value=a,this.previewPenSize(),this.axpObj.msg(`${i}の太さ：${a}`)}let a=this.exec_pen_mode||this.pen_mode;(n.target.classList.contains("draw_zone")||n.target===this.axpObj.ELEMENT.view)&&this.penObj[a].drawCursor(n),this.penObj[a].move(t,e,n)}end(t,e,n){this.axpObj.isCHANGE_SIZE_KEY&&null!==this.base_index&&(this.base_index=null,this.getSize()&&this.axpObj.configSystem.saveConfig("size_"+this.pen_mode,this.getSize())),this.exec_pen_mode&&(this.penObj[this.exec_pen_mode].end(t,e,n),this.penObj[this.exec_pen_mode].canUndo&&(function(t,e){if(t.data.length!=e.data.length)return!1;for(var n=0;n<t.data.length;++n)if(t.data[n]!=e.data[n])return!1;return!0}(this.axpObj.layerSystem.load(),this.axpObj.layerSystem.getCurrentLayerImage())||(this.axpObj.undoSystem.setUndo({type:"draw",detail:this.penObj[this.exec_pen_mode].type,layerObj:{id:this.axpObj.layerSystem.getId(),index:this.axpObj.layerSystem.getIndex(),mode:this.axpObj.layerSystem.getMode(),alpha:this.axpObj.layerSystem.getAlpha(),checked:this.axpObj.layerSystem.getChecked(),locked:this.axpObj.layerSystem.getLocked(),masked:this.axpObj.layerSystem.getMasked(),name:this.axpObj.layerSystem.getName(),image:this.axpObj.layerSystem.load()}}),this.axpObj.isBackgroundimage&&this.axpObj.drawBackground())),this.exec_pen_mode=null,this.axpObj.saveSystem.autoSave())}getSize(){return this.penObj[this.pen_mode].size}setSize(t){let e=null;return null!==this.penObj[this.pen_mode].size&&(this.penObj[this.pen_mode].size=t,e=y(t),this.penObj[this.pen_mode].index=e),e}setPenSize(t){let e=this.setSize(t),n=this.getName();e?(this.axpObj.msg(`${n}の太さ：${t}`),this.previewPenSize(),document.getElementById("pensize").value=e,document.getElementById("pensize-value").result.value=t,this.axpObj.configSystem.saveConfig("size_"+this.pen_mode,this.getSize())):this.axpObj.msg(`${n}の太さは変更できません`,"caution")}getIndex(){return this.penObj[this.pen_mode].index}setIndex(t){let e;if(null===this.penObj[this.pen_mode].size)throw new Error("内部エラー：不正な太さ指定です");return this.penObj[this.pen_mode].index=t,e=x[t],this.penObj[this.pen_mode].size=e,e}getAlpha(){return this.penObj[this.pen_mode].alpha}setAlpha(t){if(null===this.penObj[this.pen_mode].alpha)throw new Error("内部エラー：不正な不透明度指定です");this.penObj[this.pen_mode].alpha=t}getThreshold(){return this.penObj[this.pen_mode].threshold}setThreshold(t){if(null===this.penObj[this.pen_mode].threshold)throw new Error("内部エラー：不正な塗り残し補正指定です");this.penObj[this.pen_mode].threshold=t}getGradation(){return this.penObj[this.pen_mode].gradation}setGradation(t){if(null===this.penObj[this.pen_mode].gradation)throw new Error("内部エラー：不正な角度指定です");this.penObj[this.pen_mode].gradation=t}getBrightness(){return this.penObj[this.pen_mode].brightness}setBrightness(t){null!==this.penObj[this.pen_mode].brightness&&(this.penObj[this.pen_mode].brightness=t)}getType(){return this.penObj[this.pen_mode].type}getName(){return this.penObj[this.pen_mode].name}resetPenStyle(){Object.keys(penObj).forEach((t=>{penObj[t].init()}))}getPenMode(){return this.pen_mode}changePenModeTemporary(t){if(this.isTemporary)return void this.temporaryMode;this.isTemporary=!0,this.temporaryMode=t,this.saveMode=this.getPenMode();switch(document.querySelectorAll(".button_penicon").forEach((t=>{"true"===t.dataset.selected&&(this.saveElement=t,t.dataset.selected="false")})),t){case"spuit":this.axpObj.ELEMENT.view.style.cursor="crosshair",this.axpObj.ELEMENT.cursor.style.visibility="hidden",this.axpObj.msg("[CTRL]: 押している間、ペンがスポイトに変化します。"),document.getElementById("spuit_base").dataset.selected="true";break;case"hand":this.axpObj.ELEMENT.view.style.cursor="grab",this.axpObj.ELEMENT.cursor.style.visibility="hidden",this.axpObj.msg("[SPACE]: 押している間、ペンがハンドに変化します。");let t=document.getElementById("hand_base");t.dataset.selected="true",this.saveIcon=t.dataset.set,t.classList.remove(this.saveIcon),t.classList.add("hand"),this.saveMsg=t.dataset.msg,t.dataset.msg=document.getElementById("hand").dataset.msg}this.changePenMode(t)}restorePenModeTemporary(t){if(this.isTemporary&&this.temporaryMode==t){switch(this.isTemporary=!1,t){case"spuit":document.getElementById("spuit_base").dataset.selected="false";break;case"hand":let t=document.getElementById("hand_base");t.dataset.selected="false",t.dataset.msg=this.saveMsg,t.classList.remove("hand"),t.classList.add(this.saveIcon)}this.saveElement.dataset.selected="true",this.changePenMode(this.saveMode),this.temporaryMode=null,this.saveMode=null,this.saveElement=null,this.saveIcon=null,this.saveMsg=null,this.axpObj.msg("")}}changePenMode(t){t&&(this.pen_mode=t);var e=this.getSize();null===e?document.getElementById("pensize-value").classList.add("displaynone"):(document.getElementById("pensize-value").classList.remove("displaynone"),document.getElementById("pensize").value=this.getIndex(),document.getElementById("pensize-value").result.value=e);var n=this.getAlpha();null===n?document.getElementById("range-alpha-value").classList.add("displaynone"):(document.getElementById("range-alpha-value").classList.remove("displaynone"),document.getElementById("range-alpha").value=n,document.getElementById("range-alpha-value").result.value=n);var i=this.getThreshold();null===i?document.getElementById("range_fill_threshold_value").classList.add("displaynone"):(document.getElementById("range_fill_threshold_value").classList.remove("displaynone"),document.getElementById("range_fill_threshold").value=i,document.getElementById("range_fill_threshold_value").result.value=i);var a=this.getGradation();null===a?document.getElementById("range_fill_gradation_value").classList.add("displaynone"):(document.getElementById("range_fill_gradation_value").classList.remove("displaynone"),document.getElementById("range_fill_gradation").value=a,document.getElementById("range_fill_gradation_value").result.value=a);var s=this.getBrightness();switch(null===s?document.getElementById("range_brightness_value").classList.add("displaynone"):"on"==document.getElementById("config_range_brightness").elements.config_range_brightness.value?(document.getElementById("range_brightness_value").classList.remove("displaynone"),document.getElementById("range_brightness").value=s,document.getElementById("range_brightness_value").result.value=s):document.getElementById("range_brightness_value").classList.add("displaynone"),this.getType()){case"draw":case"eraser":document.getElementById("select_pen_mode").classList.remove("displaynone"),document.getElementById("select_fill").classList.add("displaynone"),document.getElementById("axp-pen-div-color").classList.add("displaynone");break;case"fill":document.getElementById("select_pen_mode").classList.add("displaynone"),document.getElementById("select_fill").classList.remove("displaynone"),document.getElementById("axp-pen-div-color").classList.add("displaynone");break;case"spuit":document.getElementById("select_pen_mode").classList.add("displaynone"),document.getElementById("select_fill").classList.add("displaynone"),document.getElementById("axp-pen-div-color").classList.remove("displaynone");break;default:document.getElementById("select_pen_mode").classList.add("displaynone"),document.getElementById("select_fill").classList.add("displaynone"),document.getElementById("axp-pen-div-color").classList.add("displaynone")}this.penObj[this.pen_mode].usePenPreview?document.getElementById("axp-pen-div_preview").style.visibility="visible":document.getElementById("axp-pen-div_preview").style.visibility="hidden",this.previewPenSize(),document.getElementById("pen_name").textContent=this.getName()}previewPenSize(){this.penObj[this.pen_mode].previewPenSize()}spuit(t){if(t.target.classList.contains("draw_zone")){var e=this.axpObj.CANVAS.main.getBoundingClientRect(),n=parseInt(100*(t.clientX-e.left)/this.axpObj.scale),i=parseInt(100*(t.clientY-e.top)/this.axpObj.scale),a=this.axpObj.CANVAS.main_ctx.getImageData(n,i,1,1),s=a.data[0],r=a.data[1],l=a.data[2];this.axpObj.colorMakerSystem.setMainColor("#"+o([s,r,l]))}}fillAll(){const t=this.axpObj.layerSystem.getId();let e;this.axpObj.undoSystem.setUndo({type:"draw",detail:"fillall",layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(t)]}),e="true"===document.getElementById("color_transparent").dataset.selected||"eraser"===this.getType()?"destination-out":this.axpObj.layerSystem.getMasked()?"source-atop":"source-over",this.axpObj.penSystem.CANVAS.draw_ctx.globalCompositeOperation=e,this.CANVAS.draw_ctx.globalAlpha=this.getAlpha()/100,this.CANVAS.draw_ctx.shadowBlur=0,this.CANVAS.brush_ctx.fillStyle=this.axpObj.colorMakerSystem.getMainColor(),this.CANVAS.brush_ctx.globalAlpha=1,this.CANVAS.brush_ctx.beginPath(),this.CANVAS.brush_ctx.clearRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.brush_ctx.fillRect(0,0,this.axpObj.x_size,this.axpObj.y_size),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.getImage(),0,0),this.CANVAS.draw_ctx.drawImage(this.CANVAS.brush,0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)),this.axpObj.layerSystem.updateCanvas()}rotate90(){const t=this.axpObj.layerSystem.getId();this.axpObj.undoSystem.setUndo({type:"draw",detail:"rotate90",layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(t)]}),this.CANVAS.draw_ctx.putImageData(this.axpObj.layerSystem.getImage(),0,0),this.axpObj.layerSystem.write(this.CANVAS.draw_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size));const e=t=>{let e=t.width,n=t.height,i=0,a=0;e>n?a=Math.trunc((e-n)/2):i=Math.trunc((n-e)/2),e=n=Math.max(e,n);let s=document.createElement("canvas"),r=s.getContext("2d");s.width=e,s.height=n,r.clearRect(0,0,e,n),r.putImageData(t,i,a);let o,l=r.getImageData(0,0,e,n),d=e;for(o=0;o<d/2;++o){let t=o,n=d-1-o;for(let i=t;i<n;i++){let a=n-i+t,s=4*(t*e+i),r=4*(a*e+t),o=4*(n*e+a),d=4*(i*e+n);var c,h,p,u;c=l.data[s+0],h=l.data[s+1],p=l.data[s+2],u=l.data[s+3],l.data[s+0]=l.data[r+0],l.data[s+1]=l.data[r+1],l.data[s+2]=l.data[r+2],l.data[s+3]=l.data[r+3],l.data[r+0]=l.data[o+0],l.data[r+1]=l.data[o+1],l.data[r+2]=l.data[o+2],l.data[r+3]=l.data[o+3],l.data[o+0]=l.data[d+0],l.data[o+1]=l.data[d+1],l.data[o+2]=l.data[d+2],l.data[o+3]=l.data[d+3],l.data[d+0]=c,l.data[d+1]=h,l.data[d+2]=p,l.data[d+3]=u}}r.putImageData(l,0,0),this.axpObj.layerSystem.write(r.getImageData(i,a,t.width,t.height))};this.axpObj.x_size===this.axpObj.y_size?(t=>{let e,n=t.width,i=n;for(e=0;e<i/2;++e){let l=e,d=i-1-e;for(let e=l;e<d;e++){let i=d-e+l,c=4*(l*n+e),h=4*(i*n+l),p=4*(d*n+i),u=4*(e*n+d);var a,s,r,o;a=t.data[c+0],s=t.data[c+1],r=t.data[c+2],o=t.data[c+3],t.data[c+0]=t.data[h+0],t.data[c+1]=t.data[h+1],t.data[c+2]=t.data[h+2],t.data[c+3]=t.data[h+3],t.data[h+0]=t.data[p+0],t.data[h+1]=t.data[p+1],t.data[h+2]=t.data[p+2],t.data[h+3]=t.data[p+3],t.data[p+0]=t.data[u+0],t.data[p+1]=t.data[u+1],t.data[p+2]=t.data[u+2],t.data[p+3]=t.data[u+3],t.data[u+0]=a,t.data[u+1]=s,t.data[u+2]=r,t.data[u+3]=o}}})(this.axpObj.layerSystem.getImage()):e(this.axpObj.layerSystem.getImage()),this.axpObj.layerSystem.updateCanvas()}modeChangeSizeOn(){let t=this.getName();null!==this.getSize()?(this.axpObj.isCHANGE_SIZE_KEY=!0,this.axpObj.msg("[Q]:押している間、その場でペンの太さスライドバーを操作できます。"),document.getElementById("pensize").classList.add("pensize_active")):this.axpObj.msg(`${t}はペンの太さ変更に対応していません。`,"caution")}modeChangeSizeOff(){this.axpObj.isCHANGE_SIZE_KEY&&(this.axpObj.isCHANGE_SIZE_KEY=!1,document.getElementById("pensize").classList.remove("pensize_active")),this.axpObj.msg("")}}n(6025);class T{constructor(t){this.id=t.id,this.index=t.index,this.mode=t.mode,this.alpha=t.alpha,this.checked=t.checked,this.locked=t.locked,this.masked=t.masked,this.name=t.name,this.image=t.image}}class L extends s{layer_counter=0;currentLayer=null;layerObj=[];CANVAS={backscreen_trans:null,backscreen_trans_ctx:null,backscreen_white:null,backscreen_white_ctx:null,tmp:null,tmp_ctx:null,thumbnail_ctx:[],layer_ctx:[]};CONST={LAYER_MAX:8,X_LAYER_MAX:40,Y_LAYER_MAX:40};isLayerboxDrag=!1;imageForUndo;constructor(t){super(t)}getDefaultPosition(){return{left:10,top:340}}init(){this.createHTML("tool_layer","レイヤー","axp-icon-window-layer",'\x3c!-- レイヤーツール --\x3e\r\n<div class="tool_box">\r\n    <select id="layer-mode-select" class="MSG" data-msg="レイヤーの合成モードを変更します。詳細はマニュアルを参照してください。">\r\n        <option value="source-over">通常</option>\r\n        <option value="multiply">乗算</option>\r\n        <option value="screen">スクリーン</option>\r\n        <option value="overlay">オーバーレイ</option>\r\n        <option value="darken">比較（暗）</option>\r\n        <option value="lighten">比較（明）</option>\r\n        <option value="color-dodge">覆い焼き</option>\r\n        <option value="color-burn">焼き込み</option>\r\n        <option value="hard-light">ハードライト</option>\r\n        <option value="soft-light">ソフトライト</option>\r\n        <option value="difference">差の絶対値</option>\r\n        <option value="exclusion">除外</option>\r\n    </select>\r\n    <div style="margin-top:6px;">\r\n        <form oninput="result.value=parseInt(volume.value)" id="range-layer-alpha-value">\r\n            透<input type="range" id="range-layer-alpha" name="volume" value="100" min="0" max="100" step="5" class="MSG"\r\n                data-msg="現在のレイヤーの不透明度を変更します。0を指定すると完全に透明になります。">\r\n            <output class="range_text" name="result" for="volume">100</output>\r\n        </form>\r\n    </div>\r\n    <div>\r\n        <button class="MSG mybutton" data-msg="新しいレイヤーを作成します。（最大８枚まで）" id="button-layer-create">新規</button>\r\n        <button class="MSG mybutton" data-msg="現在のレイヤーと１つ下のレイヤーを統合します。統合後は不透明度が100%に調整されます。"\r\n            id="button-layer-integrate">統</button>\r\n        <button class="MSG mybutton" data-msg="現在のレイヤーのコピーを作成します。" id="button-layer-copy">複</button>\r\n        <button class="MSG mybutton" data-msg="現在のレイヤーを削除します。" id="button-layer-delete">削</button>\r\n        <button class="MSG mybutton" data-msg="現在のレイヤーは残したまま、描画内容だけを消去します。" id="button-layer-clear">C</button>\r\n    </div>\r\n</div>\r\n<ul id="layerbox" class="MSG layerbox" data-msg="描画するレイヤーを選択します。"></ul>'),this.window_width=180,this.CANVAS.backscreen_white=document.createElement("canvas"),this.CANVAS.backscreen_white_ctx=this.CANVAS.backscreen_white.getContext("2d"),this.CANVAS.backscreen_trans=document.createElement("canvas"),this.CANVAS.backscreen_trans_ctx=this.CANVAS.backscreen_trans.getContext("2d"),this.CANVAS.tmp=document.createElement("canvas"),this.CANVAS.tmp_ctx=this.CANVAS.tmp.getContext("2d")}resetCanvas(){this.x_size=this.axpObj.x_size,this.y_size=this.axpObj.y_size,this.CANVAS.backscreen_white.width=this.x_size,this.CANVAS.backscreen_white.height=this.y_size,this.CANVAS.backscreen_trans.width=this.x_size,this.CANVAS.backscreen_trans.height=this.y_size,this.CANVAS.tmp.width=this.x_size,this.CANVAS.tmp.height=this.y_size,this.layer_counter=0,this.currentLayer=null,this.layerObj.splice(0),this.CANVAS.thumbnail_ctx.splice(0),this.axpObj.ENV.multiCanvas&&this.CANVAS.layer_ctx.splice(0);const t=document.getElementById("layerbox");for(;t.firstChild;)t.removeChild(t.firstChild)}startEvent(){document.getElementById("layer-mode-select").addEventListener("change",(t=>{const e=t.target.value;this.setBlendMode(e),this.updateCanvas(),this.axpObj.msg(`${this.getName()}の合成モード：${e}`)})),document.getElementById("range-layer-alpha").addEventListener("input",(t=>{const e=document.getElementById("range-layer-alpha").value;this.setAlpha(e),this.updateCanvas(),this.axpObj.msg(`${this.getName()}の不透明度：${e}`)})),document.getElementById("button-layer-clear").addEventListener("pointerdown",(t=>{this.getLocked()?this.axpObj.msg("ロック状態のレイヤーはクリアできません。","caution"):(this.axpObj.undoSystem.setUndo({type:"layer-clear",layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(this.getId())]}),this.clear(this.getId()),this.updateCanvas(),this.axpObj.msg(`${this.getName()}をクリアしました。`,"information"))})),document.getElementById("button-layer-create").addEventListener("pointerdown",(t=>{if(this.layerObj.length>=this.CONST.LAYER_MAX)this.axpObj.msg(`レイヤーは${this.CONST.LAYER_MAX}枚までです。`,"caution");else{var e=this.createLayer();this.axpObj.msg(`${this.getName()}を作成しました。`,"information"),this.axpObj.undoSystem.setUndo({type:"layer-create",layerObj:this.layerObj[this.getLayerIndex(e)]})}})),document.getElementById("button-layer-copy").addEventListener("pointerdown",(t=>{if(this.layerObj.length>=this.CONST.LAYER_MAX)return void this.axpObj.msg(`レイヤーは${this.CONST.LAYER_MAX}枚までです。`,"caution");const e=this.getId(),n=this.getName();var i=this.createLayer(),a=this.getName();this.getImage().data.set(this.layerObj[this.getLayerIndex(e)].image.data),this.updateCanvas(),this.axpObj.msg(`${n}を複製して、${a}を作成しました。`,"information"),this.axpObj.undoSystem.setUndo({type:"layer-copy",layerObj:this.layerObj[this.getLayerIndex(i)]})})),document.getElementById("button-layer-delete").addEventListener("pointerdown",(t=>{if(this.getLocked())return void this.axpObj.msg("ロック状態のレイヤーは削除できません。","caution");if(this.layerObj.length<=1)return void this.axpObj.msg("レイヤーをすべて削除することはできません。","caution");const e=this.getId(),n=this.getName();this.axpObj.undoSystem.setUndo({type:"layer-delete",layerObj:this.layerObj[this.getLayerIndex(e)]}),this.deleteLayer(e),this.updateCanvas(),this.axpObj.msg(`${n}を削除しました。`,"information")})),document.getElementById("button-layer-integrate").addEventListener("pointerdown",(t=>{var e=this.getLayerIndex(this.currentLayer.dataset.id);if(e>=this.layerObj.length-1)return void this.axpObj.msg("最下層のレイヤーは統合できません。","caution");var n=e+1,i=this.layerObj[n].id,a=this.layerObj[n].name,s=this.layerObj[e].name;if(this.layerObj[e].locked)return void this.axpObj.msg(`${s}がロック状態のため、統合できません。`,"caution");if(this.layerObj[n].locked)return void this.axpObj.msg(`${a}がロック状態のため、統合できません。`,"caution");if(!this.layerObj[e].checked)return void this.axpObj.msg(`${s}が非表示のため、統合できません。`,"caution");if(!this.layerObj[n].checked)return void this.axpObj.msg(`${a}が非表示のため、統合できません。`,"caution");if(0==this.layerObj[e].alpha)return void this.axpObj.msg(`${s}の不透明度が0%のため、統合できません。`,"caution");if(0==this.layerObj[n].alpha)return void this.axpObj.msg(`${a}の不透明度が0%のため、統合できません。`,"caution");this.axpObj.undoSystem.setUndo({type:"layer-integrate",layerObj:this.layerObj[e],layerObj_dest:this.layerObj[n]});let r,o,l=this.axpObj.penSystem.CANVAS.draw,d=this.axpObj.penSystem.CANVAS.draw_ctx;d.clearRect(0,0,l.width,l.height),d.shadowBlur=0,this.axpObj.ENV.multiCanvas?(r=this.CANVAS.layer_ctx[n],o=this.CANVAS.layer_ctx[e]):(r=this.CANVAS.tmp_ctx,o=this.CANVAS.tmp_ctx),o.putImageData(this.layerObj[n].image,0,0),d.globalAlpha=Number(this.layerObj[n].alpha/100),d.globalCompositeOperation="source-over",d.drawImage(o.canvas,0,0),r.putImageData(this.layerObj[e].image,0,0),d.globalAlpha=Number(this.layerObj[e].alpha/100),d.globalCompositeOperation=this.layerObj[e].mode,d.drawImage(r.canvas,0,0),this.layerObj[n].image=d.getImageData(0,0,l.width,l.height),this.layerObj[n].alpha=100,this.deleteLayer(this.getId()),this.updateCanvas();for(var c=document.querySelector(".layerbox").querySelectorAll("li"),h=0;h<c.length;h++)if(Number(c[h].dataset.id)===Number(i)){this.setCurrentLayer(c[h]);break}this.axpObj.msg(`${s}と${a}を統合しました。`,"information")})),document.getElementById("subwindow").onclick=()=>{this.closeRenameLayerWindow()},document.getElementById("subcontent").onclick=t=>{t.stopPropagation()},document.getElementById("textrename").addEventListener("change",(t=>{let e=t.target.value;if(e=e.trim(),""==e)this.axpObj.msg("レイヤー名を空白にすることはできません。","caution");else{this.currentLayer.querySelector("label").textContent=e,this.setName(e),this.axpObj.msg(`レイヤー名を${e}に変更しました。`,"information")}this.closeRenameLayerWindow()}))}deleteLayer(t){for(var e,n,i=document.querySelector(".layerbox").querySelectorAll("li"),a=0;a<i.length;a++)if(i[a].dataset.id==t){e=i[a],n=a;break}n>=1&&n--;var s=this.getLayerIndex(t);this.layerObj.splice(s,1),this.CANVAS.thumbnail_ctx.splice(s,1),this.axpObj.ENV.multiCanvas&&this.CANVAS.layer_ctx.splice(s,1),this.updateLayerIndex(),document.getElementById("layerbox").removeChild(e),i=document.querySelector(".layerbox").querySelectorAll("li");var r=!1;for(a=0;a<i.length;a++)if("true"==i[a].dataset.selected){r=!0;break}r||this.setCurrentLayer(i[n])}clear(t){this.layerObj[this.getLayerIndex(t)].image=this.CANVAS.tmp_ctx.createImageData(this.axpObj.x_size,this.axpObj.y_size)}getLocked(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].locked}getChecked(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].checked}getMasked(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].masked}getAlpha(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].alpha}setAlpha(t){this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].alpha=t}getName(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].name}getMode(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].mode}getId(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].id}getIndex(){let t;return t=null===this.currentLayer?0:this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].index,t}getImage(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image}getCanvasImage(){return this.axpObj.assistToolSystem.getIsTransparent()?this.CANVAS.backscreen_trans_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size):this.CANVAS.backscreen_white_ctx.getImageData(0,0,this.axpObj.x_size,this.axpObj.y_size)}getCanvas(){return this.axpObj.assistToolSystem.getIsTransparent()?this.CANVAS.backscreen_trans:this.CANVAS.backscreen_white}getCurrentLayerImage(){return this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image}write(t){this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image=t}setImageId(t,e){this.layerObj[this.getLayerIndex(e)].image=t}setName(t){this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].name=t}setBlendMode(t){this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].mode=t}setLayerCounter(t){this.layer_counter=t}isWriteProtection(){return!(!this.getLocked()&&this.getChecked()&&0!=this.getAlpha())}save(){this.imageForUndo=this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image}load(){return this.imageForUndo}flip_h(t){if("all"==t)for(const t of this.layerObj)l(t.image);else isNaN(t)?l(this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image):l(this.layerObj[this.getLayerIndex(t)].image);this.draw(),this.drawThumbnail()}flip_v(t){if("all"==t)for(const t of this.layerObj)d(t.image);else isNaN(t)?d(this.layerObj[this.getLayerIndex(this.currentLayer.dataset.id)].image):d(this.layerObj[this.getLayerIndex(t)].image);this.draw(),this.drawThumbnail()}getLayerIndex(t){for(var e=-1,n=0;n<this.layerObj.length;n++)if(this.layerObj[n].id==t){e=n;break}return e}createLayer(t){let e,n={x_size:this.axpObj.x_size,y_size:this.axpObj.y_size};t?(n.id=t.layerObj.id,n.name=t.layerObj.name,n.alpha=t.layerObj.alpha,n.mode=t.layerObj.mode,n.checked=t.layerObj.checked,n.locked=t.layerObj.locked,n.masked=t.layerObj.masked,n.image=t.layerObj.image,e=t.layerObj.index):(this.layer_counter++,n.id=this.layer_counter,n.name="レイヤー"+this.layer_counter,n.alpha=100,n.mode="source-over",n.checked=!0,n.locked=!1,n.masked=!1,n.image=this.CANVAS.tmp_ctx.createImageData(this.axpObj.x_size,this.axpObj.y_size),e=this.getIndex());const i=this.createLayerHTML(n),a=document.getElementById("layerbox");if(a.insertBefore(i,a.children[e]),this.axpObj.ENV.multiCanvas){let t=document.createElement("canvas");t.width=this.x_size,t.height=this.y_size;let n=t.getContext("2d");this.CANVAS.layer_ctx.splice(e,0,n)}let s=document.getElementById("layer_thumbnail"+n.id).getContext("2d");return s.setTransform(1,0,0,1,0,0),s.scale(this.CONST.X_LAYER_MAX/Math.max(this.x_size,this.y_size),this.CONST.X_LAYER_MAX/Math.max(this.x_size,this.y_size)),this.CANVAS.thumbnail_ctx.splice(e,0,s),this.layerObj.splice(e,0,new T(n)),this.updateLayerIndex(),this.setCurrentLayer(i),n.id}createLayerHTML(t){var e=document.createElement("li");e.setAttribute("data-type","drag"),e.setAttribute("data-selected",""),e.setAttribute("data-name","Layer"+t.id),e.setAttribute("data-id",t.id),e.setAttribute("id","layer"+t.id);var n=document.createElement("div");n.setAttribute("class","wrapper wrapper-center-flex"),n.setAttribute("data-type","drag");var i=document.createElement("div");i.setAttribute("class","layercheckboxdiv");var a=document.createElement("div");t.checked?a.setAttribute("class","layercheckbox eye"):a.setAttribute("class","layercheckbox eye_off"),a.setAttribute("data-id",t.id),a.addEventListener("pointerenter",(t=>{var e=t.target.classList.contains("eye")?"表示":"非表示";if(this.axpObj.msg(`レイヤーの表示状態を切り替えます。（現在の状態:${e}）`),"mouse"===t.pointerType&&1===t.buttons&&!this.axpObj.isDrawing){t.target.classList.contains("eye")?(t.target.classList.remove("eye"),t.target.classList.add("eye_off"),this.layerObj[this.getLayerIndex(t.target.dataset.id)].checked=!1):(t.target.classList.remove("eye_off"),t.target.classList.add("eye"),this.layerObj[this.getLayerIndex(t.target.dataset.id)].checked=!0);e=t.target.classList.contains("eye")?"表示":"非表示";this.axpObj.msg(`レイヤーの表示状態を切り替えました。（現在の状態:${e}）`,"information"),this.updateCanvas()}}),!1),a.addEventListener("pointerdown",(t=>{t.stopPropagation(),t.target.classList.contains("eye")?(t.target.classList.remove("eye"),t.target.classList.add("eye_off"),this.layerObj[this.getLayerIndex(t.target.dataset.id)].checked=!1):(t.target.classList.remove("eye_off"),t.target.classList.add("eye"),this.layerObj[this.getLayerIndex(t.target.dataset.id)].checked=!0);var e=t.target.classList.contains("eye")?"表示":"非表示";this.axpObj.msg(`レイヤーの表示状態を切り替えました。（現在の状態:${e}）`,"information"),this.updateCanvas()}),!1);var s=document.createElement("div");t.locked?s.setAttribute("class","layercheckbox2 lock"):s.setAttribute("class","layercheckbox2 lock_off"),s.setAttribute("data-id",t.id),s.addEventListener("pointerenter",(t=>{var e=t.target.classList.contains("lock")?"ロック":"なし";this.axpObj.msg(`レイヤーのロック状態を切り替えます。（現在の状態:${e}）`)}),!1),s.addEventListener("pointerdown",(t=>{t.stopPropagation(),t.target.classList.contains("lock")?(t.target.classList.remove("lock"),t.target.classList.add("lock_off"),this.layerObj[this.getLayerIndex(t.target.dataset.id)].locked=!1):(t.target.classList.remove("lock_off"),t.target.classList.add("lock"),this.layerObj[this.getLayerIndex(t.target.dataset.id)].locked=!0);var e=t.target.classList.contains("lock")?"ロック":"なし";this.axpObj.msg(`レイヤーのロック状態を切り替えました。（現在の状態:${e}）`,"information")}),!1);let r=document.createElement("div");t.masked?r.setAttribute("class","layercheckbox2 mask"):r.setAttribute("class","layercheckbox2 mask_off"),r.setAttribute("data-id",t.id),r.addEventListener("pointerenter",(t=>{var e=t.target.classList.contains("mask")?"ロック":"なし";this.axpObj.msg(`レイヤーの透明部分のロック状態を切り替えます。（現在の状態:${e}）`)}),!1),r.addEventListener("pointerdown",(t=>{t.stopPropagation(),t.target.classList.contains("mask")?(t.target.classList.remove("mask"),t.target.classList.add("mask_off"),this.layerObj[this.getLayerIndex(t.target.dataset.id)].masked=!1):(t.target.classList.remove("mask_off"),t.target.classList.add("mask"),this.layerObj[this.getLayerIndex(t.target.dataset.id)].masked=!0);var e=t.target.classList.contains("mask")?"ロック":"なし";this.axpObj.msg(`レイヤーの透明部分のロック状態を切り替えました。（現在の状態:${e}）`,"information")}),!1);let o=document.createElement("div");o.setAttribute("class","layercheckboxdiv2"),o.appendChild(s),o.appendChild(r),i.appendChild(a),i.appendChild(o);var l=document.createElement("canvas");l.setAttribute("id","layer_thumbnail"+t.id),l.setAttribute("data-type","drag"),l.setAttribute("class","layer_thumbnail"),l.width=this.CONST.X_LAYER_MAX,l.height=this.CONST.Y_LAYER_MAX;var d=document.createElement("label");d.setAttribute("data-type","drag"),d.setAttribute("class","layer_label1"),d.textContent=t.name,n.appendChild(i),n.appendChild(l),n.appendChild(d),e.appendChild(n);return e.addEventListener("pointerdown",(t=>{"drag"===t.target.dataset.type&&this.drag_down(t),this.axpObj.msg("ドラッグで表示順序を入れ替え。枠外にドロップで削除。ダブルクリックでレイヤー名変更。"),this.setCurrentLayer(t.currentTarget)})),e.addEventListener("dblclick",(t=>{"drag"===t.target.dataset.type&&this.openRenameLayerWindow(t)})),e}openRenameLayerWindow(t){const e=this.currentLayer.querySelector("label").textContent,n=document.getElementById("textrename");n.value=e;const i=document.getElementById("subcontent");i.style.marginLeft=t.pageX+"px",i.style.marginTop=t.pageY+"px",this.axpObj.isModalOpen=!0,document.getElementById("subwindow").style.display="block",n.focus(),n.select()}closeRenameLayerWindow(){this.axpObj.isModalOpen=!1,document.getElementById("subwindow").style.display="none"}drag_down(t){const e=t.currentTarget,n=t.pageX,i=t.pageY,a=e.offsetWidth;z.idx_source=V.index(e),z.target=e,z.diffX=n,z.diffY=i,z.ofx=e.offsetLeft,z.ofy=e.offsetTop,z.cloneName=V.insertClone(e,V.index(e)),e.style.width=`${a}px`,e.classList.add("onGrab");const s=new AbortController;window.addEventListener("pointermove",(t=>{const e=z.target,n=t.pageX,i=t.pageY,a=z.ofx+n-z.diffX,s=z.ofy+i-z.diffY;e.style.left=`${a}px`,e.style.top=`${s}px`,V.swap(e)}),{signal:s.signal}),window.addEventListener("pointerup",(t=>{const e=z.target,n=`.${z.cloneName}`,i=document.querySelector(n);if(z.cloneName="",i.remove(),e.removeAttribute("style"),e.classList.remove("onGrab"),e.classList.remove("onDrag"),s.abort(),t.target!==this.axpObj.ELEMENT.view&&t.target!==this.axpObj.CANVAS.main){for(var a=document.querySelector(".layerbox").querySelectorAll("li"),r=0;r<a.length&&a[r].dataset.id!==e.dataset.id;r++);if(r!==z.idx_source){let t=this.layerObj.splice(z.idx_source,1);this.layerObj.splice(r,0,t[0]);let e=this.CANVAS.thumbnail_ctx.splice(z.idx_source,1);if(this.CANVAS.thumbnail_ctx.splice(r,0,e[0]),this.axpObj.ENV.multiCanvas){let t=this.CANVAS.layer_ctx.splice(z.idx_source,1);this.CANVAS.layer_ctx.splice(r,0,t[0])}this.updateLayerIndex(),this.updateCanvas()}}else if("off"===document.getElementById("config_layer_delete").elements.config_layer_delete.value)this.axpObj.msg("枠外ドロップによるレイヤーの削除は設定で無効にされています。","caution");else{var o=document.querySelector(".layerbox").querySelectorAll("li");if(this.getLocked())this.axpObj.msg("ロック状態のレイヤーは削除できません。","caution");else if(o.length<=1)this.axpObj.msg("レイヤーをすべて削除することはできません。","caution");else{const t=this.getId(),e=this.getName();this.axpObj.undoSystem.setUndo({type:"layer-delete",layerObj:this.layerObj[this.getLayerIndex(t)]}),this.deleteLayer(t),this.updateCanvas(),this.axpObj.msg(`${e}を削除しました。`,"information")}}}),{signal:s.signal})}setCurrentLayer(t){const e=document.querySelector(".layerbox").querySelectorAll("li");for(const t of e)t.dataset.selected="";this.currentLayer=t,this.currentLayer.dataset.selected="true";const n=this.getAlpha();document.getElementById("range-layer-alpha").value=n,document.getElementById("range-layer-alpha-value").result.value=n,document.getElementById("layer-mode-select").value=this.getMode()}selectCurrentLayerIndex(t){const e=document.querySelector(".layerbox").querySelectorAll("li");for(const n of e)if(0===t){this.setCurrentLayer(n);break}}updateLayerIndex(){for(let t=0;t<this.layerObj.length;t++)this.layerObj[t].index=t}draw(){let t=this.axpObj.CANVAS.main_ctx;this.CANVAS.backscreen_trans_ctx.beginPath(),this.CANVAS.backscreen_trans_ctx.clearRect(0,0,this.x_size,this.y_size);for(let t=this.layerObj.length-1;t>=0;t--){let e,n=this.layerObj[t];e=this.axpObj.ENV.multiCanvas?this.CANVAS.layer_ctx[t]:this.CANVAS.tmp_ctx,e.putImageData(n.image,0,0),n.checked&&(this.CANVAS.backscreen_trans_ctx.globalCompositeOperation=n.mode,this.CANVAS.backscreen_trans_ctx.globalAlpha=n.alpha/100,this.CANVAS.backscreen_trans_ctx.drawImage(e.canvas,0,0));const i=Math.max(this.axpObj.x_size,this.axpObj.y_size);this.CANVAS.thumbnail_ctx[t].clearRect(0,0,i,i),this.CANVAS.thumbnail_ctx[t].drawImage(e.canvas,this.axpObj.ctx_map_shift_x,this.axpObj.ctx_map_shift_y)}this.CANVAS.backscreen_white_ctx.beginPath(),this.CANVAS.backscreen_white_ctx.clearRect(0,0,this.x_size,this.y_size),this.CANVAS.backscreen_white_ctx.globalAlpha=1,this.CANVAS.backscreen_white_ctx.fillStyle="#ffffff",this.CANVAS.backscreen_white_ctx.fillRect(0,0,this.x_size,this.y_size),this.CANVAS.backscreen_white_ctx.drawImage(this.CANVAS.backscreen_trans,0,0),this.axpObj.assistToolSystem.getIsTransparent()?(t.clearRect(0,0,this.x_size,this.y_size),t.drawImage(this.CANVAS.backscreen_trans,0,0)):t.drawImage(this.CANVAS.backscreen_white,0,0),this.axpObj.isBackgroundimage&&!this.axpObj.isDrawing&&this.axpObj.drawBackground()}drawThumbnail(){let t=this.axpObj.assistToolSystem.CANVAS.thumbnail_ctx;t.beginPath(),t.globalAlpha=1,t.fillStyle="#777777",t.fillRect(0,0,this.axpObj.CONST.CANVAS_X_MAX,this.axpObj.CONST.CANVAS_Y_MAX),t.clearRect(this.axpObj.ctx_map_shift_x,this.axpObj.ctx_map_shift_y,this.x_size,this.y_size),this.axpObj.assistToolSystem.getIsTransparent()?t.drawImage(this.CANVAS.backscreen_trans,this.axpObj.ctx_map_shift_x,this.axpObj.ctx_map_shift_y):t.drawImage(this.CANVAS.backscreen_white,this.axpObj.ctx_map_shift_x,this.axpObj.ctx_map_shift_y)}updateCanvas(){this.draw(),this.drawThumbnail()}downloadImage(){let t=document.createElement("a");this.axpObj.assistToolSystem.getIsTransparent()?t.href=this.CANVAS.backscreen_trans.toDataURL("image/png"):t.href=this.CANVAS.backscreen_white.toDataURL("image/png");let e="ap"+g(new Date,"YYYYMMDD_hhmmss")+".png";t.download=e,t.click()}}let z={target:null,diffX:0,diffY:0,ofx:0,ofy:0,idx_source:null};const V={index(t){const e=t.parentElement.children;return[].slice.call(e).indexOf(t)},insertClone(t,e){const n=`ddItemClone_${Math.trunc(1e4*Math.random())}`,i=t.cloneNode(!0),a=t.parentElement.children;return i.classList.add("hidden"),i.classList.add(n),a[e].insertAdjacentElement("afterend",i),n},swap(t){const e=V.index(t),n=e+1,i=t.parentElement,a=i.querySelectorAll(`:scope > *:not(.onGrab):not(.${z.cloneName})`);for(let s=0,r=a.length;s<r;s++){const r=t.offsetWidth,o=t.offsetHeight,l=t.getBoundingClientRect(),d=l.left,c=l.top,h=a[s],p=h.offsetWidth,u=h.offsetHeight,g=h.getBoundingClientRect(),m=g.left,b=g.top+u/2;if(m<=d+r&&m+p>=d&&(c<=b&&c+o>=b)){const a=i.children[n];i.insertBefore(a,e>s?h:h.nextSibling),i.insertBefore(t,a);break}}}};n(9756);const R=["#000000","#333333","#777777","#cccccc","#32486f","#1b25b5","#ba09ba","#ff3bde","#0cc3e8","#852f04","#b80410","#d12c2c","#e88460","#ff8b1f","#56bc9d","#0fc23c","#87ee6d","#ffff47","#fffcb4","#ffc076","#ffc4b5","#ffe4d6","#fff5df","#ffffff"];class P extends s{CONST={COLOR_MAX:50};currentPalette={column:5,side:!1,height:0,palette:[]};isEditMode=!1;elementCurrentPalette;elementPaletteBox;constructor(t){super(t)}getDefaultPosition(){return{left:this.axpObj.paintBodyElement.clientWidth-this.window_width-10,top:250}}init(){this.createHTML("tool_palette","パレット","axp-icon-window-palette",'\x3c!-- axp-palette --\x3e\r\n\x3c!-- カラーパレット --\x3e\r\n<div class="tool_box">\r\n\r\n    \x3c!-- パレット操作ボタン（更新、登録、削除 --\x3e\r\n    <div>\r\n        <button id="button_palette_sorting" class="MSG mybutton size_80 displaynone"\r\n            data-msg="パレットの更新／位置入れ替え／削除を行うモードに切り替えます。">ﾊﾟﾚｯﾄ編集</button>\r\n        <button id="button_palette_delete" class="MSG mybutton size_80 displaynone"\r\n            data-msg="選択しているパレットを削除します。">削除</button>\r\n\r\n    </div>\r\n\r\n    <div id="palette_container">\r\n        <div id="palette_button_box">\r\n            <div id="palette_edit" class="MSG mybutton" data-msg="パレットの更新／位置入れ替え／削除を行うモードに切り替えます。">編</div>\r\n            <div id="palette_delete" class="MSG mybutton displaynone" data-msg="選択しているパレットを削除します。">削</div>\r\n        </div>\r\n        \x3c!-- カラーパレットを表示するためのエリア --\x3e\r\n        <div id="palette_box"></div>\r\n    </div>\r\n\r\n\r\n</div>'),this.window_width=110,this.elementPaletteBox=document.getElementById("palette_box"),this.setPaletteArray()}startEvent(){document.getElementById("palette_edit").onclick=t=>{let e;this.isEditMode||(this.axpObj.colorMakerSystem.setMainColor(this.getColor()),this.axpObj.penSystem.previewPenSize()),this.isEditMode=!this.isEditMode,this.isEditMode?(document.getElementById("palette_edit").dataset.selected="true",document.getElementById("palette_delete").classList.remove("displaynone"),document.getElementById("tool_palette").classList.add("attention"),e="パレット編集モードに切り替えました。（パレットの更新／位置入れ替え／削除が行えます）"):(document.getElementById("palette_delete").classList.add("displaynone"),document.getElementById("palette_edit").dataset.selected="false",document.getElementById("tool_palette").classList.remove("attention"),e="パレット編集モードを解除しました。"),this.axpObj.msg(e,"information")};document.getElementById("palette_delete").onclick=t=>{if(this.currentPalette.palette.length<=1)return void this.axpObj.msg("すべてのパレットを削除することはできません。","caution");let e;for(e=0;e<this.elementPaletteBox.childElementCount&&this.elementPaletteBox.children[e]!==this.elementCurrentPalette;e++);this.currentPalette.palette.splice(e,1),this.axpObj.saveSystem.save_palette(this.currentPalette.palette),this.elementPaletteBox.removeChild(this.elementCurrentPalette),e===this.elementPaletteBox.childElementCount&&e--,this.elementCurrentPalette=this.elementPaletteBox.children[e],this.elementCurrentPalette.dataset.selected="true";let n=this.elementCurrentPalette.dataset.color;this.axpObj.colorMakerSystem.setMainColor(n),this.axpObj.penSystem.previewPenSize(),this.axpObj.msg("カラーパレットを削除しました。","information")},this.resizeObserver=new ResizeObserver((t=>{this.axpObj.isResizePalette&&this.resizePalette()})),this.resizeObserver.observe(document.getElementById("palette_box")),this.currentPalette.height=document.getElementById("palette_box").clientHeight,document.getElementById("tool_palette").addEventListener("pointerdown",(t=>{t.target.classList.contains("minimize")||(this.axpObj.isResizePalette=!0)})),window.addEventListener("pointerup",(t=>{if(this.axpObj.isResizePalette){this.axpObj.isResizePalette=!1;let t=document.getElementById("palette_box").clientHeight,e=document.getElementById("tool_palette"),n=e.getBoundingClientRect().top,i=this.axpObj.ELEMENT.base.clientHeight-n+24;e.style.height=i<t?i+"px":"auto",this.calcWidth()}}))}resizePalette(){if(this.isEditMode)return;let t=document.getElementById("palette_box"),e=t.clientWidth,n=t.clientHeight,i=document.getElementById("palette_container"),a=document.getElementById("palette_button_box");this.currentPalette.height!==n&&(this.currentPalette.side?e<n&&(i.style.flexDirection="column",a.style.width="100%",this.currentPalette.side=!1,this.axpObj.configSystem.saveConfig("window_sidebutton",this.currentPalette.side)):e-32>n&&(i.style.flexDirection="row",a.style.width="32px",this.currentPalette.side=!0,this.axpObj.configSystem.saveConfig("window_sidebutton",this.currentPalette.side)),n=t.clientHeight,this.currentPalette.height=n)}calcWidth(){let t=document.getElementById("palette_box"),e=(t.clientHeight,t.clientWidth),n=Math.min(Math.trunc(e/32),this.currentPalette.palette.length);this.currentPalette.column=n;let i=document.getElementById("tool_palette"),a=(i.clientWidth,32*n+14);this.currentPalette.side&&(a+=32),i.style.width=a+"px",this.axpObj.configSystem.saveConfig("window_palette_column",n)}drag_down(t){const e=t.currentTarget,n=t.pageX,i=t.pageY;G.idx_source=D.index(e),G.target=e,G.diffX=n,G.diffY=i,G.ofx=e.offsetLeft,G.ofy=e.offsetTop;const a=G.ofx,s=G.ofy;e.style.left=`${a}px`,e.style.top=`${s}px`,G.cloneName=D.insertClone(e,D.index(e)),e.classList.add("onGrab");const r=new AbortController;window.addEventListener("pointermove",(t=>{const e=G.target,n=t.pageX,i=t.pageY,a=G.ofx+n-G.diffX,s=G.ofy+i-G.diffY;e.style.left=`${a}px`,e.style.top=`${s}px`,D.swap(e)}),{signal:r.signal}),window.addEventListener("pointerup",(t=>{const e=G.target,n=`.${G.cloneName}`,i=document.querySelector(n);if(G.cloneName="",i.remove(),e.classList.remove("onGrab"),r.abort(),G.idx_dest=D.index(e),G.idx_source!==G.idx_dest){const t=this.currentPalette.palette[G.idx_source];this.currentPalette.palette.splice(G.idx_source,1),this.currentPalette.palette.splice(G.idx_dest,0,t),this.axpObj.saveSystem.save_palette(this.currentPalette.palette)}}),{signal:r.signal})}getColor(t){return t?this.currentPalette.palette[t]:this.elementCurrentPalette.dataset.color}setColor(t){if(!this.isEditMode)return;let e;for(e=0;e<this.elementPaletteBox.childElementCount&&this.elementPaletteBox.children[e]!==this.elementCurrentPalette;e++);this.elementCurrentPalette.style.backgroundColor=t,this.elementCurrentPalette.dataset.color=t,this.currentPalette.palette[e]=t,this.axpObj.saveSystem.save_palette(this.currentPalette.palette)}setPaletteArray(t){if(void 0===t&&(t=R,this.currentPalette.column=3,this.currentPalette.side=!1),t.length>this.CONST.COLOR_MAX)throw new Error("colorPalette MAX over");for(let e=0;e<t.length;e++)"#"!==t[e].substring(0,1)&&(t[e]="#"+t[e]);this.currentPalette.palette.splice(0);for(let e of t)this.currentPalette.palette.push(e)}addPalette(t){if(this.currentPalette.palette.length>=this.CONST.COLOR_MAX)return{isSucceed:!1,msg:`登録できるパレット数は${this.CONST.COLOR_MAX}個までです。`};var e=document.getElementById("palette_box");return this.elementCurrentPalette.dataset.selected="",this.elementCurrentPalette=e.appendChild(this.createPaletteHTML(t)),this.elementCurrentPalette.dataset.selected="true",this.currentPalette.palette.push(t),this.axpObj.saveSystem.save_palette(this.currentPalette.palette),{isSucceed:!0}}createPalette(){for(;this.elementPaletteBox.firstChild;)this.elementPaletteBox.removeChild(this.elementPaletteBox.firstChild);for(const t of this.currentPalette.palette)this.elementPaletteBox.appendChild(this.createPaletteHTML(t));this.elementCurrentPalette=document.querySelector("#palette_box :first-child"),this.elementCurrentPalette.dataset.selected="true";let t=document.getElementById("tool_palette"),e=document.getElementById("palette_container"),n=document.getElementById("palette_button_box"),i=Math.ceil(this.currentPalette.palette.length/this.currentPalette.column);this.currentPalette.side?(e.style.flexDirection="row",n.style.width="32px"):(e.style.flexDirection="column",n.style.width="100%");let a=32*this.currentPalette.column+14;this.currentPalette.side&&(a+=32),t.style.width=a+"px",t.style.height="auto",this.currentPalette.height=32*i}createPaletteHTML(t){var e=document.createElement("div");return e.setAttribute("class","coloricon"),e.dataset.color=t,e.style.backgroundColor=t,e.addEventListener("pointerenter",(t=>{let e;e=this.isEditMode?"[編集モード] ドラッグで位置を入れ替え。カラーツール操作で選択中パレットの色を更新。":`メインカラーを指定色に変更します。（${r(t.target.dataset.color)}）`,this.axpObj.msg(e)})),e.addEventListener("pointerdown",(t=>{var e=t.target.dataset.color;this.isEditMode&&this.drag_down(t),"true"===document.getElementById("color_transparent").dataset.selected&&(document.getElementById("color_main").dataset.selected="true",document.getElementById("color_transparent").dataset.selected="false"),this.elementCurrentPalette.dataset.selected="",this.elementCurrentPalette=t.target,this.elementCurrentPalette.dataset.selected="true",this.axpObj.penSystem.setBrightness(0),this.axpObj.colorMakerSystem.setMainColor(e),this.axpObj.penSystem.changePenMode(),this.axpObj.msg(`RGB: (${r(e)})`)})),e}getPaletteLength(){return this.currentPalette.palette.length}getPalette(){return this.currentPalette.palette}}const D={index(t){const e=t.parentElement.children;return[].slice.call(e).indexOf(t)},insertClone(t,e){const n=`ddItemClone_${Math.trunc(1e4*Math.random())}`,i=t.cloneNode(!0),a=t.parentElement.children;return i.classList.add("hidden"),i.classList.add(n),a[e].insertAdjacentElement("afterend",i),n},swap(t){const e=D.index(t),n=e+1,i=t.parentElement,a=i.querySelectorAll(`:scope > *:not(.onGrab):not(.${G.cloneName})`);for(let s=0,r=a.length;s<r;s++){const r=t.offsetWidth,o=t.offsetHeight,l=t.getBoundingClientRect(),d=l.left,c=l.top,h=a[s],p=h.offsetWidth,u=h.offsetHeight,g=h.getBoundingClientRect(),m=g.left+p/2,b=g.top+u/2;if(d<=m&&d+r>=m&&(c<=b&&c+o>=b)){const a=i.children[n];i.insertBefore(a,e>s?h:h.nextSibling),i.insertBefore(t,a);break}}}};let G={target:null,diffX:0,diffY:0,ofx:0,ofy:0,idx_source:null,idx_dest:null};var U,W,X,Y,F,H={},K=[],Z=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function q(t,e){for(var n in e)t[n]=e[n];return t}function Q(t){var e=t.parentNode;e&&e.removeChild(t)}function J(t,e,n){var i,a,s,r,o=arguments;if(e=q({},e),arguments.length>3)for(n=[n],i=3;i<arguments.length;i++)n.push(o[i]);if(null!=n&&(e.children=n),null!=t&&null!=t.defaultProps)for(a in t.defaultProps)void 0===e[a]&&(e[a]=t.defaultProps[a]);return r=e.key,null!=(s=e.ref)&&delete e.ref,null!=r&&delete e.key,$(t,e,r,s)}function $(t,e,n,i){var a={type:t,props:e,key:n,ref:i,__k:null,__p:null,__b:0,__e:null,l:null,__c:null,constructor:void 0};return U.vnode&&U.vnode(a),a}function tt(t){return t.children}function et(t,e){this.props=t,this.context=e}function nt(t,e){if(null==e)return t.__p?nt(t.__p,t.__p.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?nt(t):null}function it(t){var e,n;if(null!=(t=t.__p)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return it(t)}}function at(t){(!t.__d&&(t.__d=!0)&&1===W.push(t)||Y!==U.debounceRendering)&&(Y=U.debounceRendering,(U.debounceRendering||X)(st))}function st(){var t,e,n,i,a,s,r,o;for(W.sort((function(t,e){return e.__v.__b-t.__v.__b}));t=W.pop();)t.__d&&(n=void 0,i=void 0,s=(a=(e=t).__v).__e,r=e.__P,o=e.u,e.u=!1,r&&(n=[],i=ht(r,a,q({},a),e.__n,void 0!==r.ownerSVGElement,null,n,o,null==s?nt(a):s),pt(n,a),i!=s&&it(a)))}function rt(t,e,n,i,a,s,r,o,l){var d,c,h,p,u,g,m,b=n&&n.__k||K,x=b.length;if(o==H&&(o=null!=s?s[0]:x?nt(n,0):null),d=0,e.__k=ot(e.__k,(function(n){if(null!=n){if(n.__p=e,n.__b=e.__b+1,null===(h=b[d])||h&&n.key==h.key&&n.type===h.type)b[d]=void 0;else for(c=0;c<x;c++){if((h=b[c])&&n.key==h.key&&n.type===h.type){b[c]=void 0;break}h=null}if(p=ht(t,n,h=h||H,i,a,s,r,null,o,l),(c=n.ref)&&h.ref!=c&&(m||(m=[])).push(c,n.__c||p,n),null!=p){if(null==g&&(g=p),null!=n.l)p=n.l,n.l=null;else if(s==h||p!=o||null==p.parentNode){t:if(null==o||o.parentNode!==t)t.appendChild(p);else{for(u=o,c=0;(u=u.nextSibling)&&c<x;c+=2)if(u==p)break t;t.insertBefore(p,o)}"option"==e.type&&(t.value="")}o=p.nextSibling,"function"==typeof e.type&&(e.l=p)}}return d++,n})),e.__e=g,null!=s&&"function"!=typeof e.type)for(d=s.length;d--;)null!=s[d]&&Q(s[d]);for(d=x;d--;)null!=b[d]&&mt(b[d],b[d]);if(m)for(d=0;d<m.length;d++)gt(m[d],m[++d],m[++d])}function ot(t,e,n){if(null==n&&(n=[]),null==t||"boolean"==typeof t)e&&n.push(e(null));else if(Array.isArray(t))for(var i=0;i<t.length;i++)ot(t[i],e,n);else n.push(e?e(function(t){if(null==t||"boolean"==typeof t)return null;if("string"==typeof t||"number"==typeof t)return $(null,t,null,null);if(null!=t.__e||null!=t.__c){var e=$(t.type,t.props,t.key,null);return e.__e=t.__e,e}return t}(t)):t);return n}function lt(t,e,n){"-"===e[0]?t.setProperty(e,n):t[e]="number"==typeof n&&!1===Z.test(e)?n+"px":null==n?"":n}function dt(t,e,n,i,a){var s,r,o,l,d;if("key"===(e=a?"className"===e?"class":e:"class"===e?"className":e)||"children"===e);else if("style"===e)if(s=t.style,"string"==typeof n)s.cssText=n;else{if("string"==typeof i&&(s.cssText="",i=null),i)for(r in i)n&&r in n||lt(s,r,"");if(n)for(o in n)i&&n[o]===i[o]||lt(s,o,n[o])}else"o"===e[0]&&"n"===e[1]?(l=e!==(e=e.replace(/Capture$/,"")),d=e.toLowerCase(),e=(d in t?d:e).slice(2),n?(i||t.addEventListener(e,ct,l),(t.t||(t.t={}))[e]=n):t.removeEventListener(e,ct,l)):"list"!==e&&"tagName"!==e&&"form"!==e&&!a&&e in t?t[e]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==e&&(e!==(e=e.replace(/^xlink:?/,""))?null==n||!1===n?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):null==n||!1===n?t.removeAttribute(e):t.setAttribute(e,n))}function ct(t){return this.t[t.type](U.event?U.event(t):t)}function ht(t,e,n,i,a,s,r,o,l,d){var c,h,p,u,g,m,b,x,y,_,A=e.type;if(void 0!==e.constructor)return null;(c=U.__b)&&c(e);try{t:if("function"==typeof A){if(x=e.props,y=(c=A.contextType)&&i[c.__c],_=c?y?y.props.value:c.__p:i,n.__c?b=(h=e.__c=n.__c).__p=h.__E:("prototype"in A&&A.prototype.render?e.__c=h=new A(x,_):(e.__c=h=new et(x,_),h.constructor=A,h.render=bt),y&&y.sub(h),h.props=x,h.state||(h.state={}),h.context=_,h.__n=i,p=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=A.getDerivedStateFromProps&&q(h.__s==h.state?h.__s=q({},h.__s):h.__s,A.getDerivedStateFromProps(x,h.__s)),p)null==A.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&r.push(h);else{if(null==A.getDerivedStateFromProps&&null==o&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(x,_),!o&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(x,h.__s,_)){for(h.props=x,h.state=h.__s,h.__d=!1,h.__v=e,e.__e=null!=l?l!==n.__e?l:n.__e:null,e.__k=n.__k,c=0;c<e.__k.length;c++)e.__k[c]&&(e.__k[c].__p=e);break t}null!=h.componentWillUpdate&&h.componentWillUpdate(x,h.__s,_)}for(u=h.props,g=h.state,h.context=_,h.props=x,h.state=h.__s,(c=U.__r)&&c(e),h.__d=!1,h.__v=e,h.__P=t,c=h.render(h.props,h.state,h.context),e.__k=ot(null!=c&&c.type==tt&&null==c.key?c.props.children:c),null!=h.getChildContext&&(i=q(q({},i),h.getChildContext())),p||null==h.getSnapshotBeforeUpdate||(m=h.getSnapshotBeforeUpdate(u,g)),rt(t,e,n,i,a,s,r,l,d),h.base=e.__e;c=h.__h.pop();)h.__s&&(h.state=h.__s),c.call(h);p||null==u||null==h.componentDidUpdate||h.componentDidUpdate(u,g,m),b&&(h.__E=h.__p=null)}else e.__e=ut(n.__e,e,n,i,a,s,r,d);(c=U.diffed)&&c(e)}catch(t){U.__e(t,e,n)}return e.__e}function pt(t,e){for(var n;n=t.pop();)try{n.componentDidMount()}catch(t){U.__e(t,n.__v)}U.__c&&U.__c(e)}function ut(t,e,n,i,a,s,r,o){var l,d,c,h,p=n.props,u=e.props;if(a="svg"===e.type||a,null==t&&null!=s)for(l=0;l<s.length;l++)if(null!=(d=s[l])&&(null===e.type?3===d.nodeType:d.localName===e.type)){t=d,s[l]=null;break}if(null==t){if(null===e.type)return document.createTextNode(u);t=a?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type),s=null}return null===e.type?p!==u&&(null!=s&&(s[s.indexOf(t)]=null),t.data=u):e!==n&&(null!=s&&(s=K.slice.call(t.childNodes)),c=(p=n.props||H).dangerouslySetInnerHTML,h=u.dangerouslySetInnerHTML,o||(h||c)&&(h&&c&&h.__html==c.__html||(t.innerHTML=h&&h.__html||"")),function(t,e,n,i,a){var s;for(s in n)s in e||dt(t,s,null,n[s],i);for(s in e)a&&"function"!=typeof e[s]||"value"===s||"checked"===s||n[s]===e[s]||dt(t,s,e[s],n[s],i)}(t,u,p,a,o),e.__k=e.props.children,h||rt(t,e,n,i,"foreignObject"!==e.type&&a,s,r,H,o),o||("value"in u&&void 0!==u.value&&u.value!==t.value&&(t.value=null==u.value?"":u.value),"checked"in u&&void 0!==u.checked&&u.checked!==t.checked&&(t.checked=u.checked))),t}function gt(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(t){U.__e(t,n)}}function mt(t,e,n){var i,a,s;if(U.unmount&&U.unmount(t),(i=t.ref)&&gt(i,null,e),n||"function"==typeof t.type||(n=null!=(a=t.__e)),t.__e=t.l=null,null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(t){U.__e(t,e)}i.base=i.__P=null}if(i=t.__k)for(s=0;s<i.length;s++)i[s]&&mt(i[s],e,n);null!=a&&Q(a)}function bt(t,e,n){return this.constructor(t,n)}function xt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function yt(){return yt=Object.assign||function(t){for(var e=arguments,n=1;n<arguments.length;n++){var i=e[n];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t},yt.apply(this,arguments)}U={},et.prototype.setState=function(t,e){var n=this.__s!==this.state&&this.__s||(this.__s=q({},this.state));("function"!=typeof t||(t=t(n,this.props)))&&q(n,t),null!=t&&this.__v&&(this.u=!1,e&&this.__h.push(e),at(this))},et.prototype.forceUpdate=function(t){this.__v&&(t&&this.__h.push(t),this.u=!0,at(this))},et.prototype.render=tt,W=[],X="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Y=U.debounceRendering,U.__e=function(t,e,n){for(var i;e=e.__p;)if((i=e.__c)&&!i.__p)try{if(i.constructor&&null!=i.constructor.getDerivedStateFromError)i.setState(i.constructor.getDerivedStateFromError(t));else{if(null==i.componentDidCatch)continue;i.componentDidCatch(t)}return at(i.__E=i)}catch(e){t=e}throw t},F=H;var _t="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",At="[\\s|\\(]+("+_t+")[,|\\s]+("+_t+")[,|\\s]+("+_t+")\\s*\\)?",ft="[\\s|\\(]+("+_t+")[,|\\s]+("+_t+")[,|\\s]+("+_t+")[,|\\s]+("+_t+")\\s*\\)?",vt=new RegExp("rgb"+At),St=new RegExp("rgba"+ft),Ot=new RegExp("hsl"+At),wt=new RegExp("hsla"+ft),Et="^(?:#?|0x?)",Ct="([0-9a-fA-F]{1})",jt="([0-9a-fA-F]{2})",kt=new RegExp(Et+Ct+Ct+Ct+"$"),It=new RegExp(Et+Ct+Ct+Ct+Ct+"$"),Nt=new RegExp(Et+jt+jt+jt+"$"),Bt=new RegExp(Et+jt+jt+jt+jt+"$"),Mt=Math.log,Tt=Math.round,Lt=Math.floor;function zt(t,e,n){return Math.min(Math.max(t,e),n)}function Vt(t,e){var n=t.indexOf("%")>-1,i=parseFloat(t);return n?e/100*i:i}function Rt(t){return parseInt(t,16)}function Pt(t){return t.toString(16).padStart(2,"0")}var Dt=function(){function t(t,e){this.$={h:0,s:0,v:0,a:1},t&&this.set(t),this.onChange=e,this.initialValue=yt({},this.$)}var e,n,i,a=t.prototype;return a.set=function(e){if("string"==typeof e)/^(?:#?|0x?)[0-9a-fA-F]{3,8}$/.test(e)?this.hexString=e:/^rgba?/.test(e)?this.rgbString=e:/^hsla?/.test(e)&&(this.hslString=e);else{if("object"!=typeof e)throw new Error("Invalid color value");e instanceof t?this.hsva=e.hsva:"r"in e&&"g"in e&&"b"in e?this.rgb=e:"h"in e&&"s"in e&&"v"in e?this.hsv=e:"h"in e&&"s"in e&&"l"in e?this.hsl=e:"kelvin"in e&&(this.kelvin=e.kelvin)}},a.setChannel=function(t,e,n){var i;this[t]=yt({},this[t],((i={})[e]=n,i))},a.reset=function(){this.hsva=this.initialValue},a.clone=function(){return new t(this)},a.unbind=function(){this.onChange=void 0},t.hsvToRgb=function(t){var e=t.h/60,n=t.s/100,i=t.v/100,a=Lt(e),s=e-a,r=i*(1-n),o=i*(1-s*n),l=i*(1-(1-s)*n),d=a%6,c=[l,i,i,o,r,r][d],h=[r,r,l,i,i,o][d];return{r:zt(255*[i,o,r,r,l,i][d],0,255),g:zt(255*c,0,255),b:zt(255*h,0,255)}},t.rgbToHsv=function(t){var e=t.r/255,n=t.g/255,i=t.b/255,a=Math.max(e,n,i),s=Math.min(e,n,i),r=a-s,o=0,l=a,d=0===a?0:r/a;switch(a){case s:o=0;break;case e:o=(n-i)/r+(n<i?6:0);break;case n:o=(i-e)/r+2;break;case i:o=(e-n)/r+4}return{h:60*o%360,s:zt(100*d,0,100),v:zt(100*l,0,100)}},t.hsvToHsl=function(t){var e=t.s/100,n=t.v/100,i=(2-e)*n,a=i<=1?i:2-i,s=a<1e-9?0:e*n/a;return{h:t.h,s:zt(100*s,0,100),l:zt(50*i,0,100)}},t.hslToHsv=function(t){var e=2*t.l,n=t.s*(e<=100?e:200-e)/100,i=e+n<1e-9?0:2*n/(e+n);return{h:t.h,s:zt(100*i,0,100),v:zt((e+n)/2,0,100)}},t.kelvinToRgb=function(t){var e,n,i,a=t/100;return a<66?(e=255,n=-155.25485562709179-.44596950469579133*(n=a-2)+104.49216199393888*Mt(n),i=a<20?0:.8274096064007395*(i=a-10)-254.76935184120902+115.67994401066147*Mt(i)):(e=351.97690566805693+.114206453784165*(e=a-55)-40.25366309332127*Mt(e),n=325.4494125711974+.07943456536662342*(n=a-50)-28.0852963507957*Mt(n),i=255),{r:zt(Lt(e),0,255),g:zt(Lt(n),0,255),b:zt(Lt(i),0,255)}},t.rgbToKelvin=function(e){for(var n,i=e.r,a=e.b,s=2e3,r=4e4;r-s>.4;){n=.5*(r+s);var o=t.kelvinToRgb(n);o.b/o.r>=a/i?r=n:s=n}return n},e=t,n=[{key:"hsv",get:function(){var t=this.$;return{h:t.h,s:t.s,v:t.v}},set:function(t){var e=this.$;if(t=yt({},e,t),this.onChange){var n={h:!1,v:!1,s:!1,a:!1};for(var i in e)n[i]=t[i]!=e[i];this.$=t,(n.h||n.s||n.v||n.a)&&this.onChange(this,n)}else this.$=t}},{key:"hsva",get:function(){return yt({},this.$)},set:function(t){this.hsv=t}},{key:"hue",get:function(){return this.$.h},set:function(t){this.hsv={h:t}}},{key:"saturation",get:function(){return this.$.s},set:function(t){this.hsv={s:t}}},{key:"value",get:function(){return this.$.v},set:function(t){this.hsv={v:t}}},{key:"alpha",get:function(){return this.$.a},set:function(t){this.hsv=yt({},this.hsv,{a:t})}},{key:"kelvin",get:function(){return t.rgbToKelvin(this.rgb)},set:function(e){this.rgb=t.kelvinToRgb(e)}},{key:"red",get:function(){return this.rgb.r},set:function(t){this.rgb=yt({},this.rgb,{r:t})}},{key:"green",get:function(){return this.rgb.g},set:function(t){this.rgb=yt({},this.rgb,{g:t})}},{key:"blue",get:function(){return this.rgb.b},set:function(t){this.rgb=yt({},this.rgb,{b:t})}},{key:"rgb",get:function(){var e=t.hsvToRgb(this.$),n=e.r,i=e.g,a=e.b;return{r:Tt(n),g:Tt(i),b:Tt(a)}},set:function(e){this.hsv=yt({},t.rgbToHsv(e),{a:void 0===e.a?1:e.a})}},{key:"rgba",get:function(){return yt({},this.rgb,{a:this.alpha})},set:function(t){this.rgb=t}},{key:"hsl",get:function(){var e=t.hsvToHsl(this.$),n=e.h,i=e.s,a=e.l;return{h:Tt(n),s:Tt(i),l:Tt(a)}},set:function(e){this.hsv=yt({},t.hslToHsv(e),{a:void 0===e.a?1:e.a})}},{key:"hsla",get:function(){return yt({},this.hsl,{a:this.alpha})},set:function(t){this.hsl=t}},{key:"rgbString",get:function(){var t=this.rgb;return"rgb("+t.r+", "+t.g+", "+t.b+")"},set:function(t){var e,n,i,a,s=1;if((e=vt.exec(t))?(n=Vt(e[1],255),i=Vt(e[2],255),a=Vt(e[3],255)):(e=St.exec(t))&&(n=Vt(e[1],255),i=Vt(e[2],255),a=Vt(e[3],255),s=Vt(e[4],1)),!e)throw new Error("Invalid rgb string");this.rgb={r:n,g:i,b:a,a:s}}},{key:"rgbaString",get:function(){var t=this.rgba;return"rgba("+t.r+", "+t.g+", "+t.b+", "+t.a+")"},set:function(t){this.rgbString=t}},{key:"hexString",get:function(){var t=this.rgb;return"#"+Pt(t.r)+Pt(t.g)+Pt(t.b)},set:function(t){var e,n,i,a,s=255;if((e=kt.exec(t))?(n=17*Rt(e[1]),i=17*Rt(e[2]),a=17*Rt(e[3])):(e=It.exec(t))?(n=17*Rt(e[1]),i=17*Rt(e[2]),a=17*Rt(e[3]),s=17*Rt(e[4])):(e=Nt.exec(t))?(n=Rt(e[1]),i=Rt(e[2]),a=Rt(e[3])):(e=Bt.exec(t))&&(n=Rt(e[1]),i=Rt(e[2]),a=Rt(e[3]),s=Rt(e[4])),!e)throw new Error("Invalid hex string");this.rgb={r:n,g:i,b:a,a:s/255}}},{key:"hex8String",get:function(){var t=this.rgba;return"#"+Pt(t.r)+Pt(t.g)+Pt(t.b)+Pt(Lt(255*t.a))},set:function(t){this.hexString=t}},{key:"hslString",get:function(){var t=this.hsl;return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},set:function(t){var e,n,i,a,s=1;if((e=Ot.exec(t))?(n=Vt(e[1],360),i=Vt(e[2],100),a=Vt(e[3],100)):(e=wt.exec(t))&&(n=Vt(e[1],360),i=Vt(e[2],100),a=Vt(e[3],100),s=Vt(e[4],1)),!e)throw new Error("Invalid hsl string");this.hsl={h:n,s:i,l:a,a:s}}},{key:"hslaString",get:function(){var t=this.hsla;return"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},set:function(t){this.hslString=t}}],n&&xt(e.prototype,n),i&&xt(e,i),t}();function Gt(t){var e,n=t.width,i=t.sliderSize,a=t.borderWidth,s=t.handleRadius,r=t.padding,o=t.sliderShape,l="horizontal"===t.layoutDirection;return i=null!=(e=i)?e:2*r+2*s,"circle"===o?{handleStart:t.padding+t.handleRadius,handleRange:n-2*r-2*s,width:n,height:n,cx:n/2,cy:n/2,radius:n/2-a/2}:{handleStart:i/2,handleRange:n-i,radius:i/2,x:0,y:0,width:l?i:n,height:l?n:i}}function Ut(t,e){var n=Gt(t),i=n.width,a=n.height,s=n.handleRange,r=n.handleStart,o="horizontal"===t.layoutDirection,l=function(t,e){var n=e.hsva,i=e.rgb;switch(t.sliderType){case"red":return i.r/2.55;case"green":return i.g/2.55;case"blue":return i.b/2.55;case"alpha":return 100*n.a;case"kelvin":var a=t.minTemperature,s=t.maxTemperature-a,r=(e.kelvin-a)/s*100;return Math.max(0,Math.min(r,100));case"hue":return n.h/=3.6;case"saturation":return n.s;default:return n.v}}(t,e),d=o?i/2:a/2,c=r+l/100*s;return o&&(c=-1*c+s+2*r),{x:o?d:c,y:o?c:d}}var Wt,Xt=2*Math.PI,Yt=function(t,e){return Math.sqrt(t*t+e*e)};function Ft(t){return t.width/2-t.padding-t.handleRadius-t.borderWidth}function Ht(t){var e=t.width/2;return{width:t.width,radius:e-t.borderWidth,cx:e,cy:e}}function Kt(t,e,n){var i=t.wheelAngle,a=t.wheelDirection;return n&&"clockwise"===a?e=i+e:"clockwise"===a?e=360-i+e:n&&"anticlockwise"===a?e=i+180-e:"anticlockwise"===a&&(e=i-e),function(t,e){return(t%e+e)%e}(e,360)}function Zt(t,e,n){var i=Ht(t),a=i.cx,s=i.cy,r=Ft(t);e=a-e,n=s-n;var o=Kt(t,Math.atan2(-n,-e)*(360/Xt)),l=Math.min(Yt(e,n),r);return{h:Math.round(o),s:Math.round(100/r*l)}}function qt(t){var e=t.width,n=t.boxHeight;return{width:e,height:null!=n?n:e,radius:t.padding+t.handleRadius}}function Qt(t,e,n){var i=qt(t),a=i.width,s=i.height,r=i.radius,o=(e-r)/(a-2*r)*100,l=(n-r)/(s-2*r)*100;return{s:Math.max(0,Math.min(o,100)),v:Math.max(0,Math.min(100-l,100))}}function Jt(t){Wt||(Wt=document.getElementsByTagName("base"));var e=window.navigator.userAgent,n=/^((?!chrome|android).)*safari/i.test(e),i=/iPhone|iPod|iPad/i.test(e),a=window.location;return(n||i)&&Wt.length>0?a.protocol+"//"+a.host+a.pathname+a.search+t:t}function $t(t,e,n,i){for(var a=0;a<i.length;a++){var s=i[a].x-e,r=i[a].y-n;if(Math.sqrt(s*s+r*r)<t.handleRadius)return a}return null}function te(t){return{boxSizing:"border-box",border:t.borderWidth+"px solid "+t.borderColor}}function ee(t,e,n){return t+"-gradient("+e+", "+n.map((function(t){var e=t[0];return t[1]+" "+e+"%"})).join(",")+")"}function ne(t){return"string"==typeof t?t:t+"px"}var ie=["mousemove","touchmove","mouseup","touchend"],ae=function(t){function e(e){t.call(this,e),this.uid=(Math.random()+1).toString(36).substring(5)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.render=function(t){var e=this.handleEvent.bind(this),n={onMouseDown:e,ontouchstart:e},i="horizontal"===t.layoutDirection,a=null===t.margin?t.sliderMargin:t.margin,s={overflow:"visible",display:i?"inline-block":"block"};return t.index>0&&(s[i?"marginLeft":"marginTop"]=a),J(tt,null,t.children(this.uid,n,s))},e.prototype.handleEvent=function(t){var e=this,n=this.props.onInput,i=this.base.getBoundingClientRect();t.preventDefault();var a=t.touches?t.changedTouches[0]:t,s=a.clientX-i.left,r=a.clientY-i.top;switch(t.type){case"mousedown":case"touchstart":!1!==n(s,r,0)&&ie.forEach((function(t){document.addEventListener(t,e,{passive:!1})}));break;case"mousemove":case"touchmove":n(s,r,1);break;case"mouseup":case"touchend":n(s,r,2),ie.forEach((function(t){document.removeEventListener(t,e,{passive:!1})}))}},e}(et);function se(t){var e=t.r,n=t.url,i=e,a=e;return J("svg",{className:"IroHandle IroHandle--"+t.index+" "+(t.isActive?"IroHandle--isActive":""),style:{"-webkit-tap-highlight-color":"rgba(0, 0, 0, 0);",transform:"translate("+ne(t.x)+", "+ne(t.y)+")",willChange:"transform",top:ne(-e),left:ne(-e),width:ne(2*e),height:ne(2*e),position:"absolute",overflow:"visible"}},n&&J("use",Object.assign({xlinkHref:Jt(n)},t.props)),!n&&J("circle",{cx:i,cy:a,r:e,fill:"none","stroke-width":2,stroke:"#000"}),!n&&J("circle",{cx:i,cy:a,r:e-2,fill:t.fill,"stroke-width":2,stroke:"#fff"}))}function re(t){var e=t.activeIndex,n=void 0!==e&&e<t.colors.length?t.colors[e]:t.color,i=Gt(t),a=i.width,s=i.height,r=i.radius,o=Ut(t,n),l=function(t,e){var n=e.hsv,i=e.rgb;switch(t.sliderType){case"red":return[[0,"rgb(0,"+i.g+","+i.b+")"],[100,"rgb(255,"+i.g+","+i.b+")"]];case"green":return[[0,"rgb("+i.r+",0,"+i.b+")"],[100,"rgb("+i.r+",255,"+i.b+")"]];case"blue":return[[0,"rgb("+i.r+","+i.g+",0)"],[100,"rgb("+i.r+","+i.g+",255)"]];case"alpha":return[[0,"rgba("+i.r+","+i.g+","+i.b+",0)"],[100,"rgb("+i.r+","+i.g+","+i.b+")"]];case"kelvin":for(var a=[],s=t.minTemperature,r=t.maxTemperature,o=r-s,l=s,d=0;l<r;l+=o/8,d+=1){var c=Dt.kelvinToRgb(l),h=c.r,p=c.g,u=c.b;a.push([12.5*d,"rgb("+h+","+p+","+u+")"])}return a;case"hue":return[[0,"#f00"],[16.666,"#ff0"],[33.333,"#0f0"],[50,"#0ff"],[66.666,"#00f"],[83.333,"#f0f"],[100,"#f00"]];case"saturation":var g=Dt.hsvToHsl({h:n.h,s:0,v:n.v}),m=Dt.hsvToHsl({h:n.h,s:100,v:n.v});return[[0,"hsl("+g.h+","+g.s+"%,"+g.l+"%)"],[100,"hsl("+m.h+","+m.s+"%,"+m.l+"%)"]];default:var b=Dt.hsvToHsl({h:n.h,s:n.s,v:100});return[[0,"#000"],[100,"hsl("+b.h+","+b.s+"%,"+b.l+"%)"]]}}(t,n);return J(ae,Object.assign({},t,{onInput:function(e,i,a){var s=function(t,e,n){var i,a=Gt(t),s=a.handleRange,r=a.handleStart;i="horizontal"===t.layoutDirection?-1*n+s+r:e-r,i=Math.max(Math.min(i,s),0);var o=Math.round(100/s*i);switch(t.sliderType){case"kelvin":var l=t.minTemperature;return l+(t.maxTemperature-l)*(o/100);case"alpha":return o/100;case"hue":return 3.6*o;case"red":case"blue":case"green":return 2.55*o;default:return o}}(t,e,i);t.parent.inputActive=!0,n[t.sliderType]=s,t.onInput(a,t.id)}}),(function(e,i,d){return J("div",Object.assign({},i,{className:"IroSlider",style:Object.assign({},{position:"relative",width:ne(a),height:ne(s),borderRadius:ne(r),background:"conic-gradient(#ccc 25%, #fff 0 50%, #ccc 0 75%, #fff 0)",backgroundSize:"8px 8px"},d)}),J("div",{className:"IroSliderGradient",style:Object.assign({},{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:ne(r),background:ee("linear","horizontal"===t.layoutDirection?"to top":"to right",l)},te(t))}),J(se,{isActive:!0,index:n.index,r:t.handleRadius,url:t.handleSvg,props:t.handleProps,x:o.x,y:o.y}))}))}function oe(t){var e=qt(t),n=e.width,i=e.height,a=e.radius,s=t.colors,r=t.parent,o=t.activeIndex,l=void 0!==o&&o<t.colors.length?t.colors[o]:t.color,d=[[[0,"#fff"],[100,"hsl("+l.hue+",100%,50%)"]],[[0,"rgba(0,0,0,0)"],[100,"#000"]]],c=s.map((function(e){return function(t,e){var n=qt(t),i=n.width,a=n.height,s=n.radius,r=e.hsv,o=s,l=i-2*s,d=a-2*s;return{x:o+r.s/100*l,y:o+(d-r.v/100*d)}}(t,e)}));return J(ae,Object.assign({},t,{onInput:function(e,n,i){if(0===i){var a=$t(t,e,n,c);null!==a?r.setActiveColor(a):(r.inputActive=!0,l.hsv=Qt(t,e,n),t.onInput(i,t.id))}else 1===i&&(r.inputActive=!0,l.hsv=Qt(t,e,n));t.onInput(i,t.id)}}),(function(e,r,o){return J("div",Object.assign({},r,{className:"IroBox",style:Object.assign({},{width:ne(n),height:ne(i),position:"relative"},o)}),J("div",{className:"IroBox",style:Object.assign({},{width:"100%",height:"100%",borderRadius:ne(a)},te(t),{background:ee("linear","to bottom",d[1])+","+ee("linear","to right",d[0])})}),s.filter((function(t){return t!==l})).map((function(e){return J(se,{isActive:!1,index:e.index,fill:e.hslString,r:t.handleRadius,url:t.handleSvg,props:t.handleProps,x:c[e.index].x,y:c[e.index].y})})),J(se,{isActive:!0,index:l.index,fill:l.hslString,r:t.activeHandleRadius||t.handleRadius,url:t.handleSvg,props:t.handleProps,x:c[l.index].x,y:c[l.index].y}))}))}se.defaultProps={fill:"none",x:0,y:0,r:8,url:null,props:{x:0,y:0}},re.defaultProps=Object.assign({},{sliderShape:"bar",sliderType:"value",minTemperature:2200,maxTemperature:11e3});function le(t){var e=Ht(t).width,n=t.colors,i=(t.borderWidth,t.parent),a=t.color,s=a.hsv,r=n.map((function(e){return function(t,e){var n=e.hsv,i=Ht(t),a=i.cx,s=i.cy,r=Ft(t),o=(180+Kt(t,n.h,!0))*(Xt/360),l=n.s/100*r,d="clockwise"===t.wheelDirection?-1:1;return{x:a+l*Math.cos(o)*d,y:s+l*Math.sin(o)*d}}(t,e)})),o={position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",boxSizing:"border-box"};return J(ae,Object.assign({},t,{onInput:function(e,n,s){if(0===s){if(!function(t,e,n){var i=Ht(t),a=i.cx,s=i.cy,r=t.width/2;return Yt(a-e,s-n)<r}(t,e,n))return!1;var o=$t(t,e,n,r);null!==o?i.setActiveColor(o):(i.inputActive=!0,a.hsv=Zt(t,e,n),t.onInput(s,t.id))}else 1===s&&(i.inputActive=!0,a.hsv=Zt(t,e,n));t.onInput(s,t.id)}}),(function(i,l,d){return J("div",Object.assign({},l,{className:"IroWheel",style:Object.assign({},{width:ne(e),height:ne(e),position:"relative"},d)}),J("div",{className:"IroWheelHue",style:Object.assign({},o,{transform:"rotateZ("+(t.wheelAngle+90)+"deg)",background:"clockwise"===t.wheelDirection?"conic-gradient(red, yellow, lime, aqua, blue, magenta, red)":"conic-gradient(red, magenta, blue, aqua, lime, yellow, red)"})}),J("div",{className:"IroWheelSaturation",style:Object.assign({},o,{background:"radial-gradient(circle closest-side, #fff, transparent)"})}),t.wheelLightness&&J("div",{className:"IroWheelLightness",style:Object.assign({},o,{background:"#000",opacity:1-s.v/100})}),J("div",{className:"IroWheelBorder",style:Object.assign({},o,te(t))}),n.filter((function(t){return t!==a})).map((function(e){return J(se,{isActive:!1,index:e.index,fill:e.hslString,r:t.handleRadius,url:t.handleSvg,props:t.handleProps,x:r[e.index].x,y:r[e.index].y})})),J(se,{isActive:!0,index:a.index,fill:a.hslString,r:t.activeHandleRadius||t.handleRadius,url:t.handleSvg,props:t.handleProps,x:r[a.index].x,y:r[a.index].y}))}))}var de=function(t){function e(e){var n=this;t.call(this,e),this.colors=[],this.inputActive=!1,this.events={},this.activeEvents={},this.deferredEvents={},this.id=e.id,(e.colors.length>0?e.colors:[e.color]).forEach((function(t){return n.addColor(t)})),this.setActiveColor(0),this.state=Object.assign({},e,{color:this.color,colors:this.colors,layout:e.layout})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.addColor=function(t,e){void 0===e&&(e=this.colors.length);var n=new Dt(t,this.onColorChange.bind(this));this.colors.splice(e,0,n),this.colors.forEach((function(t,e){return t.index=e})),this.state&&this.setState({colors:this.colors}),this.deferredEmit("color:init",n)},e.prototype.removeColor=function(t){var e=this.colors.splice(t,1)[0];e.unbind(),this.colors.forEach((function(t,e){return t.index=e})),this.state&&this.setState({colors:this.colors}),e.index===this.color.index&&this.setActiveColor(0),this.emit("color:remove",e)},e.prototype.setActiveColor=function(t){this.color=this.colors[t],this.state&&this.setState({color:this.color}),this.emit("color:setActive",this.color)},e.prototype.setColors=function(t,e){var n=this;void 0===e&&(e=0),this.colors.forEach((function(t){return t.unbind()})),this.colors=[],t.forEach((function(t){return n.addColor(t)})),this.setActiveColor(e),this.emit("color:setAll",this.colors)},e.prototype.on=function(t,e){var n=this,i=this.events;(Array.isArray(t)?t:[t]).forEach((function(t){(i[t]||(i[t]=[])).push(e),n.deferredEvents[t]&&(n.deferredEvents[t].forEach((function(t){e.apply(null,t)})),n.deferredEvents[t]=[])}))},e.prototype.off=function(t,e){var n=this;(Array.isArray(t)?t:[t]).forEach((function(t){var i=n.events[t];i&&i.splice(i.indexOf(e),1)}))},e.prototype.emit=function(t){for(var e=this,n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];var a=this.activeEvents,s=!!a.hasOwnProperty(t)&&a[t];if(!s){a[t]=!0;var r=this.events[t]||[];r.forEach((function(t){return t.apply(e,n)})),a[t]=!1}},e.prototype.deferredEmit=function(t){for(var e,n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];var a=this.deferredEvents;(e=this).emit.apply(e,[t].concat(n)),(a[t]||(a[t]=[])).push(n)},e.prototype.setOptions=function(t){this.setState(t)},e.prototype.resize=function(t){this.setOptions({width:t})},e.prototype.reset=function(){this.colors.forEach((function(t){return t.reset()})),this.setState({colors:this.colors})},e.prototype.onMount=function(t){this.el=t,this.deferredEmit("mount",this)},e.prototype.onColorChange=function(t,e){this.setState({color:this.color}),this.inputActive&&(this.inputActive=!1,this.emit("input:change",t,e)),this.emit("color:change",t,e)},e.prototype.emitInputEvent=function(t,e){0===t?this.emit("input:start",this.color,e):1===t?this.emit("input:move",this.color,e):2===t&&this.emit("input:end",this.color,e)},e.prototype.render=function(t,e){var n=this,i=e.layout;return Array.isArray(i)||(i=[{component:le},{component:re}],e.transparency&&i.push({component:re,options:{sliderType:"alpha"}})),J("div",{class:"IroColorPicker",id:e.id,style:{display:e.display}},i.map((function(t,i){var a=t.component,s=t.options;return J(a,Object.assign({},e,s,{ref:void 0,onInput:n.emitInputEvent.bind(n),parent:n,index:i}))})))},e}(et);de.defaultProps=Object.assign({},{width:300,height:300,color:"#fff",colors:[],padding:6,layoutDirection:"vertical",borderColor:"#fff",borderWidth:0,handleRadius:8,activeHandleRadius:null,handleSvg:null,handleProps:{x:0,y:0},wheelLightness:!0,wheelAngle:0,wheelDirection:"anticlockwise",sliderSize:null,sliderMargin:12,boxHeight:null},{colors:[],display:"block",id:null,layout:"default",margin:null});var ce,he,pe,ue=(he=function(t,e){var n,i=document.createElement("div");function a(){var e=t instanceof Element?t:document.querySelector(t);e.appendChild(n.base),n.onMount(e)}return function(t,e,n){var i,a,s;U.__p&&U.__p(t,e),a=(i=n===F)?null:n&&n.__k||e.__k,t=J(tt,null,[t]),s=[],ht(e,i?e.__k=t:(n||e).__k=t,a||H,H,void 0!==e.ownerSVGElement,n&&!i?[n]:a?null:K.slice.call(e.childNodes),s,!1,n||H,i),pt(s,t)}(J(ce,Object.assign({},{ref:function(t){return n=t}},e)),i),"loading"!==document.readyState?a():document.addEventListener("DOMContentLoaded",a),n},he.prototype=(ce=de).prototype,Object.assign(he,ce),he.__component=ce,he);!function(t){t.version="5.5.2",t.Color=Dt,t.ColorPicker=ue,function(t){t.h=J,t.ComponentBase=ae,t.Handle=se,t.Slider=re,t.Wheel=le,t.Box=oe}(t.ui||(t.ui={}))}(pe||(pe={}));const ge=pe;n(6835);class me extends s{maincolor;subcolor;colorPicker_square;colorPicker_wheel;CONST={};constructor(t){super(t)}getDefaultPosition(){return{left:this.axpObj.paintBodyElement.clientWidth-this.window_width-120-10,top:250}}init(){this.createHTML("tool_color","色作成","axp-icon-window-colormaker",'\x3c!-- カラーツール --\x3e\r\n<div class="tool_box">\r\n    \x3c!-- メインカラー／サブカラー、透明色 --\x3e\r\n    <div>\r\n        <div>メインカラー</div>\r\n        <div>サブカラー</div>\r\n        <div id="color_main" class="MSG coloricon2" data-key="X" data-msg="描画色となるメインカラー。クリックでメインとサブを切り替えます。"\r\n            data-selected="true" style="background-color: rgb(0, 0, 0);"></div>\r\n        <div id="color_sub" class="MSG coloricon2" data-key="X" data-msg="サブカラー。クリックでメインとサブを切り替えます。"\r\n            style="background-color: rgb(255, 255, 255);"></div>\r\n        <div id="color_transparent" class="MSG coloricon2 axp-mesh" data-key="C" data-msg="描画色を透明色に切り替えます。"></div>\r\n    </div>\r\n\r\n    \x3c!-- カラーコード --\x3e\r\n    <div>\r\n        <label>ｺｰﾄﾞ<input type="text" id="text-hexcolor" class="MSG" maxlength="7" value="#000000"\r\n                data-msg="カラーコードを直接入力してメインカラーを変更します。"></label><button id="button_addcolor" class="MSG mybutton size_60"\r\n            style="height:22px;" data-msg="現在の色をカラーパレットに登録します。">登録</button>\r\n    </div>\r\n\r\n    <div>\r\n        \x3c!-- RGBスライダー--\x3e\r\n        <div id="rgb_color">\r\n            <div>\r\n                <span>赤</span><input id="range_red" class="MSG range_color" type="range" min="0" max="255" value="0"\r\n                    data-msg="メインカラーの赤成分を変更します。(0～255)"><input id="range_red_text" class="MSG" type="number" min="0"\r\n                    max="255" value="0" maxlength="3" data-msg="赤成分を直接入力します。(0～255)">\r\n            </div>\r\n            <div>\r\n                <span>緑</span><input id="range_green" class="MSG range_color" type="range" min="0" max="255" value="0"\r\n                    data-msg="メインカラーの緑成分を変更します。(0～255)"><input id="range_green_text" class="MSG" type="number" min="0"\r\n                    max="255" value="0" maxlength="3" data-msg="緑成分を直接入力します。(0～255)">\r\n            </div>\r\n            <div>\r\n                <span>青</span><input id="range_blue" class="MSG range_color" type="range" min="0" max="255" value="0"\r\n                    data-msg="メインカラーの青成分を変更します。(0～255)"><input id="range_blue_text" class="MSG" type="number" min="0"\r\n                    max="255" value="0" maxlength="3" data-msg="青成分を直接入力します。(0～255)">\r\n            </div>\r\n        </div>\r\n\r\n        \x3c!-- カラーピッカー --\x3e\r\n        <div id="picker_base" class="MSG" data-msg="メインカラーを指定色に変更します。">\r\n            <div id="picker_box"></div>\r\n            <div id="picker_wheel" class="displaynone"></div>\r\n        </div>\r\n    </div>\r\n</div>'),this.window_width=180,this.colorPicker_square=new ge.ColorPicker("#picker_box",{borderWidth:2,borderColor:"#444",width:120,color:"#000",layoutDirection:"horizontal",margin:8,handleRadius:8,layout:[{component:ge.ui.Box},{component:ge.ui.Slider,options:{sliderType:"hue",sliderSize:32}}]}),this.colorPicker_wheel=new ge.ColorPicker("#picker_wheel",{borderWidth:2,borderColor:"#444",width:120,color:"#000",layoutDirection:"horizontal",margin:8,handleRadius:8,layout:[{component:ge.ui.Wheel,options:{wheelLightness:!1}},{component:ge.ui.Slider,options:{sliderType:"value",sliderSize:32}}]}),document.getElementById("color_main").style.backgroundColor="#000000",document.getElementById("color_sub").style.backgroundColor="#FFFFFF",this.maincolor="#000000",this.subcolor="#FFFFFF"}startEvent(){const t=t=>{"true"===document.getElementById("color_transparent").dataset.selected?(document.getElementById("color_main").dataset.selected="true",document.getElementById("color_transparent").dataset.selected="false",this.axpObj.penSystem.previewPenSize(),this.axpObj.msg(`描画色：メインカラー（${r(this.maincolor)}）`)):this.swap_maincolor()};document.getElementById("color_main").onclick=t,document.getElementById("color_sub").onclick=t,document.getElementById("color_transparent").onclick=()=>{document.getElementById("color_main").dataset.selected="false",document.getElementById("color_transparent").dataset.selected="true",this.axpObj.msg("描画色：透明色"),this.axpObj.penSystem.previewPenSize()};const e=()=>{let t="#"+o([Number(document.getElementById("range_red").value),Number(document.getElementById("range_green").value),Number(document.getElementById("range_blue").value)]);this.setMainColor(t)};document.getElementById("range_red").oninput=e,document.getElementById("range_green").oninput=e,document.getElementById("range_blue").oninput=e,document.getElementById("text-hexcolor").onchange=()=>{var t=document.getElementById("text-hexcolor").value;if(m(t)){var e=r(t),n=e[0],i=e[1],a=e[2],s="#"+o(e).toUpperCase();this.setMainColor(s),this.axpObj.msg(`カラーコードの入力を受け付けました。${s} / RGB(${n},${i},${a})`,"information")}else this.axpObj.msg("カラーコードが正しくありません。入力例：#ffffff または #fff（#は省略可）","caution")};const n=t=>{let e="#"+o([b(document.getElementById("range_red_text").value),b(document.getElementById("range_green_text").value),b(document.getElementById("range_blue_text").value)]);this.setMainColor(e)};document.getElementById("range_red_text").onchange=n,document.getElementById("range_green_text").onchange=n,document.getElementById("range_blue_text").onchange=n,this.colorPicker_square.on("input:change",(t=>{let e=t.hexString;this.setMainColor(e)})),this.colorPicker_wheel.on("input:change",(t=>{let e=t.hexString;this.maincolor!=e&&this.setMainColor(e)})),document.getElementById("button_addcolor").addEventListener("click",(t=>{let e=this.maincolor,n=this.axpObj.colorPaletteSystem.addPalette(e);n.isSucceed?this.axpObj.msg(`カラーパレットを登録しました。RGB:(${r(e)})`,"information"):this.axpObj.msg(n.msg,"caution")}))}getMainColor(){return this.maincolor}setMainColor(t){this.maincolor=t,this.colorPicker_wheel.color.hexString=t,this.colorPicker_square.color.hexString=t;let e=t.slice(1).match(/.{2}/g);document.getElementById("range_red").value=parseInt(e[0],16),document.getElementById("range_green").value=parseInt(e[1],16),document.getElementById("range_blue").value=parseInt(e[2],16),document.getElementById("range_red_text").value=parseInt(e[0],16),document.getElementById("range_green_text").value=parseInt(e[1],16),document.getElementById("range_blue_text").value=parseInt(e[2],16),document.getElementById("color_main").style.backgroundColor=t,document.getElementById("color_main").dataset.selected="true",document.getElementById("color_transparent").dataset.selected="false",document.getElementById("text-hexcolor").value=t.toUpperCase(),this.axpObj.colorPaletteSystem.setColor(t),this.axpObj.penSystem.previewPenSize()}getSubColor(){return this.subcolor}setSubColor(t){this.subcolor=t,document.getElementById("color_sub").style.backgroundColor=t}swap_maincolor(){let t=this.subcolor;this.setSubColor(this.maincolor),this.setMainColor(t),this.axpObj.msg(`描画色：メインカラー（${r(this.maincolor)}）<-> サブカラー（${r(this.subcolor)}）`)}swap_transparent(){"true"===document.getElementById("color_transparent").dataset.selected?(document.getElementById("color_main").dataset.selected="true",document.getElementById("color_transparent").dataset.selected="false",this.axpObj.msg(`描画色：メインカラー（${r(this.maincolor)}）`)):(document.getElementById("color_main").dataset.selected="false",document.getElementById("color_transparent").dataset.selected="true",this.axpObj.msg("描画色：透明色")),this.axpObj.penSystem.previewPenSize()}updateMakeColorType(){var t=document.getElementById("config_makecolortype").elements.config_makecolortype.value,e=document.getElementById("rgb_color"),n=document.getElementById("picker_base");switch(t){case"rgb_color":e.classList.remove("displaynone"),n.classList.add("displaynone"),document.getElementById("cfg1011").disabled=!0,document.getElementById("cfg1012").disabled=!0,document.getElementById("config_pickertype").style.opacity="0.3";break;case"picker":e.classList.add("displaynone"),n.classList.remove("displaynone"),document.getElementById("cfg1011").disabled=!1,document.getElementById("cfg1012").disabled=!1,document.getElementById("config_pickertype").style.opacity="1";break;case"both":e.classList.remove("displaynone"),n.classList.remove("displaynone"),document.getElementById("cfg1011").disabled=!1,document.getElementById("cfg1012").disabled=!1,document.getElementById("config_pickertype").style.opacity="1"}}updatePickerType(){var t=document.getElementById("config_pickertype").elements.config_pickertype.value,e=document.getElementById("picker_box"),n=document.getElementById("picker_wheel");switch(t){case"picker_box":e.classList.remove("displaynone"),n.classList.add("displaynone");break;case"picker_wheel":e.classList.add("displaynone"),n.classList.remove("displaynone")}}}n(6932);class be extends s{scale_index;isDragingMap=!1;isGrid=!1;isTransparent=!1;constructor(t){super(t),this.scale_index=4}CANVAS={thumbnail:null,thumbnail_ctx:null};CONST={X_LOUPE_MAX:120,Y_LOUPE_MAX:120};getDefaultPosition(){return{left:this.axpObj.paintBodyElement.clientWidth-this.window_width-10,top:10}}init(){this.createHTML("tool_sub","補助ツール","axp-icon-window-subtool",'\x3c!-- 補助ツール --\x3e\r\n<div class="tool_box">\r\n    <div style="display: flex;">\r\n        <div>\r\n            <div style="text-align:center;">\r\n                <label id="label_canvas" class="MSG" data-msg="キャンバスの大きさ。クリックでサイズ変更の設定画面を開きます。"></label>\r\n            </div>\r\n            <div id="map_grid" class="MSG" data-msg="サムネイル表示。枠内をクリックまたはドラッグでキャンバスの位置を移動します。">\r\n                <div id="minimap_line"></div>\r\n                <canvas id="minimap" class="axp-mesh" width="120" height="120"></canvas>\r\n            </div>\r\n            <button id="button_loupe_down" class="FUNCTION MSG mybutton size_mini2" data-function="func_loupe_down"\r\n                data-key="-" data-msg="拡大率を１段階縮小します。">-</button>\r\n            <button id="button_loupe_reset" class="FUNCTION MSG mybutton size_mini1" data-function="func_loupe_reset"\r\n                data-key="0" data-msg="拡大率とキャンバス位置をリセットします。">100%</button>\r\n            <button id="button_loupe_up" class="FUNCTION MSG mybutton size_mini2" data-function="func_loupe_up"\r\n                data-key="+" data-msg="拡大率を１段階拡大します。">+</button>\r\n        </div>\r\n\r\n        <div style="margin-top:4px;margin-left: 4px;">\r\n            <button id="button_undo" class="FUNCTION MSG mybutton size_big1" data-function="func_undo" data-key="Z"\r\n                data-msg="直前の描画を取消して元に戻します。ボタンの数字の回数だけ遡れます。">アンドゥ(0)</button>\r\n            <br>\r\n            <button id="button_redo" class="FUNCTION MSG mybutton size_big1" data-function="func_redo" data-key="Y"\r\n                data-msg="アンドゥを取消します。ボタンの数字の回数だけ遡れます。">リドゥ(0)</button>\r\n            <br>\r\n            <button id="button_restore" class="FUNCTION MSG mybutton size_big1" data-function="func_restore"\r\n                data-key="R" data-msg="自動バックアップから復元ポイントを選んで再開します。（※現在の描画内容は消去されます）">自動保存から復元</button>\r\n            <br>\r\n            <button id="button_save" class="FUNCTION MSG mybutton" data-function="func_save" data-key="S"\r\n                data-msg="描画内容をブラウザに一時保存し、復元ポイントを作成します。">セーブ</button>\r\n            <button id="button_load" class="FUNCTION MSG mybutton" data-function="func_load" data-key="L"\r\n                data-msg="作成した復元ポイントから再開します（※現在の描画内容は消去されます）">ロード</button>\r\n            <br>\r\n            <button id="button_flip_h" class="FUNCTION MSG mybutton" data-function="func_flip_h" data-key="H"\r\n                data-msg="画像を左右反転します。（※設定で全体/単体を変更可能）">左右反転</button>\r\n            <button id="button_flip_v" class="FUNCTION MSG mybutton" data-function="func_flip_v" data-key="V"\r\n                data-msg="画像を上下反転します。（※設定で全体/単体を変更可能）">上下反転</button>\r\n            <br>\r\n            <button id="button_transparent" class="FUNCTION MSG mybutton" data-function="func_transparent" data-key="T"\r\n                data-msg="背景色の白地/透明色を切り替えます。（※投稿画像に反映されます）">背景透過</button>\r\n            <button id="button_grid" class="FUNCTION MSG mybutton" data-function="func_grid" data-key="G"\r\n                data-msg="グリッド線のON/OFFを切り替えます。（※設定で分割数を変更可能）">グリッド</button>\r\n        </div>\r\n    </div>\r\n</div>'),this.window_width=300,this.CANVAS.thumbnail=document.getElementById("minimap"),this.CANVAS.thumbnail_ctx=this.CANVAS.thumbnail.getContext("2d")}resetCanvas(){document.getElementById("label_canvas").textContent="横:"+this.axpObj.x_size+" 縦:"+this.axpObj.y_size,this.loupeReset(),this.setGridDivision();let t=this.CANVAS.thumbnail_ctx;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,this.CONST.X_LOUPE_MAX,this.CONST.Y_LOUPE_MAX);var e=this.CONST.X_LOUPE_MAX/Math.max(this.axpObj.x_size,this.axpObj.y_size);t.scale(e,e),this.axpObj.ctx_map_shift_x=0,this.axpObj.ctx_map_shift_y=0,Number(this.axpObj.x_size)>Number(this.axpObj.y_size)&&(this.axpObj.ctx_map_shift_y=(this.axpObj.x_size-this.axpObj.y_size)/2),Number(this.axpObj.x_size)<Number(this.axpObj.y_size)&&(this.axpObj.ctx_map_shift_x=(this.axpObj.y_size-this.axpObj.x_size)/2),this.mapguide()}setGridDivision(){let t,e;document.getElementById("config_grid_2way").checked?(t=100/parseInt(config_grid_division_vertical.value),e=100/parseInt(config_grid_division_horizontal.value)):t=e=100/parseInt(config_grid_division.value),this.axpObj.ELEMENT.grid.style.backgroundSize=e+"% "+t+"%"}set_grid_color(){let t=document.getElementById("config_grid_color").elements.config_grid_color.value,e="linear-gradient(0deg, "+t+" 2px, transparent 2px), linear-gradient(270deg, "+t+" 2px, transparent 2px)";this.axpObj.ELEMENT.grid.style.backgroundImage=e,this.axpObj.ELEMENT.grid_dot.style.backgroundImage=e}set_grid_2way(){document.getElementById("config_grid_2way").checked?(config_grid_division_horizontal_value.classList.remove("displaynone"),config_grid_division_vertical_value.classList.remove("displaynone"),config_grid_division_value.classList.add("displaynone")):(config_grid_division_horizontal_value.classList.add("displaynone"),config_grid_division_vertical_value.classList.add("displaynone"),config_grid_division_value.classList.remove("displaynone")),this.setGridDivision()}startEvent(){document.getElementById("map_grid").onpointerdown=t=>{this.isDragingMap=!0,this.func_map_hand(t)},document.getElementById("map_grid").onpointermove=t=>{this.isDragingMap&&this.func_map_hand(t)},document.getElementById("map_grid").onpointerleave=document.getElementById("map_grid").onpointerup=t=>{this.isDragingMap=!1}}loupeDown(){if(this.scale_index<=0)return;this.scale_index--;let t=this.getScale();this.axpObj.scale=t,this.drawloupe(),this.axpObj.layerSystem.draw(),this.mapguide(),this.axpObj.msg(`拡大率：${t}%`)}loupeUp(){if(this.scale_index>=xe.length-1)return;this.scale_index++;let t=this.getScale();this.axpObj.scale=t,this.drawloupe(),this.axpObj.layerSystem.draw(),this.mapguide(),this.axpObj.msg(`拡大率：${t}%`)}loupeReset(){this.scale_index=4;let t=this.getScale();this.axpObj.scale=t,this.axpObj.canvas_x=0,this.axpObj.canvas_y=0,this.drawloupe(),this.axpObj.layerSystem.draw(),this.mapguide()}setScaleIndex(t){return this.scale_index=t,this.axpObj.scale=xe[this.scale_index],this.drawloupe(),this.axpObj.layerSystem.draw(),this.mapguide(),this.axpObj.scale}getScale(){return xe[this.scale_index]}flip_h(){"all"===document.getElementById("config_flip_layer").elements.config_flip_layer.value?(this.axpObj.layerSystem.flip_h("all"),this.axpObj.msg("全レイヤーの左右を反転しました。","information"),this.axpObj.undoSystem.setUndo({type:"flip_h",id:"all"})):(this.axpObj.layerSystem.flip_h(),this.axpObj.msg("選択中レイヤーの左右を反転しました。","information"),this.axpObj.undoSystem.setUndo({type:"flip_h",id:this.axpObj.layerSystem.getId()}))}flip_v(){"all"===document.getElementById("config_flip_layer").elements.config_flip_layer.value?(this.axpObj.layerSystem.flip_v("all"),this.axpObj.msg("全レイヤーの上下を反転しました。","information"),this.axpObj.undoSystem.setUndo({type:"flip_v",id:"all"})):(this.axpObj.layerSystem.flip_v(),this.axpObj.msg("選択中レイヤーの上下を反転しました。","information"),this.axpObj.undoSystem.setUndo({type:"flip_v",id:this.axpObj.layerSystem.getId()}))}grid(){this.isGrid=!this.isGrid,document.getElementById("button_grid").dataset.selected=this.isGrid?"true":"false",this.isGrid?(this.axpObj.ELEMENT.grid.classList.remove("displaynone"),this.drawloupe()):this.axpObj.ELEMENT.grid.classList.add("displaynone");var t=this.isGrid?"表示":"非表示";this.axpObj.msg("グリッド線の表示を切り替えました。（現在の状態:"+t+"）","information")}transparent(){this.isTransparent=!this.isTransparent,document.getElementById("button_transparent").dataset.selected=this.isTransparent?"true":"false",this.axpObj.layerSystem.draw();var t=this.isTransparent?"透過":"白地";this.axpObj.msg("背景を切り替えました。（現在の状態:"+t+"）","information"),this.axpObj.layerSystem.updateCanvas()}getIsTransparent(){return this.isTransparent}func_map_hand(t){var e=document.getElementById("minimap").getBoundingClientRect(),n=t.clientX-e.left-6,i=t.clientY-e.top-6,a=this.axpObj.ELEMENT.view.getBoundingClientRect(),s=this.axpObj.CANVAS.main.getBoundingClientRect(),r=a.width,o=a.height,l=s.width,d=s.height,c=r+l,h=o+d,p=c-n*c/e.width-l,u=h-i*h/e.height-d;this.axpObj.CANVAS.main.style.left=p+"px",this.axpObj.CANVAS.main.style.top=u+"px",this.axpObj.ELEMENT.grid.style.left=this.axpObj.CANVAS.main.style.left,this.axpObj.ELEMENT.grid.style.top=this.axpObj.CANVAS.main.style.top,this.axpObj.ELEMENT.grid_dot.style.left=this.axpObj.CANVAS.main.style.left,this.axpObj.ELEMENT.grid_dot.style.top=this.axpObj.CANVAS.main.style.top;var g=this.axpObj.ELEMENT.view.getBoundingClientRect();this.axpObj.canvas_x=p-parseInt((g.width-this.axpObj.x_size*this.axpObj.scale/100)/2),this.axpObj.canvas_y=u-parseInt((g.height-this.axpObj.y_size*this.axpObj.scale/100)/2),this.mapguide()}mapguide(){var t=this.axpObj.ELEMENT.view.getBoundingClientRect(),e=this.axpObj.CANVAS.main.getBoundingClientRect(),n=0,i=0,a=0,s=0,r=!1,o=!1;if(e.top<0){var l=Math.abs(e.top);a=c=120*(1-(e.height-l)/e.height),i+=parseInt(c),r=!0}var d=e.top+e.height;if(t.height<d){l=d-t.height;var c=120*(1-(e.height-l)/e.height);i+=parseInt(c),r=!0}if(e.left<0){var h=Math.abs(e.left);s=u=120*(1-(e.width-h)/e.width),n+=parseInt(u),r=!0}var p=e.left+e.width;if(t.width<p){h=p-t.width;var u=120*(1-(e.width-h)/e.width);n+=parseInt(u),r=!0}r&&(o=!0,(s>120||a>120)&&(o=!1),(120-n<1||120-i<1)&&(o=!1)),o?(minimap_line.style.display="block",minimap_line.style.left=-1+s+"px",minimap_line.style.top=-1+a+"px",minimap_line.style.width=121-n+"px",minimap_line.style.height=121-i+"px"):minimap_line.style.display="none"}drawloupe(){let t=this.axpObj.CANVAS.main,e=this.axpObj.ELEMENT.view.getBoundingClientRect();document.getElementById("button_loupe_reset").textContent=this.axpObj.scale+"%",t.style.width=parseInt(this.axpObj.x_size*(this.axpObj.scale/100))+"px",t.style.height=parseInt(this.axpObj.y_size*(this.axpObj.scale/100))+"px";var n=this.axpObj.canvas_x+parseInt((e.width-this.axpObj.x_size*this.axpObj.scale/100)/2),i=this.axpObj.canvas_y+parseInt((e.height-this.axpObj.y_size*this.axpObj.scale/100)/2);t.style.left=n+"px",t.style.top=i+"px",this.axpObj.resetGridarea(),this.axpObj.dispGridDot(),this.axpObj.penSystem.previewPenSize()}}const xe=[25,33,50,66,100,150,200,250,300,400,600,800,1200,1600];class ye{constructor(t){this.type=t.type,this.detail=t.detail,this.id=t.id,this.layerObj=t.layerObj?new T(t.layerObj):null,this.layerObj_dest=t.layerObj_dest?new T(t.layerObj_dest):null}}class _e{axpObj;undoObj=[];redoObj=[];isUndoing=!1;isRedoing=!1;undoButtonElement=null;redoButtonElement=null;CONST={UNDO_MAX:10};constructor(t){this.axpObj=t}init(){this.setUndoButtonElement(document.getElementById("button_undo")),this.setRedoButtonElement(document.getElementById("button_redo"))}resetCanvas(){this.undoObj.splice(0),this.redoObj.splice(0),this.dispCount()}dispCount(){this.undoButtonElement.textContent="アンドゥ("+this.undoObj.length+")",this.redoButtonElement.textContent="リドゥ("+this.redoObj.length+")"}setUndoButtonElement(t){this.undoButtonElement=t}setRedoButtonElement(t){this.redoButtonElement=t}setUndo(t){this.isRedoing||this.redoObj.splice(0),this.undoObj.length>=this.CONST.UNDO_MAX&&this.undoObj.shift();let e=new ye(t);this.undoObj.push(e),this.dispCount()}undo(){if(this.undoObj.length<=0)return void this.axpObj.msg("これ以上アンドゥできません。","caution");const t=this.undoObj.pop();this.isUndoing=!0;let e="";switch(t.type){case"draw":e=this.getDetailText(t.detail),this.axpObj.undoSystem.setRedo({type:t.type,detail:t.detail,layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(t.layerObj.id)]}),this.axpObj.layerSystem.setImageId(t.layerObj.image,t.layerObj.id);break;case"layer-create":e="[レイヤー:新規]",this.setRedo(t),this.axpObj.layerSystem.deleteLayer(t.layerObj.id);break;case"layer-copy":e="[レイヤー:複製]",this.setRedo(t),this.axpObj.layerSystem.deleteLayer(t.layerObj.id);break;case"layer-delete":e="[レイヤー:削除]",this.setRedo(t),this.axpObj.layerSystem.createLayer(t);break;case"layer-clear":e="[レイヤー:クリア]",this.setRedo(t),this.axpObj.layerSystem.setImageId(t.layerObj.image,t.layerObj.id);break;case"layer-integrate":e="[レイヤー:統合]",this.axpObj.undoSystem.setRedo({type:t.type,layerObj:t.layerObj,layerObj_dest:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(t.layerObj_dest.id)]}),this.axpObj.layerSystem.createLayer(t);let n=t.layerObj_dest,i=this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(n.id)];i.image=n.image,i.alpha=n.alpha;break;case"flip_h":this.setRedo(t),this.axpObj.layerSystem.flip_h(t.id),e="all"==t.id?"[左右反転:全体]":"[左右反転:単体]";break;case"flip_v":this.setRedo(t),this.axpObj.layerSystem.flip_v(t.id),e="all"==t.id?"[上下反転:全体]":"[上下反転:単体]"}this.isUndoing=!1,this.axpObj.msg(`${e}をアンドゥしました。（残り回数：${this.undoObj.length}）`,"information"),this.axpObj.layerSystem.updateCanvas(),this.dispCount()}setRedo(t){this.redoObj.length>=this.CONST.UNDO_MAX&&(redoObj.shift(),alert("REDO error"));let e=new ye(t);this.redoObj.push(e)}redo(){if(this.redoObj.length<=0)return void this.axpObj.msg("これ以上リドゥできません。","caution");this.isRedoing=!0;const t=this.redoObj.pop();let e="";switch(t.type){case"draw":e=this.getDetailText(t.detail),this.axpObj.undoSystem.setUndo({type:t.type,detail:t.detail,layerObj:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(t.layerObj.id)]}),this.axpObj.layerSystem.setImageId(t.layerObj.image,t.layerObj.id);break;case"layer-create":e="[レイヤー:新規]",this.setUndo(t),this.axpObj.layerSystem.createLayer(t);break;case"layer-copy":e="[レイヤー:複製]",this.setUndo(t),this.axpObj.layerSystem.createLayer(t);break;case"layer-delete":e="[レイヤー:削除]",this.setUndo(t),this.axpObj.layerSystem.deleteLayer(t.layerObj.id);break;case"layer-clear":e="[レイヤー:クリア]",this.setUndo(t),this.axpObj.layerSystem.clear(t.layerObj.id);break;case"layer-integrate":e="[レイヤー:統合]",this.setUndo({type:t.type,layerObj:t.layerObj,layerObj_dest:this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(t.layerObj_dest.id)]});let n=t.layerObj_dest,i=this.axpObj.layerSystem.layerObj[this.axpObj.layerSystem.getLayerIndex(n.id)];i.image=n.image,i.alpha=n.alpha,this.axpObj.layerSystem.deleteLayer(t.layerObj.id);break;case"flip_h":this.setUndo(t),this.axpObj.layerSystem.flip_h(t.id),e="all"==t.id?"[左右反転:全体]":"[左右反転:単体]";break;case"flip_v":this.setUndo(t),this.axpObj.layerSystem.flip_v(t.id),e="all"==t.id?"[上下反転:全体]":"[上下反転:単体]"}this.isRedoing=!1,this.axpObj.msg(`${e}をリドゥしました。（残り回数：${this.redoObj.length}）`,"information"),this.axpObj.layerSystem.updateCanvas(),this.dispCount()}getDetailText(t){let e;switch(t){case"eraser":e="[消しゴム]";break;case"move":e="[移動ツール]";break;case"fill":e="[バケツ]";break;case"fillall":e="[全面塗り潰し]";break;case"rotate90":e="[90°回転]";break;default:e="[線の描画]"}return e}}n(2825);class Ae{axpObj;CONST={CANVAS_SIZE_HISTORY_MAX:8};configObj;configCanvasSizeHistory=[];optionlist=[{value:"none",name:"---"},{value:"func_loupe",name:"拡大率"},{value:"func_size",name:"ペンの太さ"},{value:"func_undo",name:"アンドゥ"},{value:"func_redo",name:"リドゥ"},{value:"func_restore",name:"自動保存から復元"},{value:"func_save",name:"セーブ"},{value:"func_load",name:"ロード"},{value:"func_flip_h",name:"左右反転"},{value:"func_flipmirror",name:"全レイヤー左右反転"},{value:"func_flip_v",name:"上下反転"},{value:"func_transparent",name:"背景透過"},{value:"func_grid",name:"グリッド"},{value:"func_loupe_down",name:"拡大率を１段階縮小"},{value:"func_loupe_reset",name:"拡大率とキャンバス位置のリセット"},{value:"func_loupe_up",name:"拡大率を１段階拡大"},{value:"func_swap_transparent",name:"メイン色と透過色切り替え"},{value:"func_swap_maincolor",name:"メイン色とサブ色切り替え"},{value:"func_fill_all",name:"全面塗り潰し"},{value:"func_backgroundimage",name:"背景タイルプレビュー"},{value:"func_init_window_positon",name:"ツールウィンドウの位置初期化"},{value:"func_download",name:"画像をPNG形式でファイルに保存"}];constructor(t){this.axpObj=t,this.configObj=new Map}init(){document.getElementById("axp-config").insertAdjacentHTML("afterbegin",'<div id="axp-config-menu">\r\n\r\n    <div id="axp-config-content">\r\n        <div id="axp-config-left">\r\n            <section id="axp-config-tab-section">\r\n                <ul>\r\n                    <li data-idx="0" class="MSG" data-msg="キャンバス全般に関する設定を行います。">キャンバス</li>\r\n                    <li data-idx="1" class="MSG" data-msg="ツールウィンドウ全般に関する設定を行います。">ツールウィンドウ</li>\r\n                    <li data-idx="2" class="MSG" data-msg="ペンツールの機能設定を行います。">\r\n                        <span class="axp-icon-span axp-icon-window-pen"></span>ペンツール\r\n                    </li>\r\n                    <li data-idx="3" class="MSG" data-msg="色作成の機能設定を行います。">\r\n                        <span class="axp-icon-span axp-icon-window-colormaker"></span>色作成\r\n                    </li>\r\n                    <li data-idx="4" class="MSG" data-msg="パレットの機能設定を行います。">\r\n                        <span class="axp-icon-span axp-icon-window-palette"></span>パレット\r\n                    </li>\r\n                    <li data-idx="5" class="MSG" data-msg="レイヤーの機能設定を行います。">\r\n                        <span class="axp-icon-span axp-icon-window-layer"></span>レイヤー\r\n                    </li>\r\n                    <li data-idx="6" class="MSG" data-msg="補助ツールの機能設定を行います。">\r\n                        <span class="axp-icon-span axp-icon-window-subtool"></span>補助ツール\r\n                    </li>\r\n                    <li data-idx="7" class="MSG" data-msg="マウスのキーコンフィグなどの設定を行います。">マウス</li>\r\n                    <li data-idx="8" class="MSG" data-msg="キーボードのキーコンフィグなどの設定を行います。">キーボード</li>\r\n                    <li data-idx="9" class="MSG" data-msg="キーボードのショートカット一覧を表示します。">・ショートカット一覧</li>\r\n                    <li data-idx="10" class="MSG" data-msg="バージョン情報を表示します。">バージョン情報</li>\r\n                </ul>\r\n            </section>\r\n        </div>\r\n        <div id="axp-config-right">\r\n            <div>\r\n                \x3c!-- キャンバス --\x3e\r\n                <article>\r\n                    <u>お絵カキコのサイズ</u><br>\r\n                    <div style="display: flex;">\r\n                        <div>\r\n                            [数値入力]<br>\r\n                            <label>横</label>\r\n                            <input id="oekaki_width" type="number" maxlength="3" min="8" max="600" value="317"\r\n                                size="5"><br>\r\n                            <label>縦</label>\r\n                            <input id="oekaki_height" type="number" maxlength="3" min="8" max="600" value="317"\r\n                                size="5"><br>\r\n                            (最小8×8～<br>最大600×600)\r\n                        </div>\r\n                        <div style="margin-left:24px;">\r\n                            [履歴から選択]<br>\r\n                            <select id="axp-config-selectCanvasSizeHistory" size="8" class="MSG"\r\n                                data-msg="過去に使用したキャンバスサイズ" style="padding:0 8px;width:100px;">\r\n                            </select><br>\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                    <button id="button-changesize1" class="MSG mybutton size_big2"\r\n                        data-msg="新規キャンバスを作成します。（現在の描画内容はすべて消去されます）">新規キャンバス</button>\r\n                    <br>\r\n                    <button id="button-changesize2" class="MSG mybutton size_big2"\r\n                        data-msg="現在の描画内容を残したまま、キャンバスのサイズを変更します。">画像を保持したままサイズ変更</button>\r\n                    <br>\r\n                    <br>\r\n                    <u>画像の書き出し</u><br>\r\n                    <button class="MSG mybutton size_big2" data-msg="描画内容をPNG形式ファイルとしてダウンロードします。ファイル名は現在日時が付与されます。"\r\n                        id="button-download">画像をPNG形式でファイルに保存</button>\r\n                    <br> <br>\r\n                    <u>キャンバスぼかし</u>\r\n                    <form id="config_antialiasing" class="radio_config config_data">\r\n                        <input type="radio" id="cfg0001" name="config_antialiasing" value="true"><label for="cfg0001"\r\n                            class="MSG" data-msg="ぼかし（アンチエイリアシング）を有効にします。">あり</label>\r\n                        <input type="radio" id="cfg0002" name="config_antialiasing" value="false" checked><label\r\n                            for="cfg0002" class="MSG" data-msg="ぼかし（アンチエイリアシング）を無効にします。（ドット絵がボケなくなります）">なし</label>\r\n                    </form>\r\n                    <br>\r\n\r\n                    <u>ポインタ座標の表示</u>\r\n                    <form id="config_display_position" class="radio_config config_data">\r\n                        <input type="radio" id="cfg0011" name="config_display_position" value="off" checked>\r\n                        <label for="cfg0011" class="MSG" data-msg="現在のポインタ座標を表示しません。">表示しない</label>\r\n                        <input type="radio" id="cfg0012" name="config_display_position" value="upperleft">\r\n                        <label for="cfg0012" class="MSG" data-msg="現在のポインタ座標を表示します。（位置：左上）">左上</label>\r\n                        \x3c!-- 左下は最小化アイコン表示用領域\r\n                        <input type="radio" id="cfg0013" name="config_display_position" value="lowerleft">\r\n                        <label for="cfg0013" class="MSG" data-msg="現在のポインタ座標を表示します。（位置：左下）">左下</label>\r\n                        --\x3e\r\n                        <input type="radio" id="cfg0014" name="config_display_position" value="upperright">\r\n                        <label for="cfg0014" class="MSG" data-msg="現在のポインタ座標を表示します。（位置：右上）">右上</label>\r\n                        <input type="radio" id="cfg0015" name="config_display_position" value="lowerright">\r\n                        <label for="cfg0015" class="MSG" data-msg="現在のポインタ座標を表示します。（位置：右下）">右下</label>\r\n                    </form><br>\r\n                </article>\r\n\r\n                \x3c!-- ツールウィンドウ --\x3e\r\n                <article>\r\n                    <u>ツールウィンドウ位置の記憶</u>\r\n                    <form id="config_init_windowposition" class="radio_config config_data">\r\n                        <input type="radio" id="cfg4001" name="config_init_windowposition" value="init">\r\n                        <label for="cfg4001" class="MSG" data-msg="ツール起動時、ウィンドウ配置を毎回初期化します。">初期化</label>\r\n                        <input type="radio" id="cfg4002" name="config_init_windowposition" value="last" checked><label\r\n                            for="cfg4002" class="MSG" data-msg="ツール起動時、ウィンドウ配置を前回終了時の位置に復元します。">記憶する</label>\r\n                    </form><br>\r\n                    <u>ツールウィンドウ位置の自動調整</u>\r\n                    <form id="config_resize_type" class="radio_config config_data">\r\n                        <input type="radio" id="cfg4021" name="config_resize_type" value="on" checked>\r\n                        <label for="cfg4021" class="MSG"\r\n                            data-msg="ブラウザの画面サイズを変更したとき、ウィンドウが画面内に収まるように自動調整を行います。">する</label>\r\n                        <input type="radio" id="cfg4022" name="config_resize_type" value="off"><label for="cfg4022"\r\n                            class="MSG" data-msg="ウィンドウ位置の自動調整を行いません。">しない</label>\r\n                    </form>\r\n                    <br>\r\n                    <u>位置初期化</u><br>\r\n                    <button id="axp-config-buttonResetWindow" class="MSG mybutton size_big2"\r\n                        data-msg="すべてのツールウィンドウの配置を初期状態に戻します。">全ウィンドウ位置の初期化</button>\r\n                    <br><br>\r\n                    <u>最小化アイコン配置</u>\r\n                    <form id="config_minimize_type" class="radio_config config_data">\r\n                        <input type="radio" id="cfg4011" name="config_minimize_type" value="horizontal" checked>\r\n                        <label for="cfg4011" class="MSG" data-msg="ツールウィンドウを最小化した時、アイコンを横並びで表示します。">横並び</label>\r\n                        <input type="radio" id="cfg4012" name="config_minimize_type" value="vertical"><label\r\n                            for="cfg4012" class="MSG" data-msg="ツールウィンドウを最小化した時、アイコンを縦並びで表示します。">縦並び</label>\r\n                    </form>\r\n                    <label>最小化アニメの所要時間<input id="config_minimize_duration" type="number" min="0" max="1000" value="350"\r\n                            size="4" class="MSG" data-msg="ウィンドウ最小化アニメーション効果の所要時間を設定します。1000ミリ秒=１秒">[ミリ秒]<br>\r\n                        （※最小0～最大1000。0を指定するとアニメ効果を省略します）</label>\r\n\r\n                </article>\r\n\r\n                \x3c!-- ペンツール --\x3e\r\n                <article>\r\n                    <u>ペンの太さ、不透明度の記憶</u>\r\n                    <form id="config_init_pen" class="radio_config config_data">\r\n                        <input type="radio" id="cfg4011" name="config_init_pen" value="init"><label for="cfg4011"\r\n                            class="MSG" data-msg="ツール起動時、ペンの太さ、不透明度を毎回初期化します。">初期化</label>\r\n                        <input type="radio" id="cfg4012" name="config_init_pen" value="last" checked><label\r\n                            for="cfg4012" class="MSG" data-msg="ツール起動時、ペンの太さ、不透明度を前回終了時の値に復元します。">記憶する</label>\r\n                    </form><br>\r\n                    <u>線のぼかし</u><br>\r\n                    <form id="config_pen_blur" class="radio_config config_data">\r\n                        <input type="radio" id="cfg5001" name="config_pen_blur" value="0" checked><label for="cfg5001"\r\n                            class="MSG" data-msg="描画する線に、ぼかしを適用しません。">なし</label>\r\n                        <input type="radio" id="cfg5002" name="config_pen_blur" value="1">\r\n                        <label for="cfg5002" class="MSG" data-msg="描画する線に、弱めのぼかしをかけます。">弱</label>\r\n                        <input type="radio" id="cfg5003" name="config_pen_blur" value="2">\r\n                        <label for="cfg5003" class="MSG" data-msg="描画する線に、中位のぼかしをかけます。">中</label>\r\n                        <input type="radio" id="cfg5004" name="config_pen_blur" value="3">\r\n                        <label for="cfg5004" class="MSG" data-msg="描画する線に、強めのぼかしをかけます。">強</label>\r\n                    </form>\r\n                    （※ドットペンは対象外）<br>\r\n                    <br>\r\n                    <u>明るさ補正レンジスライダー</u><br>\r\n                    <form id="config_range_brightness" class="radio_config config_data">\r\n                        <input type="radio" id="cfg5011" name="config_range_brightness" value="on">\r\n                        <label for="cfg5011" class="MSG" data-msg="明るさ補正レンジスライダーをペンツールに追加します。">あり</label>\r\n                        <input type="radio" id="cfg5012" name="config_range_brightness" value="off" checked><label\r\n                            for="cfg5012" class="MSG" data-msg="明るさ補正レンジスライダーを使用しません。">なし</label>\r\n                    </form>\r\n                    <br>\r\n                    <u>手ぶれ補正</u><br>\r\n                    <form id="config_stabilizer_use" class="radio_config config_data">\r\n                        <input type="radio" id="cfg5021" name="config_stabilizer_use" value="true" checked><label\r\n                            for="cfg5021" class="MSG" data-msg="手ぶれ補正を行い、よりなめらかな曲線を描画できるようにします。">あり</label>\r\n                        <input type="radio" id="cfg5022" name="config_stabilizer_use" value="false"><label for="cfg5022"\r\n                            class="MSG" data-msg="手ぶれ補正を使用しません。">なし</label>\r\n                    </form>\r\n                    <form oninput="result.value=parseInt(volume.value)" id="config_stabilizer_value"\r\n                        style="margin-top: 8px;">\r\n                        補正の強さ\r\n                        <input type="range" id="config_stabilizer" class="config_data" name="volume" value="2" step="1"\r\n                            min="1" max="10">\r\n                        <output name="result" for="volume">2</output>\r\n                    </form>\r\n                    <br>\r\n                    <u>スポイト</u><br>\r\n                    <label>色を取得時、自動的にペンに切り替える</label><input id="config_spuit_autochange" class="config_data"\r\n                        type="checkbox"><br>\r\n                </article>\r\n\r\n                \x3c!-- 色作成ツール --\x3e\r\n                <article>\r\n                    <u>使用する色作成ツール</u><br>\r\n                    <form id="config_makecolortype" class="radio_config config_data">\r\n                        <input type="radio" id="cfg1001" name="config_makecolortype" value="rgb_color"><label\r\n                            for="cfg1001" class="MSG" data-msg="光の三原色である赤、緑、青の強さを指定して作成するスタイルを使用します。">RGBｽﾗｲﾀﾞｰ</label>\r\n                        <input type="radio" id="cfg1002" name="config_makecolortype" value="picker">\r\n                        <label for="cfg1002" class="MSG" data-msg="色見本から指定して作成するスタイルを使用します。">ｶﾗｰﾋﾟｯｶｰ</label>\r\n                        <input type="radio" id="cfg1003" name="config_makecolortype" value="both" checked><label\r\n                            for="cfg1003" class="MSG" data-msg="両方のスタイルを同時に使用します。">両方</label>\r\n                    </form>\r\n                    <br>\r\n                    <u>使用するカラーピッカーのタイプ</u><br>\r\n                    <form id="config_pickertype" class="radio_config config_data">\r\n                        <input type="radio" id="cfg1011" name="config_pickertype" value="picker_box" checked><label\r\n                            for="cfg1011" class="MSG" data-msg="彩度と明度を指定する箱の色見本と、色相を指定するｽﾗｲﾀﾞｰを使用します。">箱タイプ</label>\r\n                        <input type="radio" id="cfg1012" name="config_pickertype" value="picker_wheel"><label\r\n                            for="cfg1012" class="MSG" data-msg="色相と彩度を指定する円の色見本と、明度を指定するｽﾗｲﾀﾞｰを使用します。">円タイプ</label>\r\n                    </form>\r\n                </article>\r\n\r\n                \x3c!-- カラーパレット --\x3e\r\n                <article>\r\n                    <u>パレット色の記憶</u>\r\n                    <form id="config_init_color" class="radio_config config_data">\r\n                        <input type="radio" id="cfg4021" name="config_init_color" value="init"><label for="cfg4021"\r\n                            class="MSG" data-msg="ツール起動時、カラーパレットを毎回初期化します。">初期化</label>\r\n                        <input type="radio" id="cfg4022" name="config_init_color" value="last" checked><label\r\n                            for="cfg4022" class="MSG" data-msg="ツール起動時、カラーパレットを前回終了時の色に復元します。">記憶する</label>\r\n                    </form><br>\r\n                    <u>パレットのエクスポート・インポート</u><br>\r\n                    \x3c!-- カラーパレットを表示するためのエリア --\x3e\r\n                    <div id="axp-config-palette_text"></div>\r\n                    <div id="axp-config-palette_scroll">\r\n                        <div id="axp-config-palette_box"></div>\r\n                    </div>\r\n                    <button id="button-color-save" class="MSG mybutton size_big2"\r\n                        data-msg="現在のカラーパレットの内容をテキストファイルとしてダウンロードします。">カラーパレットをファイルに保存</button>\r\n                    <br>\r\n                    <button id="button-color-load" class="MSG mybutton size_big2"\r\n                        data-msg="色保存で作成したテキストファイルを読み込み、カラーパレットを更新します。">保存したファイルの読込</button>\r\n                    <br><br>\r\n                    <u>パレットの初期化</u><br>\r\n                    <button id="button-color-reset" class="MSG mybutton size_big2"\r\n                        data-msg="カラーパレットを初期状態に戻します。">カラーパレットの初期化</button>\r\n                    <input type="file" id="file_colorload" accept=".txt" style="display: none;">\r\n                </article>\r\n\r\n                \x3c!-- レイヤー --\x3e\r\n                <article>\r\n                    <u>枠外ドロップによる削除</u><br>\r\n                    <form id="config_layer_delete" class="radio_config config_data">\r\n                        <input type="radio" id="cfg7001" name="config_layer_delete" value="on">\r\n                        <label for="cfg7001" class="MSG" data-msg="ツールウィンドウ枠外へドロップでレイヤーを削除する操作を有効にします。">有効</label>\r\n                        <input type="radio" id="cfg7002" name="config_layer_delete" value="off" checked><label\r\n                            for="cfg7002" class="MSG" data-msg="ツールウィンドウ枠外へドロップでレイヤーを削除する操作を無効にします。">無効</label>\r\n                    </form>\r\n                </article>\r\n\r\n                \x3c!-- 補助ツール --\x3e\r\n                <article>\r\n                    <u>左右反転／上下反転の対象</u><br>\r\n                    <form id="config_flip_layer" class="radio_config config_data">\r\n                        <input type="radio" id="cfg6001" name="config_flip_layer" value="all" checked>\r\n                        <label for="cfg6001" class="MSG" data-msg="すべてのレイヤーを反転します。">画像全体</label>\r\n                        <input type="radio" id="cfg6002" name="config_flip_layer" value="single">\r\n                        <label for="cfg6002" class="MSG" data-msg="選択中のレイヤーのみ反転します。">レイヤー単体</label>\r\n                    </form>\r\n                    <br>\r\n                    <u>グリッド線</u><br>\r\n                    <label>縦横個別に指定 </label><input id="config_grid_2way" class="config_data" type="checkbox"><br>\r\n\r\n                    <form oninput="result.value=parseInt(volume.value)" id="config_grid_division_horizontal_value"\r\n                        class="displaynone">\r\n                        分割数:横\r\n                        <input type="range" id="config_grid_division_horizontal" class="config_data" name="volume"\r\n                            value="8" step="1" min="2" max="16" class="MSG" data-msg="グリッド線の分割数を変更します。">\r\n                        <output name="result" for="volume">8</output>\r\n                    </form>\r\n\r\n                    <form oninput="result.value=parseInt(volume.value)" id="config_grid_division_vertical_value"\r\n                        class="displaynone">\r\n                        分割数:縦\r\n                        <input type="range" id="config_grid_division_vertical" class="config_data" name="volume"\r\n                            value="8" step="1" min="2" max="16" class="MSG" data-msg="グリッド線の分割数を変更します。">\r\n                        <output name="result" for="volume">8</output>\r\n                    </form>\r\n\r\n\r\n                    <form oninput="result.value=parseInt(volume.value)" id="config_grid_division_value">\r\n                        分割数\r\n                        <input type="range" id="config_grid_division" class="config_data" name="volume" value="8"\r\n                            step="1" min="2" max="16" class="MSG" data-msg="グリッド線の分割数を変更します。">\r\n                        <output name="result" for="volume">8</output>\r\n                    </form>\r\n                    <label>拡大率800%以上でドット単位グリッドを表示 </label><input id="config_grid_dot" class="config_data"\r\n                        type="checkbox" checked><br>\r\n                    <form id="config_grid_color" class="radio_config config_data">\r\n                        <input type="radio" id="cfg6011" name="config_grid_color" value="#000000" checked><label\r\n                            for="cfg6011" class="MSG" data-msg="グリッド線を黒色で表示します。">黒</label>\r\n                        <input type="radio" id="cfg6012" name="config_grid_color" value="#ffffff">\r\n                        <label for="cfg6012" class="MSG" data-msg="グリッド線を白色で表示します。">白</label>\r\n                    </form>\r\n\r\n                </article>\r\n\r\n                \x3c!-- マウス --\x3e\r\n                <article>\r\n                    <u>マウス右ボタン</u>\r\n                    <form id="config_rightbutton" class="radio_config config_data">\r\n                        <input type="radio" id="cfg2001" name="config_rightbutton" value="none">\r\n                        <label for="cfg2001" class="MSG" data-msg="ボタンに機能を割り当てません。">なし</label>\r\n                        <input type="radio" id="cfg2002" name="config_rightbutton" value="undo" checked>\r\n                        <label for="cfg2002" class="MSG" data-msg="ボタンでアンドゥを実行します。">アンドゥ</label>\r\n                        <input type="radio" id="cfg2003" name="config_rightbutton" value="spuit">\r\n                        <label for="cfg2003" class="MSG" data-msg="ボタンでスポイトを実行します。">スポイト</label>\r\n                        <input type="radio" id="cfg2004" name="config_rightbutton" value="hand">\r\n                        <label for="cfg2004" class="MSG" data-msg="ボタンを押しながらドラッグでキャンバスの位置を移動します。">ハンド</label>\r\n                        <input type="radio" id="cfg2005" name="config_rightbutton" value="loupe">\r\n                        <label for="cfg2005" class="MSG" data-msg="ボタンで拡大率とキャンバス位置をリセットします。">拡大率100%</label>\r\n                        <input type="radio" id="cfg2006" name="config_rightbutton" value="swapcolor"> <label\r\n                            for="cfg2006" class="MSG" data-msg="ボタンでメインカラーとサブカラーを切り替えます。">ﾒｲﾝ色切替</label>\r\n                        <input type="radio" id="cfg2007" name="config_rightbutton" value="swaptrans"> <label\r\n                            for="cfg2007" class="MSG" data-msg="ボタンでメインカラーと透明色を切り替えます。">透明色切替</label>\r\n                    </form>\r\n                    <br>\r\n                    <u>マウスホイールボタン</u>\r\n                    <form id="config_wheelbutton" class="radio_config config_data">\r\n                        <input type="radio" id="cfg2011" name="config_wheelbutton" value="none">\r\n                        <label for="cfg2011" class="MSG" data-msg="ボタンに機能を割り当てません。">なし</label>\r\n                        <input type="radio" id="cfg2012" name="config_wheelbutton" value="undo">\r\n                        <label for="cfg2012" class="MSG" data-msg="ボタンでアンドゥを実行します。">アンドゥ</label>\r\n                        <input type="radio" id="cfg2013" name="config_wheelbutton" value="spuit" checked>\r\n                        <label for="cfg2013" class="MSG" data-msg="ボタンでスポイトを実行します。">スポイト</label>\r\n                        <input type="radio" id="cfg2014" name="config_wheelbutton" value="hand">\r\n                        <label for="cfg2014" class="MSG" data-msg="ボタンを押しながらドラッグでキャンバスの位置を移動します。">ハンド</label>\r\n                        <input type="radio" id="cfg2015" name="config_wheelbutton" value="loupe">\r\n                        <label for="cfg2015" class="MSG" data-msg="ボタンで拡大率とキャンバス位置をリセットします。">拡大率100%</label>\r\n                        <input type="radio" id="cfg2016" name="config_wheelbutton" value="swapcolor"> <label\r\n                            for="cfg2016" class="MSG" data-msg="ボタンでメインカラーとサブカラーを切り替えます。">ﾒｲﾝ色切替</label>\r\n                        <input type="radio" id="cfg2017" name="config_wheelbutton" value="swaptrans"> <label\r\n                            for="cfg2017" class="MSG" data-msg="ボタンでメインカラーと透明色を切り替えます。">透明色切替</label>\r\n                    </form>\r\n                    <br>\r\n                    <u>マウスホイール回転</u>\r\n                    <form id="config_wheel" class="radio_config config_data">\r\n                        <input type="radio" id="cfg2021" name="config_wheel" value="none">\r\n                        <label for="cfg2021" class="MSG" data-msg="ホイールに機能を割り当てません。">なし</label>\r\n                        <input type="radio" id="cfg2022" name="config_wheel" value="loupe" checked>\r\n                        <label for="cfg2022" class="MSG" data-msg="ホイールでキャンバスを拡大/縮小します。">拡大/縮小</label>\r\n                        <input type="radio" id="cfg2023" name="config_wheel" value="scroll">\r\n                        <label for="cfg2023" class="MSG" data-msg="ホイールでキャンバスの位置を上下に移動します。">縦スクロール</label>\r\n                    </form>\r\n                    <label>回転方向反転 </label><input id="config_wheelcheckbox" class="config_data" type="checkbox" />\r\n\r\n                </article>\r\n\r\n                \x3c!-- キーボード --\x3e\r\n                <article>\r\n                    <u>方向キー</u>\r\n                    <form id="config_arrow" class="radio_config config_data">\r\n                        <input type="radio" id="cfg3001" name="config_arrow" value="none">\r\n                        <label for="cfg3001" class="MSG" data-msg="キーに機能を割り当てません。">なし</label>\r\n                        <input type="radio" id="cfg3002" name="config_arrow" value="move" checked>\r\n                        <label for="cfg3002" class="MSG" data-msg="キーでキャンバスの位置を上下左右に移動します。">キャンバス移動</label>\r\n                        <input type="radio" id="cfg3003" name="config_arrow" value="size">\r\n                        <label for="cfg3003" class="MSG" data-msg="左右でペンの太さ、上下で不透明度を変更します。">太さ/不透明度</label>\r\n                        <input type="radio" id="cfg3004" name="config_arrow" value="grid">\r\n                        <label for="cfg3004" class="MSG"\r\n                            data-msg="キーでグリッド線の分割数を変更します。（２軸の場合、左右で横軸、上下で縦軸を増減します）">ｸﾞﾘｯﾄﾞ分割数</label>\r\n                    </form>\r\n                    <label>キャンバス移動の移動量 <input id="config_movesize" type="number" min="1" max="100" value="30" size="3"\r\n                            class="MSG" data-msg="１回のボタン操作でキャンバス移動する量を指定します。">(1～100ドット)</label>\r\n                    <br>\r\n                    <br>\r\n                    <u>数字キー</u>\r\n                    <br>\r\n                    [1]:\r\n                    <select id="config_key_1" name="config_key_1" class="keyconfig"></select>\r\n                    <select id="config_key_1_option" name="config_key_1" class="keyconfig_option"></select>\r\n                    <input id="config_key_1_value" name="config_key_1" class="keyconfig_value">\r\n                    <br>\r\n                    [2]:\r\n                    <select id="config_key_2" name="config_key_2" class="keyconfig"></select>\r\n                    <select id="config_key_2_option" name="config_key_2" class="keyconfig_option"></select>\r\n                    <input id="config_key_2_value" name="config_key_2" class="keyconfig_value">\r\n                    <br>\r\n                    [3]:\r\n                    <select id="config_key_3" name="config_key_3" class="keyconfig"></select>\r\n                    <select id="config_key_3_option" name="config_key_3" class="keyconfig_option"></select>\r\n                    <input id="config_key_3_value" name="config_key_3" class="keyconfig_value">\r\n                    <br>\r\n                    [4]:\r\n                    <select id="config_key_4" name="config_key_4" class="keyconfig"></select>\r\n                    <select id="config_key_4_option" name="config_key_4" class="keyconfig_option"></select>\r\n                    <input id="config_key_4_value" name="config_key_4" class="keyconfig_value">\r\n                    <br>\r\n                    [5]:\r\n                    <select id="config_key_5" name="config_key_5" class="keyconfig"></select>\r\n                    <select id="config_key_5_option" name="config_key_5" class="keyconfig_option"></select>\r\n                    <input id="config_key_5_value" name="config_key_5" class="keyconfig_value">\r\n                    <br>\r\n                    [6]:\r\n                    <select id="config_key_6" name="config_key_6" class="keyconfig"></select>\r\n                    <select id="config_key_6_option" name="config_key_6" class="keyconfig_option"></select>\r\n                    <input id="config_key_6_value" name="config_key_6" class="keyconfig_value">\r\n                    <br>\r\n                    [7]:\r\n                    <select id="config_key_7" name="config_key_7" class="keyconfig"></select>\r\n                    <select id="config_key_7_option" name="config_key_7" class="keyconfig_option"></select>\r\n                    <input id="config_key_7_value" name="config_key_7" class="keyconfig_value">\r\n                    <br>\r\n                    [8]:\r\n                    <select id="config_key_8" name="config_key_8" class="keyconfig"></select>\r\n                    <select id="config_key_8_option" name="config_key_8" class="keyconfig_option"></select>\r\n                    <input id="config_key_8_value" name="config_key_8" class="keyconfig_value">\r\n                    <br>\r\n                    [9]:\r\n                    <select id="config_key_9" name="config_key_9" class="keyconfig"></select>\r\n                    <select id="config_key_9_option" name="config_key_9" class="keyconfig_option"></select>\r\n                    <input id="config_key_9_value" name="config_key_9" class="keyconfig_value">\r\n                    <br>\r\n                    <br>\r\n                    一括設定\r\n                    <button id="button_key_001" class="MSG mybutton size_big1"\r\n                        data-msg="[1]～[9]キーに拡大率を一括で割り当てます。（初期値）">拡大率</button>\r\n                    <button id="button_key_002" class="MSG mybutton size_big1"\r\n                        data-msg="[1]～[9]キーにペンの太さを一括で割り当てます。">ペンの太さ</button>\r\n\r\n                </article>\r\n\r\n                \x3c!-- ショートカット一覧 --\x3e\r\n                <article>\r\n                    <u>ショートカットキーの一覧</u>\r\n                    <table id="axp-config-shortcut_table">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>キー</th>\r\n                                <th>機能</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr>\r\n                                <td title="Background tile">[B]</td>\r\n                                <td>背景タイルプレビュー</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[C]</td>\r\n                                <td>メインカラー／透明色の切り替え</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Grid">[G]</td>\r\n                                <td>グリッド</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Horizontal flip">[H]</td>\r\n                                <td>左右反転</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Initialize">[I]</td>\r\n                                <td>ツールウィンドウの位置初期化</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Kai-ten">[K]</td>\r\n                                <td>現在選択中のレイヤーの画像を90°回転</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Load">[L]</td>\r\n                                <td>ロード</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Mirror image">[M]</td>\r\n                                <td>左右反転（全レイヤー）</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[Q]</td>\r\n                                <td>ペンの太さ調整</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Restore">[R]</td>\r\n                                <td>自動保存から復元</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Save">[S]</td>\r\n                                <td>セーブ</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Transparent">[T]</td>\r\n                                <td>背景透過</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[U]</td>\r\n                                <td>全面塗り潰し</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="Vertical flip">[V]</td>\r\n                                <td>上下反転</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td title="eXchange">[X]</td>\r\n                                <td>メインカラー／サブカラーの切り替え</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[Y]</td>\r\n                                <td>リドゥ</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[Z]</td>\r\n                                <td>アンドゥ</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[0]</td>\r\n                                <td>キャンバスの表示サイズの初期化</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[-]</td>\r\n                                <td>キャンバスの表示サイズ縮小</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[+]または[;]</td>\r\n                                <td>キャンバスの表示サイズ拡大</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[SPACE]</td>\r\n                                <td>ハンドツール</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[SHIFT]</td>\r\n                                <td>直線</td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>[CTRL]</td>\r\n                                <td>スポイト</td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                    ※[1]～[9]は、任意の機能を割り当てることができます。<br>\r\n                    ※方向キーは、キャンバスの位置移動、ペンの太さ/不透明度、グリッド分割数から選択。\r\n                </article>\r\n\r\n                \x3c!-- バージョン情報 --\x3e\r\n                <article>\r\n                    <u>バージョン情報</u><br>\r\n                    <div id="version_info"></div>\r\n                    © 2022<a href="https://com.nicovideo.jp/community/co1128854" target="_blank"\r\n                        style="text-decoration: none;color:#000">\r\n                        「悪の巣」部屋番号13番：「趣味の悪い大衆酒場[Mad end dance hall]」</a>\r\n                    <br><br>\r\n                    <div id="debug_mode" style="display:none;">\r\n                        <u>※ デバッグ機能 ※</u><br>\r\n                        <button id="button_web_001" class="MSG mybutton size_big2"\r\n                            data-msg="HTML5版お絵カキコ用の自動バックアップデータを作成します。">HTML5版お絵カキコへ画像を転送</button>\r\n                        <br>\r\n                        <button id="button_web_002" class="MSG mybutton size_big2"\r\n                            data-msg="（デバッグ用機能）レイヤーを含んだ画像データファイル(.axp)を作成します。">画像データファイル作成</button>\r\n                        <br>\r\n                        <button id="button_web_003" class="MSG mybutton size_big2"\r\n                            data-msg="（デバッグ用機能）レイヤーを含んだ画像データファイル(.axp)を読み込みます。">画像データファイル読込</button>\r\n                        <input type="file" id="file_dataload" accept=".axp" style="display: none;">\r\n                    </div>\r\n                </article>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</div>'),document.getElementById("version_info").textContent=this.axpObj.CONST.VERSION,this.axpObj.isDEBUG&&(document.getElementById("debug_mode").style.display="");const t=document.getElementsByClassName("keyconfig");for(const e of t)this.optionlist.forEach((t=>{const n=document.createElement("option");n.value=t.value,n.textContent=t.name,e.appendChild(n)}));this.config_key_defalut()}startEvent(){document.getElementById("label_canvas").onclick=t=>{this.axpObj.selectTab("1"),this.selectTab("0")},this.selectTab("0");document.querySelector("#axp-config-tab-section > ul").addEventListener("pointerdown",(t=>{"LI"==t.target.tagName&&this.selectTab(t.target.dataset.idx)}));const t=document.getElementsByClassName("config_data");for(const e of t)e.addEventListener("change",(t=>{let e=t.currentTarget.id,n=document.getElementById(e);switch(n.type){case"range":this.saveConfig(e,n.value);break;case"checkbox":this.saveConfig(e,n.checked);break;default:this.saveConfig(e,n.elements[e].value)}}));document.getElementById("oekaki_width").value=this.axpObj.x_size,document.getElementById("oekaki_height").value=this.axpObj.y_size,document.getElementById("oekaki_width").onchange=t=>{let e=this.axpObj.checkCanvasSize_x(document.getElementById("oekaki_width").value);document.getElementById("oekaki_width").value=e},document.getElementById("oekaki_height").onchange=t=>{let e=this.axpObj.checkCanvasSize_y(document.getElementById("oekaki_height").value);document.getElementById("oekaki_height").value=e},document.getElementById("axp-config-selectCanvasSizeHistory").addEventListener("change",(t=>{let e=t.target.value.split(","),n=e[0],i=e[1];document.getElementById("oekaki_width").value=n,document.getElementById("oekaki_height").value=i,this.saveConfig("oekaki_width",n),this.saveConfig("oekaki_height",i)})),document.getElementById("button-changesize1").onclick=t=>{let e=this.axpObj.checkCanvasSize_x(document.getElementById("oekaki_width").value),n=this.axpObj.checkCanvasSize_y(document.getElementById("oekaki_height").value);document.getElementById("oekaki_width").value=e,document.getElementById("oekaki_height").value=n,u(`現在の描画内容を破棄して新規キャンバス（${e}×${n}）を作成します。\nよろしいですか？\n（※この処理はアンドゥできません）`).then((()=>{this.axpObj.selectTab("0"),this.axpObj.setCanvasSize(e,n),this.axpObj.resetCanvas(),this.axpObj.layerSystem.createLayer(),this.axpObj.layerSystem.updateCanvas(),alert(`新規キャンバスを作成しました。横:${e} 縦:${n}`);let t=`${e},${n}`;for(let e=0;e<this.configCanvasSizeHistory.length;e++)this.configCanvasSizeHistory[e]==t&&this.configCanvasSizeHistory.splice(e,1);this.configCanvasSizeHistory.unshift(t),this.configCanvasSizeHistory.length>this.CONST.CANVAS_SIZE_HISTORY_MAX&&this.configCanvasSizeHistory.pop(),this.updateSelectCanvasSizeHistory(),this.saveConfig("canvas_size_history",this.configCanvasSizeHistory),this.axpObj.oekaki_id=null,this.axpObj.oekaki_bbs_pageno=null,this.axpObj.oekaki_bbs_title=null})).catch((t=>{}))},document.getElementById("button-changesize2").onpointerdown=t=>{if(null!==this.axpObj.oekaki_id)return void alert("「基にしてお絵カキコ」したキャンバスのサイズ変更はできません。");let e=this.axpObj.checkCanvasSize_x(document.getElementById("oekaki_width").value),n=this.axpObj.checkCanvasSize_y(document.getElementById("oekaki_height").value);document.getElementById("oekaki_width").value=e,document.getElementById("oekaki_height").value=n,u(`キャンバスサイズを${e}×${n}に変更します。\nよろしいですか？\n（※この処理はアンドゥできません）`).then((()=>{this.axpObj.selectTab("0");var t=this.axpObj.layerSystem.layerObj.map((t=>({...t})));this.axpObj.setCanvasSize(e,n);let i=this.axpObj.layerSystem.CANVAS.tmp_ctx;for(let a of t)i.clearRect(0,0,e,n),i.putImageData(a.image,0,0),a.image=i.getImageData(0,0,e,n);var a={version:this.axpObj.saveSystem.CONST.DATA_VERSION,id:null,created:null,src:null,x_max:e,y_max:n,counter:this.axpObj.layerSystem.layer_counter,layer:t};this.axpObj.saveSystem.restoreLayer(a),t=null,a=null,alert(`キャンバスサイズを変更しました。横:${e} 縦:${n}`)})).catch((t=>{}))},document.getElementById("config_antialiasing").onchange=t=>{this.set_canvas_antialiasing()},document.getElementById("button-download").onmousedown=t=>{this.axpObj.TASK.func_download()},document.getElementById("config_display_position").onchange=t=>{this.set_display_position()},document.getElementById("axp-config-buttonResetWindow").addEventListener("click",(t=>{this.axpObj.dragWindow.resetPosition(),alert("全ウィンドウ位置を初期化しました。")})),document.getElementById("config_resize_type").onchange=t=>{this.axpObj.dragWindow.changeAutoAdjustPosition()},document.getElementById("config_minimize_type").onchange=t=>{let e=document.getElementById("config_minimize_type").elements.config_minimize_type.value;this.axpObj.setMinimizeType(e)},document.getElementById("config_minimize_duration").onchange=t=>{let e=document.getElementById("config_minimize_duration").value;isNaN(e)&&(e=350),e=Math.min(e,1e3),document.getElementById("config_minimize_duration").value=e,this.saveConfig("config_minimize_duration",e)},document.getElementById("config_range_brightness").onchange=t=>{this.axpObj.penSystem.changePenMode()},document.getElementById("config_stabilizer_use").onchange=t=>{this.set_stabilizer_use()},document.getElementById("config_makecolortype").onchange=t=>{this.axpObj.colorMakerSystem.updateMakeColorType()},document.getElementById("config_pickertype").onchange=t=>{this.axpObj.colorMakerSystem.updatePickerType()},document.getElementById("button-color-save").onclick=t=>{let e=new Array;e.push("column,"+this.axpObj.colorPaletteSystem.currentPalette.column+"\n"),e.push("side,"+this.axpObj.colorPaletteSystem.currentPalette.side+"\n");let n=this.axpObj.colorPaletteSystem.getPaletteLength();for(let t=0;t<n;t++)e.push(this.axpObj.colorPaletteSystem.getColor(t)+"\n");var i="ap_color"+g(new Date,"YYYYMMDD_hhmmss")+".txt",a=new Blob(e,{type:"text/plain"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download=i,s.click()},document.getElementById("button-color-load").onclick=t=>{document.getElementById("file_colorload").click()},document.getElementById("file_colorload").onclick=t=>{t.target.value=""},document.getElementById("file_colorload").onchange=t=>{var e=t.target.files;if(0!==e.length){var n=new FileReader;n.readAsText(e[0]),n.onload=()=>{var t=n.result.split(/\r\n|\n/),e=t.length-1;if(0===e)return void alert("有効なデータファイルではありません。");let i={name:null,column:5,side:!1,palette:[]};for(var a=0;a<e;a++){let e=t[a];if("column"===e.substr(0,6)){let t=e.split(",")[1];if(isNaN(t)||!c(Number(t),1,this.axpObj.colorPaletteSystem.CONST.COLOR_MAX))return void alert("columnが不正な値のため、読込を中止しました。\n行数:"+(a+1)+" 内容:"+e);i.column=Number(t);continue}if("side"===e.substr(0,4)){switch(e.split(",")[1]){case"true":i.side=!0;break;case"false":i.side=!1;break;default:return void alert("sideが不正な値のため、読込を中止しました。\n行数:"+(a+1)+" 内容:"+e)}continue}if(i.palette.length>=this.axpObj.colorPaletteSystem.CONST.COLOR_MAX)break;let n=e;if(!m(n))return void alert("カラーコードに誤りがあるため、読込を中止しました。\n行数:"+(a+1)+" 内容:"+e);i.palette.push(n)}0!==i.palette.length?(this.axpObj.colorPaletteSystem.setPaletteArray(i.palette),this.axpObj.colorPaletteSystem.currentPalette.column=i.column,this.axpObj.colorPaletteSystem.currentPalette.side=i.side,this.axpObj.colorPaletteSystem.createPalette(),this.dispPalettebox(document.getElementById("axp-config-palette_box"),i),this.axpObj.saveSystem.save_palette(i.palette),this.axpObj.configSystem.saveConfig("window_palette_column",i.column),this.axpObj.configSystem.saveConfig("window_sidebutton",i.side),alert("カラーパレットを正常に読み込みました。\nパレット数:"+i.palette.length)):alert("パレットデータが１色もありません。")}}},document.getElementById("button-color-reset").onclick=t=>{u("カラーパレットを初期状態に戻します。\nよろしいですか？\n（※この処理はアンドゥできません）").then((()=>{this.axpObj.colorPaletteSystem.setPaletteArray(),this.axpObj.colorPaletteSystem.createPalette(),this.dispPalettebox(document.getElementById("axp-config-palette_box"),this.axpObj.colorPaletteSystem.currentPalette),this.axpObj.saveSystem.save_palette(this.axpObj.colorPaletteSystem.currentPalette.palette),this.axpObj.configSystem.saveConfig("window_palette_column",this.axpObj.colorPaletteSystem.currentPalette.column),this.axpObj.configSystem.saveConfig("window_sidebutton",this.axpObj.colorPaletteSystem.currentPalette.side),alert("カラーパレットを初期化しました。")})).catch((t=>{}))},document.getElementById("config_grid_division_vertical").oninput=document.getElementById("config_grid_division_horizontal").oninput=document.getElementById("config_grid_division").oninput=t=>{this.axpObj.assistToolSystem.setGridDivision()},document.getElementById("config_grid_dot").onchange=t=>{this.axpObj.dispGridDot()},document.getElementById("config_grid_color").onchange=t=>{this.axpObj.assistToolSystem.set_grid_color()},document.getElementById("config_grid_2way").onchange=t=>{this.axpObj.assistToolSystem.set_grid_2way()},document.getElementById("config_movesize").onchange=t=>{var e=document.getElementById("config_movesize").value;e<1&&(e=1),e>100&&(e=100),document.getElementById("config_movesize").value=e,this.saveConfig("config_movesize",e)};const e=document.getElementsByClassName("keyconfig");for(const t of e)t.addEventListener("change",(t=>{this.config_key_option_set(t.target,null)}));const n=document.querySelectorAll(".keyconfig,.keyconfig_option,.keyconfig_value");for(const t of n)t.addEventListener("change",(t=>{let e=t.currentTarget.id,n=document.getElementById(e);this.config_key_change(n)}));document.getElementById("button_key_001").onclick=t=>{u("[1]～[9]キーに拡大率を割り当てます。\nよろしいですか？\n（※現在の設定は上書きされます）").then((()=>{this.config_key_defalut();const t=document.getElementsByClassName("keyconfig");for(const e of t)this.configObj.delete(e.id);this.saveConfig(),alert("[1]～[9]キーに拡大率を割り当てました。")})).catch((t=>{}))},document.getElementById("button_key_002").onclick=t=>{u("[1]～[9]キーにペンの太さを割り当てます。\nよろしいですか？\n（※現在の設定は上書きされます）").then((()=>{const t=document.getElementsByClassName("keyconfig");let e=1;for(const n of t)n.value="func_size",this.config_key_option_set(n,e),e++;for(const e of t)this.config_key_change(e);alert("[1]～[9]キーにペンの太さを割り当てました。")})).catch((t=>{}))},document.getElementById("button_web_001").onclick=t=>{"USERSCRIPT"===this.axpObj.exec_env?u("HTML5版お絵カキコの自動バックアップに画像を転送します。\n（※現在のHTML5版お絵カキコの自動バックアップ履歴はすべて消去されます）\nよろしいですか？").then((()=>{const t=localStorage.length;let e=0;for(let n=0;n<t;n++){let t=localStorage.key(e);-1!=t.lastIndexOf("img_",0)?localStorage.removeItem(t):e++}let n="img_"+(new Date).getTime(),i=this.axpObj.layerSystem.getCanvas().toDataURL("image/png");localStorage.setItem(n,i),alert("HTML5版お絵カキコの自動バックアップに画像を転送しました。")})).catch((t=>{})):alert("ユーザースクリプト版専用機能です。\nこの環境では使用できません。")},document.getElementById("button_web_002").onclick=t=>{for(var e=[],n=this.axpObj.layerSystem.layerObj,i=0;i<n.length;i++)e[i]=new T(n[i]),e[i].mode=n[i].mode,e[i].alpha=n[i].alpha,e[i].checked=n[i].checked,e[i].locked=n[i].locked,e[i].masked=n[i].masked,e[i].index=n[i].index,e[i].name=n[i].name,e[i].image=n[i].image;for(i=0;i<e.length;i++)this.axpObj.layerSystem.CANVAS.tmp_ctx.putImageData(e[i].image,0,0),e[i].image=this.axpObj.layerSystem.CANVAS.tmp.toDataURL();var a={id:"file",version:this.axpObj.saveSystem.CONST.DATA_VERSION,created:new Date,src:this.axpObj.assistToolSystem.CANVAS.thumbnail.toDataURL(),x_max:this.axpObj.x_size,y_max:this.axpObj.y_size,counter:this.axpObj.layerSystem.layer_counter,layer:e,oekaki_id:this.axpObj.oekaki_id,oekaki_bbs_pageno:this.axpObj.oekaki_bbs_pageno,oekaki_bbs_title:this.axpObj.oekaki_bbs_title},s="ap_data"+g(new Date,"YYYYMMDD_hhmmss")+".axp",r=new Blob([JSON.stringify(a)],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(r),o.download=s,o.click()},document.getElementById("button_web_003").onclick=t=>{document.getElementById("file_dataload").click()},document.getElementById("file_dataload").onchange=t=>{var e=t.target.files;if(0!==e.length){var n=new FileReader;n.readAsText(e[0]),n.onload=()=>{var t=JSON.parse(n.result),e=Number(t.x_max),i=Number(t.y_max);this.axpObj.layerSystem.CANVAS.tmp.width=e,this.axpObj.layerSystem.CANVAS.tmp.height=i,this.axpObj.layerSystem.CANVAS.tmp_ctx.globalCompositeOperation="source-over",this.axpObj.layerSystem.CANVAS.tmp_ctx.globalAlpha=1,(async()=>{for(var n=0;n<t.layer.length;n++){var a=await this.loadImage(t.layer[n].image);this.axpObj.layerSystem.CANVAS.tmp_ctx.clearRect(0,0,e,i),this.axpObj.layerSystem.CANVAS.tmp_ctx.drawImage(a,0,0),t.layer[n].image=this.axpObj.layerSystem.CANVAS.tmp_ctx.getImageData(0,0,e,i)}this.axpObj.selectTab("0"),this.axpObj.saveSystem.restoreLayer(t),alert("データを読み込みました。")})()},t.target.value=""}}}async loadImage(t){var e=null,n=new Promise((function(n){(e=new Image).onload=function(){n()},e.src=t}));return await n,e}config_key_defalut(){const t=document.getElementsByClassName("keyconfig");let e=4;for(const n of t)n.value="func_loupe",this.config_key_option_set(n,e),e++}config_key_option_set(t,e){let n=document.getElementById(t.id+"_option"),i=document.getElementById(t.id+"_value");for(;n.firstChild;)n.removeChild(n.firstChild);const a=[25,33,50,66,100,150,200,250,300,400,600,800,1200,1600];switch(t.value){case"func_loupe":let t=0;for(const e of a){const i=document.createElement("option");i.value=String(t),i.textContent=e+"%",n.appendChild(i),t++}n.selectedIndex=null!==e?e:4,n.classList.remove("displaynone"),i.classList.add("displaynone");break;case"func_size":i.setAttribute("type","number"),i.setAttribute("maxlength","3"),i.setAttribute("min","1"),i.setAttribute("max","200"),i.setAttribute("size","3"),i.value=null!==e?e:1,n.classList.add("displaynone"),i.classList.remove("displaynone");break;default:n.classList.add("displaynone"),i.classList.add("displaynone")}}config_key_change(t){let e=document.getElementById(t.name),n=document.getElementById(t.name+"_option"),i=document.getElementById(t.name+"_value");switch(e.value){case"func_loupe":this.saveConfig(e.id,e.value+","+n.value);break;case"func_size":Number(i.value)>Number(i.max)&&(i.value=i.max),Number(i.value)<Number(i.min)&&(i.value=i.min),this.saveConfig(e.id,e.value+","+i.value);break;default:this.saveConfig(e.id,e.value)}}updateSelectCanvasSizeHistory(){let t=document.getElementById("axp-config-selectCanvasSizeHistory");for(;t.lastChild;)t.removeChild(t.lastChild);for(const e of this.configCanvasSizeHistory){let n=document.createElement("option"),i=e.split(","),a=i[0],s=i[1];n.text=`${a} × ${s}`,n.value=e,t.appendChild(n)}}set_canvas_antialiasing(){"true"===config_antialiasing.elements.config_antialiasing.value?this.axpObj.CANVAS.main.style.imageRendering="auto":this.axpObj.CANVAS.main.style.imageRendering="pixelated"}set_display_position(){const t=document.getElementById("axp-canvas-display-position");switch(config_display_position.config_display_position.value){case"off":t.classList.add("displaynone");break;case"upperleft":t.classList.remove("displaynone"),t.style.right="auto",t.style.bottom="auto";break;case"lowerleft":t.classList.remove("displaynone"),t.style.right="auto",t.style.bottom="0";break;case"upperright":t.classList.remove("displaynone"),t.style.right="0",t.style.bottom="auto";break;case"lowerright":t.classList.remove("displaynone"),t.style.right="0",t.style.bottom="0"}}set_stabilizer_use(){"true"===document.getElementById("config_stabilizer_use").elements.config_stabilizer_use.value?(document.getElementById("config_stabilizer").disabled=!1,document.getElementById("config_stabilizer_value").style.opacity="1"):(document.getElementById("config_stabilizer").disabled=!0,document.getElementById("config_stabilizer_value").style.opacity="0.3")}saveConfig(t,e){void 0!==t&&this.configObj.set(t,e),this.axpObj.saveSystem.save_config(this.configObj)}deleteConfig(t){this.configObj.delete(t),this.axpObj.saveSystem.save_config(this.configObj)}restoreConfig(t){let e=this.axpObj.penSystem.penObj;t.forEach(((t,n)=>{let i=!0;switch(n){case"oekaki_width":document.getElementById("oekaki_width").value=t;break;case"oekaki_height":document.getElementById("oekaki_height").value=t;break;case"config_minimize_duration":document.getElementById("config_minimize_duration").value=t;break;case"config_wheelcheckbox":document.getElementById("config_wheelcheckbox").checked=t;break;case"config_spuit_autochange":document.getElementById("config_spuit_autochange").checked=t;break;case"config_stabilizer":document.getElementById("config_stabilizer").value=t,document.getElementById("config_stabilizer_value").result.value=t;break;case"config_grid_dot":document.getElementById("config_grid_dot").checked=t;break;case"config_grid_2way":document.getElementById("config_grid_2way").checked=t,this.axpObj.assistToolSystem.set_grid_2way();break;case"config_grid_division":document.getElementById("config_grid_division").value=t,document.getElementById("config_grid_division_value").result.value=t,this.axpObj.assistToolSystem.setGridDivision();break;case"config_grid_division_vertical":document.getElementById("config_grid_division_vertical").value=t,document.getElementById("config_grid_division_vertical_value").result.value=t,this.axpObj.assistToolSystem.setGridDivision();break;case"config_grid_division_horizontal":document.getElementById("config_grid_division_horizontal").value=t,document.getElementById("config_grid_division_horizontal_value").result.value=t,this.axpObj.assistToolSystem.setGridDivision();break;case"config_movesize":document.getElementById("config_movesize").value=Number(t);break;case"canvas_size_history":this.configCanvasSizeHistory=t,this.updateSelectCanvasSizeHistory();break;default:if("window_potison"===n.substr(0,14)){var a=t.split(","),s=a[0],r=a[1],o=a[2];this.axpObj.dragWindow.setInitPosition(s,r,o)||(i=!1)}else if("window_palette_column"===n.substr(0,21))t&&(this.axpObj.colorPaletteSystem.currentPalette.column=t);else if("window_sidebutton"===n.substr(0,17))t&&(this.axpObj.colorPaletteSystem.currentPalette.side=!0);else if("color"===n.substr(0,5));else if("size"===n.substr(0,4)){(l=n.substr(5))in e?(e[l].size=t,e[l].index=y(t)):i=!1}else if("alpha"===n.substr(0,5)){(l=n.substr(6))in e?e[l].alpha=t:i=!1}else if("threshold"===n.substr(0,9)){var l;(l=n.substr(10))in e?e[l].threshold=t:i=!1}else if("config_key"===n.substr(0,10)){let e=document.getElementById(n),i=t.split(",");e.value=i[0],i.length>1?this.config_key_option_set(e,i[1]):this.config_key_option_set(e,null)}else{let e=document.getElementsByName(n),a=!1;for(var d=0;d<e.length;d++)e[d].value===t&&(e[d].checked=!0,a=!0);if(a)switch(n){case"config_antialiasing":this.set_canvas_antialiasing();break;case"config_display_position":this.set_display_position();break;case"config_minimize_type":this.axpObj.setMinimizeType(t);break;case"config_range_brightness":default:break;case"config_stabilizer_use":this.set_stabilizer_use();break;case"config_pickertype":this.axpObj.colorMakerSystem.updatePickerType();break;case"config_makecolortype":this.axpObj.colorMakerSystem.updateMakeColorType();break;case"config_grid_color":this.axpObj.assistToolSystem.set_grid_color()}else i=!1}}i&&this.configObj.set(n,t)}))}selectTab(t){document.querySelectorAll("#axp-config-tab-section > ul > li").forEach((e=>{e.dataset.idx===t?e.classList.add("selected"):e.classList.remove("selected")}));var e=document.querySelectorAll("#axp-config-right > div > article");e.forEach((t=>{t.style.display="none"})),e[Number(t)].style.display="block"}dispPalettebox(t,e){for(;t.firstChild;)t.removeChild(t.firstChild);t.style.width=8+22*e.column+"px";let n=e.palette.length,i=e.column,a=`${n}色（${i}列×${Math.ceil(n/i)}行）`;document.getElementById("axp-config-palette_text").textContent=a;for(const n of e.palette)t.appendChild((s=n,r=void 0,(r=document.createElement("div")).setAttribute("class","coloricon_mini"),r.style.backgroundColor=s,r));var s,r}}n(7995);class fe{axpObj;CONST={X_POST_MAX:120,Y_POST_MAX:120};CANVAS={post:null,post_ctx:null,thumbnail:null,thumbnail_ctx:null};constructor(t){this.axpObj=t}init(){document.getElementById("axp-post").insertAdjacentHTML("afterbegin",'<div id="axp-post-menu">\r\n    \x3c!-- 投稿（ブラウザ用） --\x3e\r\n    <div id="axp-post-content">\r\n        <div id="axp-post-main">\r\n\r\n            <u>投稿するお絵カキコ</u><br>\r\n\r\n            <div style="display: flex; flex-direction: row; flex-wrap: wrap; gap: 10px;">\r\n                <canvas id="axp-post-canvas-post" style="height: fit-content;" class="axp-mesh"></canvas>\r\n                <div style="width:140px;height: fit-content;">\r\n                    ｻﾑﾈｲﾙ\r\n                    <div class="menu-oekaki_list-thumb">\r\n                        <canvas id="axp-post-canvas-thumbnail" class="axp-mesh"></canvas>\r\n                    </div>\r\n                    <div id="axp-post-canvas-thumbnail-title">\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <table id="axp-post-information_table">\r\n                <tbody>\r\n                    <tr>\r\n                        <td title="">基にしたお絵カキコ</td>\r\n                        <td><label id="axp-post-information_table-ref"></label>\r\n                            <a href="" id="axp-post-information_table-refid" target="_blank"></a>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td title="">お絵カキコのサイズ</td>\r\n                        <td><label id="axp-post-information_table-size"></label></td>\r\n                    </tr>\r\n\r\n                    <tr>\r\n                        <td title="補助ツールの背景透過のオン/オフ状態が反映されます">背景の透過</td>\r\n                        <td><label id="axp-post-information_table-transparent"></label></td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n            <br>\r\n            <u>投稿情報の入力</u><br>\r\n            <div>\r\n                <label id="axp-post-message"></label>\r\n                <table id="axp-post-postform_table">\r\n                    <tr>\r\n                        <td class="axp-post-postform_table-td">投稿者名</td>\r\n                        <td>\r\n                            <input id="NAM" class="TitleInput" type="text" maxlength="32" size="40" value="" />\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="axp-post-postform_table-td">タイトル</td>\r\n                        <td>\r\n                            <input id="TIT" class="TitleInput" type="text" maxlength="32" size="40" value="" />\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td class="axp-post-postform_table-td">本文(必須)</td>\r\n                        <td>\r\n                            <textarea id="MES" class="TitleInput" required minlength="1" maxlength="1024"\r\n                                style="min-width:480px;max-width:480px;width:480px;max-height:200px;height: 100px;"></textarea>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td></td>\r\n                        <td>\r\n                            <label><input id="WLT" type="checkbox" />ウォッチリストに登録</label>\r\n                        </td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td colspan="2" style="text-align: center;">\r\n                            <button id="UploadButton" class="MSG mybutton size_big2" data-msg="お絵カキコを投稿します。"\r\n                                data-buttontext="お絵カキコする！"></button>\r\n                        </td>\r\n                    </tr>\r\n                </table>\r\n                <textarea id="htmldata" rows="1" cols="1" style="display: none;"></textarea>\r\n            </div>\r\n\r\n\r\n        </div>\r\n    </div>\r\n</div>'),this.CANVAS.post=document.getElementById("axp-post-canvas-post"),this.CANVAS.post_ctx=this.CANVAS.post.getContext("2d"),this.CANVAS.thumbnail=document.getElementById("axp-post-canvas-thumbnail"),this.CANVAS.thumbnail_ctx=this.CANVAS.thumbnail.getContext("2d")}resetCanvas(){let t=this.axpObj.x_size,e=this.axpObj.y_size;this.CANVAS.post.width=t,this.CANVAS.post.height=e,this.CANVAS.post_ctx.clearRect(0,0,t,e),this.CANVAS.thumbnail.width=this.CONST.X_POST_MAX,this.CANVAS.thumbnail.height=this.CONST.Y_POST_MAX,this.CANVAS.thumbnail_ctx.setTransform(1,0,0,1,0,0),this.CANVAS.thumbnail_ctx.clearRect(0,0,this.CONST.X_POST_MAX,this.CONST.Y_POST_MAX);var n=this.CONST.X_POST_MAX/Math.max(t,e);this.CANVAS.thumbnail_ctx.scale(n,n),document.getElementById("axp-post-information_table-size").textContent=`横:${t} 縦:${e}`}startEvent(){document.getElementById("TIT").oninput=t=>{let e=t.target.value;document.getElementById("axp-post-canvas-thumbnail-title").textContent=e},document.getElementById("UploadButton").onclick=t=>{let e=document.getElementById("MES").value.trim();if(e.length<1)return void(document.getElementById("axp-post-message").textContent="※本文を入力してください");document.getElementById("UploadButton").textContent="投稿中です………",document.getElementById("UploadButton").disabled=!0;let n=this.CANVAS.post.toDataURL("image/png");n=n.replace("data:image/png;base64,","");let i={strName:document.getElementById("NAM").value.trim(),strTitle:document.getElementById("TIT").value.trim(),strMessage:e,strWatchList:document.getElementById("WLT").checked?"t":"",oekaki_id:this.axpObj.oekaki_id,strEncodeImg:n};(async()=>{let t;try{t=await this.axpObj.FUNCTION.post(i)}catch(t){}finally{document.getElementById("UploadButton").textContent=document.getElementById("UploadButton").dataset.buttontext,document.getElementById("UploadButton").disabled=!1}})()}}}class ve{axpObj;dbSystem;isDBAvailable;autosave_counter;CONST={AUTOSAVE_INTERVAL:10,STORE_NAME_SAVE_MANUAL:"save_manual",STORE_NAME_SAVE_AUTO:"save_auto",STORE_NAME_CONFIG:"save_config",STORE_NAME_PALETTE:"save_palette"};constructor(t){this.axpObj=t,this.dbSystem=new Se(this),this.autosave_counter=0}init(){}async initDB(){let t;try{t=await this.dbSystem.initIndexedDB(),t?this.isDBAvailable=!0:(alert("エラー:ブラウザのIndexedDBが無効になっています。\nセーブ/ロード機能などは利用できません。"),this.isDBAvailable=!1)}catch(t){alert("エラー:IndexedDBの初期化に失敗しました。\nセーブ/ロード機能などは利用できません。"),this.isDBAvailable=!1}return this.isDBAvailable}autoSave(){if(this.isDBAvailable&&(this.autosave_counter++,this.autosave_counter>=this.CONST.AUTOSAVE_INTERVAL)){this.autosave_counter=0;var t={created:new Date,version:this.CONST.DATA_VERSION,src:this.axpObj.assistToolSystem.CANVAS.thumbnail.toDataURL(),x_max:this.axpObj.x_size,y_max:this.axpObj.y_size,counter:this.axpObj.layerSystem.layer_counter,layer:this.axpObj.layerSystem.layerObj,oekaki_id:this.axpObj.oekaki_id,oekaki_bbs_pageno:this.axpObj.oekaki_bbs_pageno,oekaki_bbs_title:this.axpObj.oekaki_bbs_title};(async()=>{await this.dbSystem.autosaveToDB(t,this.CONST.STORE_NAME_SAVE_AUTO).then((()=>{}),(()=>{}))})()}}startEvent(){document.getElementById("saveload").onclick=document.getElementById("button_close_saveload").onclick=t=>{for(var e=document.getElementById("entry");e.childElementCount;)e.removeChild(e.firstElementChild);this.axpObj.isModalOpen=!1,document.getElementById("saveload").style.display="none"}}openSaveWindow(){this.isDBAvailable?(document.getElementById("modal_label").textContent="セーブするスロットを選択（※既に保存されている画像は上書きされます）",this.axpObj.isModalOpen=!0,document.getElementById("saveload").style.display="block",(async()=>{await this.dbSystem.dispEntry().then((()=>{var t=document.getElementById("entry").children;for(let e=0;e<t.length;e++)t[e].onclick=t=>{this.clickSaveSlot(t)}}),(()=>{alert("エラー：セーブデータを保存できませんでした。")}))})()):this.axpObj.msg("現在セーブ/ロード機能は使用できません。ヘルプをご確認下さい。","caution")}openLoadWindow(){this.isDBAvailable?(document.getElementById("modal_label").textContent="ロードするスロットを選択（※現在の描画内容は破棄されます）",this.axpObj.isModalOpen=!0,document.getElementById("saveload").style.display="block",(async()=>{await this.dbSystem.dispEntry().then((()=>{var t=document.getElementById("entry").children;for(let e=0;e<t.length;e++)t[e].onclick=t=>{this.clickLoadSlot(t)}}),(()=>{alert("エラー：セーブデータを読込できませんでした。")}))})()):this.axpObj.msg("現在セーブ/ロード機能は使用できません。ヘルプをご確認下さい。","caution")}openRestoreWindow(){this.isDBAvailable?(document.getElementById("modal_label").textContent="自動バックアップ（10ストローク毎に保存）を選択（※現在の描画内容は破棄されます）",this.axpObj.isModalOpen=!0,document.getElementById("saveload").style.display="block",(async()=>{await this.dbSystem.dispEntryAutoSave().then((()=>{var t=document.getElementById("entry").children;for(let e=0;e<t.length;e++)t[e].onclick=t=>{this.clickRestoreSlot(t)}}),(()=>{alert("エラー：セーブデータを読込できませんでした。")}))})()):this.axpObj.msg("現在セーブ/ロード機能は使用できません。ヘルプをご確認下さい。","caution")}clickSaveSlot(t){const e=t.currentTarget.id;var n={id:e,version:this.CONST.DATA_VERSION,created:new Date,src:this.axpObj.assistToolSystem.CANVAS.thumbnail.toDataURL(),x_max:this.axpObj.x_size,y_max:this.axpObj.y_size,counter:this.axpObj.layerSystem.layer_counter,layer:this.axpObj.layerSystem.layerObj,oekaki_id:this.axpObj.oekaki_id,oekaki_bbs_pageno:this.axpObj.oekaki_bbs_pageno,oekaki_bbs_title:this.axpObj.oekaki_bbs_title};(async()=>{await this.dbSystem.saveToDB(n,this.CONST.STORE_NAME_SAVE_MANUAL).then((()=>{this.axpObj.msg(`スロット${e.substr(5)}にセーブしました。`,"information")}),(()=>{alert("エラー：セーブデータが正常に読み込めませんでした。")}))})()}clickLoadSlot(t){const e=t.currentTarget.id;(async()=>{await this.dbSystem.loadFromDB(e,this.CONST.STORE_NAME_SAVE_MANUAL).then((t=>{void 0!==t.created?this.restore_oekaki_id(t)?(this.restoreLayer(t),this.axpObj.msg(`スロット${e.substr(5)}をロードしました。`,"information")):alert(t.oekaki_bbs_title+"\nに投稿された画像を基にしているため、別の掲示板には投稿できません。\n同一の掲示板でロードしてください。"):this.axpObj.msg(`スロット${e.substr(5)}にはデータがありません。`,"caution")}),(()=>{alert("エラー：セーブデータが正常に読み込めませんでした。")}))})()}clickRestoreSlot(t){const e=t.currentTarget.id;(async()=>{await this.dbSystem.loadFromDB(Number(e),this.CONST.STORE_NAME_SAVE_AUTO).then((t=>{this.restore_oekaki_id(t)?(this.restoreLayer(t),this.axpObj.msg("自動保存されたデータをロードしました。","information")):alert(t.oekaki_bbs_title+"\nに投稿された画像を基にしているため、別の掲示板には投稿できません。\n同一の掲示板でロードしてください。")}),(()=>{alert("エラー：セーブデータが正常に読み込めませんでした。")}))})()}restore_oekaki_id(t){if(void 0!==t.oekaki_id&&null!==t.oekaki_id){if(this.axpObj.useSameBBSCheck&&t.oekaki_bbs_pageno!==this.axpObj.post_bbs_pageno)return!1;this.axpObj.oekaki_id=t.oekaki_id,this.axpObj.oekaki_bbs_pageno=t.oekaki_bbs_pageno,this.axpObj.oekaki_bbs_title=t.oekaki_bbs_title}else this.axpObj.oekaki_id=null,this.axpObj.oekaki_bbs_pageno=null,this.axpObj.oekaki_bbs_title=null;return!0}restoreLayer(t){if(this.axpObj.x_size=t.x_max,this.axpObj.y_size=t.y_max,this.axpObj.resetCanvas(),this.axpObj.layerSystem.setLayerCounter(t.counter),(t.version?t.version:0)<2){Array.prototype.reverse.call(t.layer);for(let e=0;e<t.layer.length;e++)t.layer[e].index=e}for(let e=0;e<t.layer.length;e++)this.axpObj.layerSystem.createLayer({layerObj:t.layer[e]});this.axpObj.layerSystem.selectCurrentLayerIndex(0),this.axpObj.layerSystem.updateCanvas()}save_config(t){if(this.isDBAvailable){var e={id:"config_01",config:t};this.dbSystem.saveToDB(e,this.CONST.STORE_NAME_CONFIG)}}async load_config(){if(!this.isDBAvailable)return;let t=await this.dbSystem.loadFromDB("config_01",this.CONST.STORE_NAME_CONFIG);return void 0!==t.config?t.config:void 0}save_palette(t){if(this.isDBAvailable){var e={id:"palette_01",palette:t};this.dbSystem.saveToDB(e,this.CONST.STORE_NAME_PALETTE)}}async load_palette(){if(!this.isDBAvailable)return;let t=await this.dbSystem.loadFromDB("palette_01",this.CONST.STORE_NAME_PALETTE);return void 0!==t.palette?t.palette:void 0}}class Se{dbSystem;CONST={DB_NAME:"paint_db_ex3",DB_VERSION:2,STORE_NAME_SAVE_MANUAL:"save_manual",STORE_NAME_SAVE_AUTO:"save_auto",STORE_NAME_CONFIG:"save_config",STORE_NAME_PALETTE:"save_palette",AUTOSAVE_MAX:20,MANUALSAVE_MAX:5};constructor(t){this.dbSystem=t}initIndexedDB(){return new Promise(((t,e)=>{window.indexedDB||e();const n=indexedDB.open(this.CONST.DB_NAME,this.CONST.DB_VERSION);n.onerror=function(){e()},n.onupgradeneeded=t=>{const i=n.result;if(i.onerror=function(){e()},t.oldVersion<=1){var a=i.createObjectStore(this.CONST.STORE_NAME_SAVE_MANUAL,{keyPath:"id"});a.put({id:"save_01"}),a.put({id:"save_02"}),a.put({id:"save_03"}),a.put({id:"save_04"}),a.put({id:"save_05"}),i.createObjectStore(this.CONST.STORE_NAME_SAVE_AUTO,{autoIncrement:!0}).createIndex("created","created",{unique:!1}),i.createObjectStore(this.CONST.STORE_NAME_CONFIG,{keyPath:"id"}).put({id:"config_01"}),i.createObjectStore(this.CONST.STORE_NAME_PALETTE,{keyPath:"id"}).put({id:"palette_01"})}},n.onsuccess=function(){t(!0)}}))}dispEntry(){return new Promise(((t,e)=>{var n,i=window.indexedDB.open(this.CONST.DB_NAME,this.CONST.DB_VERSION);i.onerror=()=>{e()},i.onsuccess=()=>{n=i.result;var a=document.getElementById("entry");let s=n.transaction(this.CONST.STORE_NAME_SAVE_MANUAL).objectStore(this.CONST.STORE_NAME_SAVE_MANUAL).openCursor(null,"next");var r=0;s.onerror=()=>{e()},s.onsuccess=()=>{let n=s.result;if(n){let e=n.value;var i=document.createElement("div");i.setAttribute("id",n.primaryKey),this.createSlotHTML(i,e),a.appendChild(i),++r<this.CONST.MANUALSAVE_MAX?n.continue():t()}else e()}}}))}dispEntryAutoSave(){return new Promise(((t,e)=>{var n,i=window.indexedDB.open(this.CONST.DB_NAME,this.CONST.DB_VERSION);i.onerror=()=>{e()},i.onsuccess=()=>{n=i.result;var a=document.getElementById("entry");let s=n.transaction(this.CONST.STORE_NAME_SAVE_AUTO).objectStore(this.CONST.STORE_NAME_SAVE_AUTO).openCursor(null,"prev");var r=0;s.onerror=()=>{e()},s.onsuccess=()=>{let e=s.result;if(e){let i=e.value;var n=document.createElement("div");n.setAttribute("id",e.primaryKey),this.createSlotHTML(n,i),a.appendChild(n),++r<this.CONST.AUTOSAVE_MAX?e.continue():t()}else t()}}}))}createSlotHTML(t,e){if(void 0!==e.created){(a=document.createElement("img")).setAttribute("src",e.src),t.appendChild(a);var n=document.createElement("label");const s=function(t,e){return e=(e=(e=(e=(e=(e=e.replace(/YYYY/,t.getFullYear())).replace(/MM/,("0"+(t.getMonth()+1)).slice(-2))).replace(/DD/,("0"+t.getDate()).slice(-2))).replace(/hh/,("0"+t.getHours()).slice(-2))).replace(/mm/,("0"+t.getMinutes()).slice(-2))).replace(/ss/,("0"+t.getSeconds()).slice(-2))};if(n.innerHTML=s(e.created,"YYYY/MM/DD<br>hh:mm:ss<br>"),t.appendChild(n),void 0!==e.oekaki_id&&null!==e.oekaki_id){var i=document.createElement("label");i.setAttribute("style","color:#0000ff"),i.innerHTML="[基]"+e.oekaki_id,t.appendChild(i)}}else{var a;(a=document.createElement("img")).setAttribute("class","saveslot"),t.appendChild(a),t.appendChild(document.createTextNode("空き"))}}saveToDB(t,e){return new Promise(((n,i)=>{var a=indexedDB.open(this.CONST.DB_NAME,this.CONST.DB_VERSION);a.onerror=()=>{i()},a.onsuccess=()=>{var s=a.result.transaction(e,"readwrite").objectStore(e).put(t);s.onsuccess=()=>{n()},s.onerror=()=>{i()}}}))}autosaveToDB(t,e){return new Promise(((n,i)=>{var a=indexedDB.open(this.CONST.DB_NAME,this.CONST.DB_VERSION);a.onerror=()=>{i()},a.onsuccess=()=>{var s=a.result.transaction(e,"readwrite").objectStore(e),r=s.count();r.onerror=()=>{i()},r.onsuccess=()=>{if(r.result>=this.CONST.AUTOSAVE_MAX){let t=s.openCursor(null,"next");t.onsuccess=function(){let e=t.result;if(e){e.delete().onsuccess=function(){}}}}};var o=s.put(t);o.onsuccess=()=>{n()},o.onerror=()=>{i()}}}))}loadFromDB(t,e){return new Promise(((n,i)=>{var a=indexedDB.open(this.CONST.DB_NAME,this.CONST.DB_VERSION);a.onerror=()=>{i()},a.onsuccess=()=>{let s=a.result.transaction(e).objectStore(e).get(t);s.onerror=()=>{i()},s.onsuccess=()=>{void 0!==s.result?n(s.result):i()}}}))}}class Oe{axpObj;constructor(t){this.axpObj=t}init(){}startEvent(){window.addEventListener("keyup",(t=>{switch(t.key.toUpperCase()){case" ":this.axpObj.penSystem.restorePenModeTemporary("hand"),this.axpObj.isSPACE=!1;break;case"CONTROL":this.axpObj.penSystem.restorePenModeTemporary("spuit"),this.axpObj.isCTRL=!1;break;case"SHIFT":this.axpObj.isSHIFT=!1;break;case"Q":this.axpObj.penSystem.modeChangeSizeOff()}})),window.addEventListener("keydown",(t=>{if(this.axpObj.isClose)return;if(!this.axpObj.isCanvasOpen)return;if(this.axpObj.isModalOpen)return;if(document.activeElement===document.getElementById("text-hexcolor"))return;if(document.activeElement===document.getElementById("range_red_text"))return;if(document.activeElement===document.getElementById("range_green_text"))return;if(document.activeElement===document.getElementById("range_blue_text"))return;t.preventDefault();let e=t.key.toUpperCase();if(this.axpObj.isDrawing)"SHIFT"===e&&(this.axpObj.isLine=!0);else{switch(e){case"ARROWUP":case"ARROWDOWN":case"ARROWLEFT":case"ARROWRIGHT":this.pressArrowkey(e)}if(!t.repeat)switch(e){case" ":this.axpObj.isSPACE=!0,this.axpObj.penSystem.changePenModeTemporary("hand");break;case"CONTROL":this.axpObj.isCTRL=!0,this.axpObj.penSystem.changePenModeTemporary("spuit");break;case"ALT":isALT=!0;break;case"Q":this.axpObj.penSystem.modeChangeSizeOn();break;case"I":this.axpObj.TASK.func_init_window_positon();break;case"U":this.axpObj.TASK.func_fill_all();break;case"C":this.axpObj.TASK.func_swap_transparent();break;case"X":this.axpObj.TASK.func_swap_maincolor();break;case"B":this.axpObj.TASK.func_backgroundimage();break;case"M":this.axpObj.TASK.func_flipmirror();break;case"K":this.axpObj.TASK.func_rotate();break;case";":this.axpObj.TASK.func_loupe_up();break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":let t="config_key_"+e,n=document.getElementById(t).value,i=document.getElementById(t+"_option").value,a=document.getElementById(t+"_value").value;switch(n){case"func_loupe":let t=this.axpObj.assistToolSystem.setScaleIndex(Number(i));this.axpObj.msg(`拡大率：${t}%`);break;case"func_size":this.axpObj.penSystem.setPenSize(parseInt(a));break;case"none":this.axpObj.msg("["+e+"]キーには機能が割り当てられていません。（※設定で変更可能）","caution");break;default:this.axpObj.TASK[n]()}break;default:let s=null;const r=document.getElementsByClassName("FUNCTION");for(const t of r)if(t.dataset.key===e){s=t.dataset.function;break}null!=s&&this.axpObj.TASK[s]()}}}),{passive:!1})}pressArrowkey(t){switch(document.getElementById("config_arrow").elements.config_arrow.value){case"none":break;case"move":const n=parseInt(document.getElementById("config_movesize").value);switch(t){case"ARROWUP":this.axpObj.moveCanvas(0,-n);break;case"ARROWDOWN":this.axpObj.moveCanvas(0,n);break;case"ARROWLEFT":this.axpObj.moveCanvas(-n,0);break;case"ARROWRIGHT":this.axpObj.moveCanvas(n,0)}break;case"size":let i=this.axpObj.penSystem.getName(),a=this.axpObj.penSystem.getAlpha(),s=this.axpObj.penSystem.getSize();switch(t){case"ARROWUP":case"ARROWDOWN":if(null===a)return void this.axpObj.msg(`${i}の不透明度は変更できません。`,"caution");if(a=Number(a),"ARROWUP"===t){if(a>=100)return void this.axpObj.msg(`${i}の不透明度は100が最大値です。`,"caution");a+=5}else{if(a<=5)return void this.axpObj.msg(`${i}の不透明度は5が最小値です。`,"caution");a-=5}this.axpObj.msg(`${i}の不透明度：${a}`),this.axpObj.penSystem.setAlpha(a),this.axpObj.penSystem.previewPenSize(),document.getElementById("range-alpha-value").result.value=a,document.getElementById("range-alpha").value=a,this.axpObj.configSystem.saveConfig("alpha_"+this.pen_mode,a);break;case"ARROWLEFT":case"ARROWRIGHT":if(null===s)return void this.axpObj.msg(`${i}の太さは変更できません。`,"caution");if(s=Number(s),"ARROWRIGHT"===t){if(s>=200)return void this.axpObj.msg(`${i}の太さは200が最大値です。`,"caution");for(var e=this.axpObj.penSystem.getIndex();x[e]===s;)e++;s=x[e]}else{if(s<=1)return void this.axpObj.msg(`${i}の太さは1が最小値です。`,"caution");for(e=this.axpObj.penSystem.getIndex();x[e]===s;)e--;s=x[e]}this.axpObj.penSystem.setSize(s),this.axpObj.msg(`${i}の太さ：${s}`),this.axpObj.penSystem.previewPenSize(),document.getElementById("pensize").value=e,document.getElementById("pensize-value").result.value=s,this.axpObj.configSystem.saveConfig("size_"+this.axpObj.penSystem.pen_mode,s)}break;case"grid":if(this.axpObj.assistToolSystem.isGrid){let e;if(document.getElementById("config_grid_2way").checked){let n="";switch(t){case"ARROWUP":document.getElementById("config_grid_division_vertical").value++;break;case"ARROWDOWN":document.getElementById("config_grid_division_vertical").value--;break;case"ARROWRIGHT":document.getElementById("config_grid_division_horizontal").value++;break;case"ARROWLEFT":document.getElementById("config_grid_division_horizontal").value--}switch(t){case"ARROWUP":case"ARROWDOWN":n="分割数:縦",e=document.getElementById("config_grid_division_vertical").value,document.getElementById("config_grid_division_vertical_value").result.value=e,this.axpObj.configSystem.saveConfig("config_grid_division_vertical",e);break;case"ARROWRIGHT":case"ARROWLEFT":n="分割数:横",e=document.getElementById("config_grid_division_horizontal").value,document.getElementById("config_grid_division_horizontal_value").result.value=e,this.axpObj.configSystem.saveConfig("config_grid_division_horizontal",e)}this.axpObj.assistToolSystem.setGridDivision(),this.axpObj.msg(`グリッド${n}：${e}`)}else{switch(t){case"ARROWUP":case"ARROWRIGHT":document.getElementById("config_grid_division").value++,e=document.getElementById("config_grid_division").value,document.getElementById("config_grid_division_value").result.value=e;break;case"ARROWDOWN":case"ARROWLEFT":document.getElementById("config_grid_division").value--,e=document.getElementById("config_grid_division").value,document.getElementById("config_grid_division_value").result.value=e}this.axpObj.assistToolSystem.setGridDivision(),this.axpObj.msg(`グリッド分割数：${e}`),this.axpObj.configSystem.saveConfig("config_grid_division",e)}}else this.axpObj.msg("グリッドが表示されているときに有効なショートカットです。","caution")}}}class we{CONST={VERSION:"AXNOS Paint version 1.99.19 [2023/02/09版]",CANVAS_X_MAX:600,CANVAS_Y_MAX:600,CANVAS_X_MIN:8,CANVAS_Y_MIN:8,CANVAS_X_DEFAULT:317,CANVAS_Y_DEFAULT:317,DRAW_FREEHAND:Symbol(),DRAW_LINE:Symbol(),DRAW_RECT:Symbol(),DRAW_CIRCLE:Symbol(),DRAW_SYMMETRY:Symbol(),GRID_DOT_SCALE:800};CANVAS={main:null,main_ctx:null};ELEMENT={view:null,cursor:null,info:null,base:null,grid:null,grid_dot:null};FUNCTION={post:null};TASK=[];dragWindow;toolWindow=[];layerSystem;colorPaletteSystem;colorMakerSystem;penSystem;assistToolSystem;isModalOpen;isCanvasOpen;isClose;isBackgroundimage;isSPACE;isCTRL;isSHIFT;isCHANGE_SIZE_KEY;isDrawing;isLine;isRect;ENV={multiCanvas:!1};exec_env;paintBodyElement;browser;useSameBBSCheck;option_height;option_width;oekaki_id=null;oekaki_width;oekaki_height;url_oekaki;draft_src;oekaki_base;post_bbs_pageno;post_bbs_title;oekaki_bbs_pageno=null;oekaki_bbs_title=null;x_size;y_size;ctx_map_shift_x;ctx_map_shift_y;scale=100;canvas_x=0;canvas_y=0;url_backgroundimage;base_x;base_y;constructor(){this.toolWindow.push(this.layerSystem=new L(this)),this.toolWindow.push(this.colorPaletteSystem=new P(this)),this.toolWindow.push(this.colorMakerSystem=new me(this)),this.toolWindow.push(this.penSystem=new M(this)),this.toolWindow.push(this.assistToolSystem=new be(this)),this.keyboardSystem=new Oe(this),this.undoSystem=new _e(this),this.configSystem=new Ae(this),this.saveSystem=new ve(this),this.postSystem=new fe(this)}init(){this.CANVAS.main=document.getElementById("axp-canvas-maincanvas"),this.CANVAS.main_ctx=this.CANVAS.main.getContext("2d"),this.ELEMENT.base=document.getElementById("axp-canvas"),this.ELEMENT.view=document.getElementById("axp-canvas-grayarea"),this.ELEMENT.cursor=document.getElementById("axp-canvas-pen_cursor"),this.ELEMENT.info=document.getElementById("axp-footer-info"),this.ELEMENT.grid=document.getElementById("axp-canvas-gridarea"),this.ELEMENT.grid_dot=document.getElementById("axp-canvas-griddot");for(const t of this.toolWindow)t.init();this.dragWindow=new a(this),this.dragWindow.add(this.layerSystem),this.dragWindow.add(this.colorPaletteSystem),this.dragWindow.add(this.colorMakerSystem),this.dragWindow.add(this.penSystem),this.dragWindow.add(this.assistToolSystem),this.keyboardSystem.init(),this.undoSystem.init(),this.configSystem.init(),this.saveSystem.init(),this.postSystem.init(),this.initTask();const t=document.getElementsByClassName("FUNCTION");for(const e of t)e.addEventListener("pointerdown",(()=>{this.TASK[e.dataset.function]()}))}resetCanvas(){this.CANVAS.main.style.width=this.x_size+"px",this.CANVAS.main.style.height=this.y_size+"px",this.CANVAS.main.width=this.x_size,this.CANVAS.main.height=this.y_size;const t=this.ELEMENT.view.getBoundingClientRect().width,e=this.ELEMENT.view.getBoundingClientRect().height;this.CANVAS.main.style.left=parseInt((t-this.x_size)/2)+"px",this.CANVAS.main.style.top=parseInt((e-this.y_size)/2)+"px",this.resetGridarea(),this.ELEMENT.grid_dot.style.backgroundSize=`${100/this.x_size}% ${100/this.y_size}%`,this.layerSystem.resetCanvas(),this.penSystem.resetCanvas(),this.assistToolSystem.resetCanvas(),this.undoSystem.resetCanvas(),this.postSystem.resetCanvas()}resetGridarea(){this.ELEMENT.grid.style.left=this.ELEMENT.grid_dot.style.left=this.CANVAS.main.style.left,this.ELEMENT.grid.style.top=this.ELEMENT.grid_dot.style.top=this.CANVAS.main.style.top,this.ELEMENT.grid.style.width=this.ELEMENT.grid_dot.style.width=this.CANVAS.main.style.width,this.ELEMENT.grid.style.height=this.ELEMENT.grid_dot.style.height=this.CANVAS.main.style.height}startEvent(){for(const t of this.toolWindow)t.startEvent();this.keyboardSystem.startEvent(),this.configSystem.startEvent(),this.saveSystem.startEvent(),this.postSystem.startEvent(),document.addEventListener("dblclick",(function(t){t.preventDefault()}),{passive:!1}),this.ELEMENT.view.addEventListener("touchstart",(t=>{t.preventDefault()}),{passive:!1}),this.ELEMENT.base.addEventListener("pointerdown",(t=>{this.pointerdown(t)})),this.ELEMENT.base.addEventListener("pointermove",(t=>{this.pointermove(t)})),this.ELEMENT.base.addEventListener("pointerup",(t=>{this.pointerup(t)})),this.ELEMENT.base.addEventListener("pointerleave",(t=>{this.pointerup(t)})),this.ELEMENT.base.addEventListener("pointerleave",(()=>{this.ELEMENT.cursor.style.visibility="hidden"})),document.addEventListener("wheel",(t=>{this.mouseWheel(t)}),{passive:!1}),document.addEventListener("mousewheel",(t=>{this.mouseWheel(t)}),{passive:!1}),document.addEventListener("DOMMouseScroll",(t=>{this.mouseWheel(t)}),{passive:!1}),document.oncontextmenu=t=>{if("none"!=document.getElementById("config_rightbutton").elements.config_rightbutton.value)return!1};const t=document.getElementsByClassName("MSG");for(const e of t)e.addEventListener("pointerenter",(t=>{let e=t.currentTarget.dataset.msg;t.currentTarget.dataset.key&&(e="["+t.currentTarget.dataset.key+"]:"+e),this.msg(e)})),e.addEventListener("pointerleave",(t=>{this.msg("")}));this.selectTab("0");document.querySelector("#axp-main-tab-section > ul").addEventListener("pointerdown",(t=>{"LI"==t.target.tagName&&this.selectTab(t.target.dataset.idx)}))}calcScaleCoordinates(t){let e=this.CANVAS.main.getBoundingClientRect();return{x:parseInt(100*(t.clientX-e.left)/this.scale),y:parseInt(100*(t.clientY-e.top)/this.scale)}}pointerdown(t){if(this.msg("down:"+t.pointerType),this.isModalOpen)return;if(!t.isPrimary)return;var e=this.penSystem.getPenMode();if(2===t.buttons){switch(document.getElementById("config_rightbutton").elements.config_rightbutton.value){case"undo":this.TASK.func_undo();break;case"spuit":this.penSystem.spuit(t);break;case"loupe":this.TASK.func_loupe_reset();break;case"swapcolor":this.TASK.func_swap_maincolor();break;case"swaptrans":this.TASK.func_swap_transparent()}if("hand"!==document.getElementById("config_rightbutton").elements.config_rightbutton.value)return;e="hand"}if(4===t.buttons){switch(t.preventDefault(),document.getElementById("config_wheelbutton").elements.config_wheelbutton.value){case"undo":this.TASK.func_undo();break;case"spuit":this.penSystem.spuit(t);break;case"loupe":this.TASK.func_loupe_reset();break;case"swapcolor":this.TASK.func_swap_maincolor();break;case"swaptrans":this.TASK.func_swap_transparent()}if("hand"!==document.getElementById("config_wheelbutton").elements.config_wheelbutton.value)return;e="hand"}let n=this.calcScaleCoordinates(t);this.base_x=n.x,this.base_y=n.y,this.penSystem.start(n.x,n.y,t,e)}pointermove(t){if(this.isModalOpen)return;if(!t.isPrimary)return;let e=this.calcScaleCoordinates(t);const n=t.target;if(n===this.CANVAS.main||n===this.ELEMENT.view){const t=this.layerSystem.getName();let e,n;this.layerSystem.getMasked()&&(e=`${t}は透明部分をロックしています。既に描画されている部分のみ上書き描画できます。`,n="information"),0==this.layerSystem.getAlpha()&&(e=`${t}の不透明度が0%のため、描画を禁止しています。`,n="caution"),this.layerSystem.getChecked()||(e=`${t}が非表示のため、描画を禁止しています。`,n="caution"),this.layerSystem.getLocked()&&(e=`${t}がロック状態のため、描画を禁止しています。`,n="caution"),e&&this.msg(e,n)}let i;const a=t=>{let e=Math.max(Math.min(t,1e3),-1e3);return("    "+(Math.abs(e)<1e3?e.toString():"NaN")).slice(-4)};i=this.isLine||this.isRect?`(${a(this.base_x)},${a(this.base_y)})→(${a(e.x)},${a(e.y)})`:`(${a(e.x)},${a(e.y)})`,document.getElementById("axp-canvas-display-position").textContent=i,this.penSystem.move(e.x,e.y,t)}pointerup(t){if(this.isModalOpen)return;if(!t.isPrimary)return;let e=this.calcScaleCoordinates(t);this.penSystem.end(e.x,e.y,t)}mouseWheel(t){if(!this.isClose&&this.isCanvasOpen&&(t.preventDefault(),!this.isModalOpen&&"wheel"===t.type)){var e=(t.deltaY||-t.wheelDelta||t.detail)>>10||1;switch(document.getElementById("config_wheel").elements.config_wheel.value){case"none":break;case"loupe":e<0&&(document.getElementById("config_wheelcheckbox").checked?this.TASK.func_loupe_up():this.TASK.func_loupe_down()),e>0&&(document.getElementById("config_wheelcheckbox").checked?this.TASK.func_loupe_down():this.TASK.func_loupe_up());break;case"scroll":const t=parseInt(document.getElementById("config_movesize").value);e<0&&(document.getElementById("config_wheelcheckbox").checked?this.moveCanvas(0,-t):this.moveCanvas(0,t)),e>0&&(document.getElementById("config_wheelcheckbox").checked?this.moveCanvas(0,t):this.moveCanvas(0,-t))}}}setCanvasSize(t,e){let n=Number(t),i=Number(e);n<this.CONST.CANVAS_X_MIN&&(n=this.CONST.CANVAS_X_MIN),n>this.CONST.CANVAS_X_MAX&&(n=this.CONST.CANVAS_X_MAX),i<this.CONST.CANVAS_Y_MIN&&(i=this.CONST.CANVAS_Y_MIN),i>this.CONST.CANVAS_Y_MAX&&(i=this.CONST.CANVAS_Y_MAX),this.x_size=n,this.y_size=i}checkCanvasSize_x(t){let e=Number(t);return e<this.CONST.CANVAS_X_MIN&&(e=this.CONST.CANVAS_X_MIN),e>this.CONST.CANVAS_X_MAX&&(e=this.CONST.CANVAS_X_MAX),e}checkCanvasSize_y(t){let e=Number(t);return e<this.CONST.CANVAS_Y_MIN&&(e=this.CONST.CANVAS_Y_MIN),e>this.CONST.CANVAS_Y_MAX&&(e=this.CONST.CANVAS_Y_MAX),e}getCanvasSize_X(){return this.x_size}getCanvasSize_Y(){return this.y_size}selectTab(t){if("2"==t){if(this.restrictPost)return void alert("投稿先掲示板が指定されていないため、投稿することができません。");if(!this.FUNCTION.post)return void alert("投稿用プログラムが正しく設定されていないため、投稿することができません。")}document.querySelectorAll("#axp-main-tab-section > ul > li").forEach((e=>{e.dataset.idx===t?e.classList.add("selected"):e.classList.remove("selected")}));var e=document.querySelectorAll("#axp-main-tab-article > article");switch(e.forEach((t=>{t.style.display="none"})),e[Number(t)].style.display="flex",t){case"0":this.isCanvasOpen=!0,this.dragWindow.updateIconPosition(),this.stopIconAnime();break;case"1":this.isCanvasOpen=!1,this.configSystem.dispPalettebox(document.getElementById("axp-config-palette_box"),this.colorPaletteSystem.currentPalette);break;case"2":this.isCanvasOpen=!1;let t=this.assistToolSystem.getIsTransparent();if(document.getElementById("axp-post-information_table-transparent").textContent=t?"する":"しない",t){this.postSystem.CANVAS.post_ctx.clearRect(0,0,this.x_size,this.y_size),this.postSystem.CANVAS.post_ctx.drawImage(this.layerSystem.CANVAS.backscreen_trans,0,0);let t=Math.max(this.x_size,this.y_size);this.postSystem.CANVAS.thumbnail_ctx.clearRect(0,0,t,t),this.postSystem.CANVAS.thumbnail_ctx.drawImage(this.layerSystem.CANVAS.backscreen_trans,this.ctx_map_shift_x,this.ctx_map_shift_y)}else{this.postSystem.CANVAS.post_ctx.drawImage(this.layerSystem.CANVAS.backscreen_white,0,0);let t=Math.max(this.x_size,this.y_size);this.postSystem.CANVAS.thumbnail_ctx.fillStyle="#ffffff",this.postSystem.CANVAS.thumbnail_ctx.fillRect(0,0,t,t),this.postSystem.CANVAS.thumbnail_ctx.drawImage(this.layerSystem.CANVAS.backscreen_white,this.ctx_map_shift_x,this.ctx_map_shift_y)}document.getElementById("UploadButton").textContent=document.getElementById("UploadButton").dataset.buttontext,document.getElementById("UploadButton").disabled=!1;let e=document.getElementById("axp-post-information_table-ref"),n=document.getElementById("axp-post-information_table-refid");null!==this.oekaki_id?(e.textContent="もとの絵あるよ",n.textContent=this.oekaki_id+".png",n.href=this.url_oekaki+this.oekaki_id+".png"):(e.textContent="いちから描いた",n.textContent="",n.href="")}}moveCanvas(t,e){var n=this.ELEMENT.view.getBoundingClientRect(),i=this.CANVAS.main.getBoundingClientRect(),a=i.left-n.left+t,s=i.top-n.top+e;this.CANVAS.main.style.left=a+"px",this.CANVAS.main.style.top=s+"px",this.ELEMENT.grid.style.left=this.CANVAS.main.style.left,this.ELEMENT.grid.style.top=this.CANVAS.main.style.top,this.ELEMENT.grid_dot.style.left=this.CANVAS.main.style.left,this.ELEMENT.grid_dot.style.top=this.CANVAS.main.style.top,this.canvas_x=a-parseInt((n.width-this.x_size*this.scale/100)/2),this.canvas_y=s-parseInt((n.height-this.y_size*this.scale/100)/2),this.assistToolSystem.mapguide()}initTask(){this.TASK.func_loupe_down=()=>{this.assistToolSystem.loupeDown()},this.TASK.func_loupe_up=()=>{this.assistToolSystem.loupeUp()},this.TASK.func_loupe_reset=()=>{this.assistToolSystem.loupeReset(),this.msg("拡大率とキャンバスの位置をリセットしました。","information")},this.TASK.func_undo=()=>{this.undoSystem.undo()},this.TASK.func_redo=()=>{this.undoSystem.redo()},this.TASK.func_restore=()=>{this.saveSystem.openRestoreWindow()},this.TASK.func_save=()=>{this.saveSystem.openSaveWindow()},this.TASK.func_load=()=>{this.saveSystem.openLoadWindow()},this.TASK.func_flip_h=()=>{this.assistToolSystem.flip_h()},this.TASK.func_flip_v=()=>{this.assistToolSystem.flip_v()},this.TASK.func_transparent=()=>{this.assistToolSystem.transparent()},this.TASK.func_grid=()=>{this.assistToolSystem.grid()},this.TASK.func_init_window_positon=()=>{this.dragWindow.resetPosition(),this.msg("ツールウィンドウの位置を初期化しました。","information")},this.TASK.func_flipmirror=()=>{this.layerSystem.flip_h("all"),this.msg("全レイヤーの左右を反転しました。","information"),this.undoSystem.setUndo({type:"flip_h",id:"all"})},this.TASK.func_backgroundimage=()=>{this.isBackgroundimage=!this.isBackgroundimage,this.isBackgroundimage?(this.url_backgroundimage=this.layerSystem.CANVAS.backscreen_white.toDataURL("image/png"),this.ELEMENT.view.style.backgroundImage="url("+this.url_backgroundimage+")"):this.ELEMENT.view.style.backgroundImage=null;var t=this.isBackgroundimage?"表示":"非表示";this.msg(`背景のタイルプレビューを切り替えました。（現在の状態:${t}）`,"information")},this.TASK.func_download=()=>{this.layerSystem.downloadImage()},this.TASK.func_swap_maincolor=()=>{this.colorMakerSystem.swap_maincolor()},this.TASK.func_swap_transparent=()=>{this.colorMakerSystem.swap_transparent()},this.TASK.func_fill_all=()=>{if(this.layerSystem.isWriteProtection())return void this.msgWriteProtection("全面塗り潰しできません。");switch(this.penSystem.getType()){case"draw":case"eraser":case"fill":break;default:return void this.msg("全面塗り潰しを使用する際は、ペン、消しゴム、バケツのいずれかを選択した状態にしてください。","caution")}this.penSystem.fillAll();let t=this.layerSystem.getName();this.msg(`${t}を全面塗り潰ししました。`,"information")},this.TASK.func_rotate=()=>{if(this.layerSystem.isWriteProtection())return void this.msgWriteProtection("90°回転できません。");this.penSystem.rotate90();let t=this.layerSystem.getName();this.msg(`${t}を90°回転しました。`,"information")}}msg(t,e){let n=document.getElementById("axp-footer-infoIcon");n.classList.remove(...n.classList),e?(n.classList.add(e),n.style.display=""):n="none",this.ELEMENT.info.textContent=t}msgWriteProtection(t){let e=this.layerSystem.getName();this.layerSystem.getLocked()?this.msg(`${e}がロック状態のため、${t}`,"caution"):this.layerSystem.getChecked()?0!=this.layerSystem.getAlpha()||this.msg(`${e}の不透明度が0%のため、${t}`,"caution"):this.msg(`${e}が非表示のため、${t}`,"caution")}dispGridDot(){document.getElementById("config_grid_dot").checked&&this.scale>=this.CONST.GRID_DOT_SCALE?this.ELEMENT.grid_dot.classList.remove("displaynone"):this.ELEMENT.grid_dot.classList.add("displaynone")}drawBackground(){let t=this.layerSystem.CANVAS.backscreen_white.toDataURL("image/png");this.ELEMENT.view.style.backgroundImage="url("+t+"),url("+this.url_backgroundimage+")",this.url_backgroundimage=t}getURLParms(){const t=new URL(window.location.href);let e=t.searchParams;this.oekaki_id=e.get("oekaki_id"),this.oekaki_width=e.get("oekaki_width"),this.oekaki_height=e.get("oekaki_height"),this.post_bbs_pageno=t.pathname,this.post_bbs_title=document.getElementsByTagName("title")[0].innerHTML}exec(){(async()=>{this.getURLParms();let t=null;this.oekaki_id?t=this.url_oekaki+this.oekaki_id+".png":this.draft_src&&(t=this.draft_src),this.x_size=this.CONST.CANVAS_X_DEFAULT,this.y_size=this.CONST.CANVAS_Y_DEFAULT,isNaN(this.option_width)||(this.x_size=this.option_width),isNaN(this.option_height)||(this.y_size=this.option_height);let e=!1;null!==t?(this.oekaki_base=new Image,await async function(t,e){return await new Promise(((n,i)=>{t.onload=()=>{n(!0)},t.onerror=t=>{n(!1)},t.src=e})).then((t=>t))}(this.oekaki_base,t)?(this.x_size=this.oekaki_base.naturalWidth,this.y_size=this.oekaki_base.naturalHeight,this.oekaki_bbs_pageno=this.post_bbs_pageno,this.oekaki_bbs_title=this.post_bbs_title,e=!0):(alert("「基にしてお絵カキコする」画像の読み込みに失敗しました。\n新規キャンバスを作成します。"),this.oekaki_id=null)):(this.oekaki_width&&(this.x_size=Number(this.oekaki_width)),this.oekaki_height&&(this.y_size=Number(this.oekaki_height)));if((this.x_size<this.CONST.CANVAS_X_MIN||this.x_size>this.CONST.CANVAS_X_MAX)&&(this.x_size=this.CONST.CANVAS_X_DEFAULT),(this.y_size<this.CONST.CANVAS_Y_MIN||this.y_size>this.CONST.CANVAS_Y_MAX)&&(this.y_size=this.CONST.CANVAS_Y_DEFAULT),this.init(),this.resetCanvas(),this.layerSystem.createLayer(),await this.saveSystem.initDB()){let t;try{t=await this.saveSystem.load_config(),t&&this.configSystem.restoreConfig(t)}catch(t){alert("エラー:ユーザー設定の読み込みに失敗しました。デフォルト設定で起動します。")}if("init"===document.getElementById("config_init_color").elements.config_init_color.value);else{let t;try{t=await this.saveSystem.load_palette(),t&&this.colorPaletteSystem.setPaletteArray(t)}catch(t){alert("エラー:ユーザーパレットの読み込みに失敗しました。デフォルト設定で起動します。")}}}this.colorPaletteSystem.createPalette(),this.dragWindow.initPosition(),"init"===document.getElementById("config_init_pen").elements.config_init_pen.value&&this.penSystem.resetPenStyle(),this.penSystem.changePenMode(),e&&(this.layerSystem.CANVAS.tmp_ctx.drawImage(this.oekaki_base,0,0),this.layerSystem.write(this.layerSystem.CANVAS.tmp_ctx.getImageData(0,0,this.x_size,this.y_size))),this.layerSystem.updateCanvas();let n=this.paintBodyElement.clientWidth,i=this.paintBodyElement.clientHeight-62,a=n/2-this.x_size/2,s=i/2-this.y_size/2;this.CANVAS.main.style.left=a+"px",this.CANVAS.main.style.top=s+"px",this.startEvent()})()}setMinimizeType(t){for(const e of this.toolWindow)switch(t){case"horizontal":e.taskIconElement.classList.add("task_icon_horizontal"),e.taskIconElement.classList.remove("task_icon_vertical");break;case"vertical":e.taskIconElement.classList.remove("task_icon_horizontal"),e.taskIconElement.classList.add("task_icon_vertical")}}stopIconAnime(){for(const t of this.toolWindow)t.taskIconElement.classList.remove("icon_close"),t.windowElement.classList.remove("icon_close")}config(t){let e=document.getElementById(t);if(e)return e.elements[t].value}}n(8159),n(7055),n(1897),n(4644),n(3401),n(9668),n(3349);const Ee=class{axpObj;constructor(t){if(this.axpObj=new we,void 0===t.paintBodyId)return void alert("ERROR:起動オプションpaintBodyIdが指定されていません");if(this.axpObj.paintBodyElement=document.getElementById(t.paintBodyId),null===this.axpObj.paintBodyElement)return void alert("ERROR:起動オプションpaintBodyIdの指定が正しくありません");if(this.axpObj.paintBodyElement.style.display="flex",this.axpObj.paintBodyElement.style.flexGrow="1",this.axpObj.paintBodyElement.style.flexDirection="column",this.axpObj.paintBodyElement.style.overflow="hidden",this.axpObj.FUNCTION.post=t.post||null,this.axpObj.useSameBBSCheck=t.useSameBBSCheck||!1,this.axpObj.url_oekaki=t.url_oekaki||null,this.axpObj.draft_src=t.draft_src||null,this.axpObj.exec_env=t.executionEnvironment||"WEB",-1!=window.navigator.userAgent.indexOf("Electron")&&(this.axpObj.exec_env="ELECTRON"),this.axpObj.option_height=t.height||null,this.axpObj.option_width=t.width||null,this.axpObj.restrictPost=t.restrictPost||!1,this.axpObj.paintBodyElement.insertAdjacentHTML("afterbegin",'<div id="axp-main">\r\n\t\x3c!-- 切り替えタブ --\x3e\r\n\t<section id="axp-main-tab-section">\r\n\t\t<ul>\r\n\t\t\t<li data-idx="0" class="MSG" data-msg="キャンバス：絵を描くメイン画面です。">キャンバス</li>\r\n\t\t\t<li data-idx="1" class="MSG" data-msg="設定：各種機能をカスタマイズできます。">設定</li>\r\n\t\t\t<li data-idx="2" class="MSG" data-msg="投稿：描いたイラストを掲示板に投稿します。">投稿</li>\r\n\t\t</ul>\r\n\t\t<div id="axp-main-tab-text" class="MSG" data-msg="お知らせ領域です。文章が見切れる場合、クリックし続けると全文表示します。">aaa</div>\r\n\t</section>\r\n\r\n\t\x3c!-- タブにより切り替わる画面 --\x3e\r\n\t<div id="axp-main-tab-article">\r\n\t\t\x3c!-- キャンバス --\x3e\r\n\t\t<article>\r\n\t\t\t<div id="axp-canvas">\r\n\t\t\t\t\x3c!-- ペンの太さを表示する補助円 --\x3e\r\n\t\t\t\t<div id="axp-canvas-pen_cursor"></div>\r\n\t\t\t\t<div id="axp-canvas-display-position" class="displaynone"></div>\r\n\r\n\t\t\t\t\x3c!-- 描画エリア --\x3e\r\n\t\t\t\t<div id="axp-canvas-grayarea">\r\n\t\t\t\t\t<div id="axp-canvas-gridarea" class="draw_zone axp-grid displaynone"></div>\r\n\t\t\t\t\t<div id="axp-canvas-griddot" class="draw_zone axp-grid displaynone"></div>\r\n\t\t\t\t\t<canvas id="axp-canvas-maincanvas" class="draw_zone axp-mesh"></canvas>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t\x3c!-- セーブロード --\x3e\r\n\t\t\t\t<div id="saveload" class="modal_window">\r\n\t\t\t\t\t<div class="modal_body">\r\n\t\t\t\t\t\t<label id="modal_label"></label>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div id="entry" class="entry"></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<button id="button_close_saveload" class="mybutton size_big100"> 閉じる</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</article>\r\n\t\t\x3c!-- 設定 --\x3e\r\n\t\t<article>\r\n\t\t\t<div id="axp-config"></div>\r\n\t\t</article>\r\n\t\t\x3c!-- 投稿 --\x3e\r\n\t\t<article>\r\n\t\t\t<div id="axp-post"></div>\r\n\t\t</article>\r\n\t</div>\r\n</div>\r\n\x3c!-- フッター --\x3e\r\n<div id="axp-footer">\r\n\t<div id="axp-footer-infoIcon"></div>\r\n\t<div id="axp-footer-info" class="MSG" data-msg="機能解説などのガイドメッセージが表示されるエリアです。">AXNOS Paint（アクノスペイント）\r\n\t</div>\r\n</div>\r\n\r\n\x3c!-- レイヤー名変更用モーダルウィンドウ定義 --\x3e\r\n<div id="subwindow" class="subwindow">\r\n\t<div id="subcontent" class="subcontent">\r\n\t\t<label id="sublabel">レイヤー名変更</label>\r\n\t\t<input id="textrename" type="text" size="15" maxlength="10">\r\n\t</div>\r\n</div>'),this.axpObj.restrictPost){document.querySelectorAll("#axp-main-tab-section > ul > li")[2].style.display="none"}let e;var n;switch(e="string"==typeof(n=t.headerText)||n instanceof String?t.headerText.length>1024?t.headerText.slice(0,1024):t.headerText:"",document.getElementById("axp-main-tab-text").textContent=e,this.axpObj.exec_env){case"LOCAL":case"USERSCRIPT":this.axpObj.isDEBUG=!0}document.getElementById&&(window.alert=function(t){!function(t){if(document.getElementById("modalContainer"))return;let e=document.getElementsByTagName("body")[0].appendChild(document.createElement("div"));e.id="modalContainer",e.style.height=document.documentElement.scrollHeight+"px";let n=e.appendChild(document.createElement("div"));n.id="alertBox",document.all&&!window.opera&&(n.style.top=document.documentElement.scrollTop+"px"),n.style.left=(document.documentElement.scrollWidth-n.offsetWidth)/2+"px",n.style.visiblity="visible",n.appendChild(document.createElement("h1")).appendChild(document.createTextNode(h)),n.appendChild(document.createElement("p")).innerText=t;let i=n.appendChild(document.createElement("div"));i.style.display="flex";let a=i.appendChild(document.createElement("button"));a.id="closeBtn",a.appendChild(document.createTextNode("Ok")),a.focus(),a.onclick=function(){return p(),!0},n.style.display="block"}(t)}),this.axpObj.browser=function(){const t=window.navigator.userAgent.toLowerCase();let e;return e=-1!=t.indexOf("msie")||-1!=t.indexOf("trident")?"IE":-1!=t.indexOf("edg")||-1!=t.indexOf("edge")?"Edge":-1!=t.indexOf("opr")||-1!=t.indexOf("opera")?"Opera":-1!=t.indexOf("chrome")?"Chrome":-1!=t.indexOf("safari")?"Safari":-1!=t.indexOf("firefox")?"FireFox":"unknown",e}(),"Safari"===this.axpObj.browser&&(this.axpObj.ENV.multiCanvas=!0),this.axpObj.exec(),document.getElementById("axp-main").style.display="flex"}version(){return this.axpObj.CONST.VERSION}on(){this.axpObj.paintBodyElement.style.display="flex",this.axpObj.isClose=!1}off(){this.axpObj.paintBodyElement.style.display="none",this.axpObj.isClose=!0}}})(),i=i.default})()));